---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/join_hash.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- exercises for the hash join code"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "begin"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_hashjoin"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Extract bucket and batch counts from an explain analyze plan.  In"
  WHITESPACE "\n"
  COMMENT "-- general we can't make assertions about how many batches (or"
  WHITESPACE "\n"
  COMMENT "-- buckets) will be required because it can vary, but we can in some"
  WHITESPACE "\n"
  COMMENT "-- special cases and we can check for growth."
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "or"
      WHITESPACE " "
      REPLACE_KW "replace"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "find_hash"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "node"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                JSON_KW "json"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              JSON_KW "json"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE "\n"
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\ndeclare\n  x json;\n  child json;\nbegin\n  if node->>'Node Type' = 'Hash' then\n    return node;\n  else\n    for child in select json_array_elements(node->'Plans')\n    loop\n      x := find_hash(child);\n      if x is not null then\n        return x;\n      end if;\n    end loop;\n    return null;\n  end if;\nend;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "or"
      WHITESPACE " "
      REPLACE_KW "replace"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "hash_join_batches"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "query"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      TABLE_KW "table"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "original"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "final"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
      R_PAREN ")"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE "\n"
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\ndeclare\n  whole_plan json;\n  hash_node json;\nbegin\n  for whole_plan in\n    execute 'explain (analyze, format ''json'') ' || query\n  loop\n    hash_node := find_hash(json_extract_path(whole_plan, '0', 'Plan'));\n    original := hash_node->>'Original Hash Batches';\n    final := hash_node->>'Hash Batches';\n    return next;\n  end loop;\nend;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Make a simple relation with well distributed keys and correctly"
  WHITESPACE "\n"
  COMMENT "-- estimated size."
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          SIMPLE_KW "simple"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n  "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "20000"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "AS"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SIMPLE_KW "simple"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "analyze"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SIMPLE_KW "simple"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Make a relation whose size we will under-estimate.  We want stats"
  WHITESPACE "\n"
  COMMENT "-- to say 1000 rows, but actually there are 20,000 rows."
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "bigger_than_it_looks"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n  "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "20000"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bigger_than_it_looks"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        STRING "'false'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bigger_than_it_looks"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "analyze"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bigger_than_it_looks"
  SEMICOLON ";"
  WHITESPACE "\n"
  UPDATE_STMT
    UPDATE_KW "update"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pg_class"
    WHITESPACE " "
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "reltuples"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "1000"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "relname"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          STRING "'bigger_than_it_looks'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- Make a relation whose size we underestimate and that also has a"
    WHITESPACE "\n"
    COMMENT "-- kind of skew that breaks our batching scheme.  We want stats to say"
    WHITESPACE "\n"
    COMMENT "-- 2 rows, but actually there are 20,000 rows with the same key."
    WHITESPACE "\n"
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "extremely_skewed"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "t"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "extremely_skewed"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        STRING "'false'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "extremely_skewed"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "analyze"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "extremely_skewed"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "insert"
    WHITESPACE " "
    INTO_KW "into"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "extremely_skewed"
    WHITESPACE "\n  "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              INT_NUMBER "42"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'"
      WHITESPACE "\n  "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            WHITESPACE " "
            LITERAL
              INT_NUMBER "20000"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  UPDATE_STMT
    UPDATE_KW "update"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pg_class"
    WHITESPACE "\n  "
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "reltuples"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "relpages"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      CALL_EXPR
        NAME_REF
          IDENT "pg_relation_size"
        ARG_LIST
          L_PAREN "("
          LITERAL
            STRING "'extremely_skewed'"
          R_PAREN ")"
      WHITESPACE " "
      SLASH "/"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "8192"
    WHITESPACE "\n  "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "relname"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          STRING "'extremely_skewed'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Make a relation with a couple of enormous tuples."
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "wide"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "2"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "rpad"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  STRING "''"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "320000"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  STRING "'x'"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "t"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wide"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- The \"optimal\" case: the hash table fits in memory; we plan for 1"
  WHITESPACE "\n"
  COMMENT "-- batch, we stick to that number, and peak memory usage stays within"
  WHITESPACE "\n"
  COMMENT "-- our work_mem budget"
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-oblivious hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-aware hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- The \"good\" case: batches required, but we plan the right number; we"
  WHITESPACE "\n"
  COMMENT "-- plan for some number of batches, and we stick to that number, and"
  WHITESPACE "\n"
  COMMENT "-- peak memory usage says within our work_mem budget"
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-oblivious hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-aware hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'192kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- parallel full multi-batch hash join"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- The \"bad\" case: during execution we need to increase number of"
  WHITESPACE "\n"
  COMMENT "-- batches; in this case we plan for 1 batch, and increase at least a"
  WHITESPACE "\n"
  COMMENT "-- couple of times, and peak memory usage stays within our work_mem"
  WHITESPACE "\n"
  COMMENT "-- budget"
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "USING"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "USING"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) FROM simple r JOIN bigger_than_it_looks s USING (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-oblivious hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join bigger_than_it_looks s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-aware hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'192kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "bigger_than_it_looks"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "original"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "initially_multibatch"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            NAME_REF
              IDENT "original"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "increased_batches"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join bigger_than_it_looks s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- The \"ugly\" case: increasing the number of batches during execution"
  WHITESPACE "\n"
  COMMENT "-- doesn't help, so stop trying to fit in work_mem and hope for the"
  WHITESPACE "\n"
  COMMENT "-- best; in this case we plan for 1 batch, increases just once and"
  WHITESPACE "\n"
  COMMENT "-- then stop increasing because that didn't help at all, so we blow"
  WHITESPACE "\n"
  COMMENT "-- right through the work_mem budget and hope for the best..."
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join extremely_skewed s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-oblivious hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join extremely_skewed s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-aware hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          IDENT "extremely_skewed"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join extremely_skewed s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- A couple of other hash join tests unrelated to work_mem management."
  WHITESPACE "\n\n"
  COMMENT "-- Check that EXPLAIN ANALYZE has data even if the leader doesn't participate"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_leader_participation"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from simple r join simple s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Exercise rescans.  We'll turn off parallel_leader_participation so"
  WHITESPACE "\n"
  COMMENT "-- that we can check that instrumentation comes back correctly."
  WHITESPACE "\n\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "join_foo"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "3"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            CAST_EXPR
              LITERAL
                STRING "'xxxxx'"
              COLON2 "::"
              PATH_TYPE
                PATH
                  PATH_SEGMENT
                    NAME_REF
                      TEXT_KW "text"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "t"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "join_foo"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "0"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "join_bar"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1"
                COMMA ","
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "10000"
                R_PAREN ")"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            CAST_EXPR
              LITERAL
                STRING "'xxxxx'"
              COLON2 "::"
              PATH_TYPE
                PATH
                  PATH_SEGMENT
                    NAME_REF
                      TEXT_KW "text"
            WHITESPACE " "
            AS_KW "as"
            WHITESPACE " "
            NAME
              IDENT "t"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "join_bar"
    WHITESPACE " "
    SET_STORAGE_PARAMS
      SET_KW "set"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "parallel_workers"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- multi-batch with rescan, parallel-oblivious"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_leader_participation"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_material"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_mergejoin"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'64kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n    "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n    "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n  "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n  "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "multibatch"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from join_foo\n    left join (select b1.id, b1.t from join_bar b1 join join_bar b2 using (id)) ss\n    on join_foo.id < ss.id + 1 and join_foo.id > ss.id - 1;\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- single-batch with rescan, parallel-oblivious"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_leader_participation"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_material"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_mergejoin"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n    "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n    "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n  "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n  "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "multibatch"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from join_foo\n    left join (select b1.id, b1.t from join_bar b1 join join_bar b2 using (id)) ss\n    on join_foo.id < ss.id + 1 and join_foo.id > ss.id - 1;\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- multi-batch with rescan, parallel-aware"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_leader_participation"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_material"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_mergejoin"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'64kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n    "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n    "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n  "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n  "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "multibatch"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from join_foo\n    left join (select b1.id, b1.t from join_bar b1 join join_bar b2 using (id)) ss\n    on join_foo.id < ss.id + 1 and join_foo.id > ss.id - 1;\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- single-batch with rescan, parallel-aware"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_leader_participation"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_material"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_mergejoin"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'4MB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n    "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n    "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "join_foo"
      WHITESPACE "\n  "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  FIELD_EXPR
                    NAME_REF
                      IDENT "b1"
                    DOT "."
                    NAME_REF
                      IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "join_bar"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "b1"
              WHITESPACE " "
              JOIN
                JOIN_KW "join"
                WHITESPACE " "
                NAME_REF
                  IDENT "join_bar"
                WHITESPACE " "
                ALIAS
                  NAME
                    IDENT "b2"
                WHITESPACE " "
                USING_CLAUSE
                  USING_KW "using"
                  WHITESPACE " "
                  PAREN_EXPR
                    L_PAREN "("
                    NAME_REF
                      IDENT "id"
                    R_PAREN ")"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "ss"
        WHITESPACE "\n  "
        ON_KW "on"
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              PLUS "+"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "join_foo"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "ss"
                DOT "."
                NAME_REF
                  IDENT "id"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "multibatch"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select count(*) from join_foo\n    left join (select b1.id, b1.t from join_bar b1 join join_bar b2 using (id)) ss\n    on join_foo.id < ss.id + 1 and join_foo.id > ss.id - 1;\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- A full outer join where every record is matched."
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallelism not possible with parallel-oblivious full hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallelism is possible with parallel-aware full hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- A full outer join where every record is not matched."
  WHITESPACE "\n\n"
  COMMENT "-- non-parallel"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallelism not possible with parallel-oblivious full hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- parallelism is possible with parallel-aware full hash join"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n     "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE "  "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        SIMPLE_KW "simple"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "r"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SIMPLE_KW "simple"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "r"
              DOT "."
              NAME_REF
                IDENT "id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            BIN_EXPR
              LITERAL
                INT_NUMBER "0"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  IDENT "s"
                DOT "."
                NAME_REF
                  IDENT "id"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n\n"
  COMMENT "-- exercise special code paths for huge tuples (note use of non-strict"
  WHITESPACE "\n"
  COMMENT "-- expression and left join required to get the detoasted tuple into"
  WHITESPACE "\n"
  COMMENT "-- the hash table)"
  WHITESPACE "\n\n"
  COMMENT "-- parallel with parallel-aware hash join (hits ExecParallelHashLoadTuple and"
  WHITESPACE "\n"
  COMMENT "-- sts_puttuple oversized tuple cases because it's multi-batch)"
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "savepoint"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "work_mem"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'128kB'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "hash_mem_multiplier"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      FLOAT_NUMBER "1.0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n  "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "length"
            ARG_LIST
              L_PAREN "("
              CALL_EXPR
                NAME_REF
                  IDENT "max"
                ARG_LIST
                  L_PAREN "("
                  FIELD_EXPR
                    NAME_REF
                      IDENT "s"
                    DOT "."
                    NAME_REF
                      IDENT "t"
                  R_PAREN ")"
              R_PAREN ")"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "wide"
      WHITESPACE " "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  NAME_REF
                    IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  BIN_EXPR
                    CALL_EXPR
                      NAME_REF
                        COALESCE_KW "coalesce"
                      ARG_LIST
                        L_PAREN "("
                        NAME_REF
                          IDENT "t"
                        COMMA ","
                        WHITESPACE " "
                        LITERAL
                          STRING "''"
                        R_PAREN ")"
                    WHITESPACE " "
                    CUSTOM_OP
                      PIPE "|"
                      PIPE "|"
                    WHITESPACE " "
                    LITERAL
                      STRING "''"
                  WHITESPACE " "
                  AS_KW "as"
                  WHITESPACE " "
                  NAME
                    IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "wide"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "length"
            ARG_LIST
              L_PAREN "("
              CALL_EXPR
                NAME_REF
                  IDENT "max"
                ARG_LIST
                  L_PAREN "("
                  FIELD_EXPR
                    NAME_REF
                      IDENT "s"
                    DOT "."
                    NAME_REF
                      IDENT "t"
                  R_PAREN ")"
              R_PAREN ")"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "wide"
      WHITESPACE " "
      JOIN
        LEFT_KW "left"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  NAME_REF
                    IDENT "id"
                COMMA ","
                WHITESPACE " "
                TARGET
                  BIN_EXPR
                    CALL_EXPR
                      NAME_REF
                        COALESCE_KW "coalesce"
                      ARG_LIST
                        L_PAREN "("
                        NAME_REF
                          IDENT "t"
                        COMMA ","
                        WHITESPACE " "
                        LITERAL
                          STRING "''"
                        R_PAREN ")"
                    WHITESPACE " "
                    CUSTOM_OP
                      PIPE "|"
                      PIPE "|"
                    WHITESPACE " "
                    LITERAL
                      STRING "''"
                  WHITESPACE " "
                  AS_KW "as"
                  WHITESPACE " "
                  NAME
                    IDENT "t"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "wide"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        USING_CLAUSE
          USING_KW "using"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            NAME_REF
              IDENT "id"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "final"
            WHITESPACE " "
            R_ANGLE ">"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "multibatch"
    WHITESPACE "\n  "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "hash_join_batches"
        ARG_LIST
          L_PAREN "("
          WHITESPACE "\n"
          LITERAL
            DOLLAR_QUOTED_STRING "$$\n  select length(max(s.t))\n  from wide left join (select id, coalesce(t, '') || '' as t from wide) s using (id);\n$$"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n\n"
  COMMENT "-- Hash join reuses the HOT status bit to indicate match status. This can only"
  WHITESPACE "\n"
  COMMENT "-- be guaranteed to produce correct results if all the hash join tuple match"
  WHITESPACE "\n"
  COMMENT "-- bits are reset before reuse. This is done upon loading them into the"
  WHITESPACE "\n"
  COMMENT "-- hashtable."
  WHITESPACE "\n"
  SAVEPOINT_STMT
    SAVEPOINT_KW "SAVEPOINT"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "hjtest_matchbits_t1"
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "hjtest_matchbits_t2"
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_matchbits_t1"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_matchbits_t2"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Update should create a HOT tuple. If this status bit isn't cleared, we won't"
  WHITESPACE "\n"
  COMMENT "-- correctly emit the NULL-extended unmatching tuple in full hash join."
  WHITESPACE "\n"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_matchbits_t2"
    WHITESPACE " "
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "id"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_matchbits_t1"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "t1"
      WHITESPACE " "
      JOIN
        FULL_KW "FULL"
        WHITESPACE " "
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          IDENT "hjtest_matchbits_t2"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "t2"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t1"
            DOT "."
            NAME_REF
              IDENT "id"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "t2"
            DOT "."
            NAME_REF
              IDENT "id"
    WHITESPACE "\n  "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "t1"
        DOT "."
        NAME_REF
          IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Test serial full hash join."
  WHITESPACE "\n"
  COMMENT "-- Resetting parallel_setup_cost should force a serial plan."
  WHITESPACE "\n"
  COMMENT "-- Just to be safe, however, set enable_parallel_hash to off, as parallel full"
  WHITESPACE "\n"
  COMMENT "-- hash joins are only supported with shared hashtables."
  WHITESPACE "\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_parallel_hash"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "off"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_matchbits_t1"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "t1"
      WHITESPACE " "
      JOIN
        FULL_KW "FULL"
        WHITESPACE " "
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          IDENT "hjtest_matchbits_t2"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "t2"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t1"
            DOT "."
            NAME_REF
              IDENT "id"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "t2"
            DOT "."
            NAME_REF
              IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    NAME_REF
      IDENT "settings"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Verify that hash key expressions reference the correct"
  WHITESPACE "\n"
  COMMENT "-- nodes. Hashjoin's hashkeys need to reference its outer plan, Hash's"
  WHITESPACE "\n"
  COMMENT "-- need to reference Hash's outer plan (which is below HashJoin's"
  WHITESPACE "\n"
  COMMENT "-- inner plan). It's not trivial to verify that the references are"
  WHITESPACE "\n"
  COMMENT "-- correct (we don't display the hashkeys themselves), but if the"
  WHITESPACE "\n"
  COMMENT "-- hashkeys contain subplan references, those will be displayed. Force"
  WHITESPACE "\n"
  COMMENT "-- subplans to appear just about everywhere."
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Bug report:"
  WHITESPACE "\n"
  COMMENT "-- https://www.postgresql.org/message-id/CAPpHfdvGVegF_TKKRiBrSmatJL2dR9uwFCuR%2BteQ_8tEXU8mxg%40mail.gmail.com"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    LOCAL_KW "LOCAL"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_sort"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    OFF_KW "OFF"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- avoid mergejoins"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    LOCAL_KW "LOCAL"
    WHITESPACE " "
    NAME_REF
      IDENT "from_collapse_limit"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- allows easy changing of join order"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "hjtest_1"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "bool"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "hjtest_2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "bool"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_1"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'text'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        FALSE_KW "false"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- matches"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_1"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'text'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        FALSE_KW "false"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- fails id join condition"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_1"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'text'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        FALSE_KW "false"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- fails < 50"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_1"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'text'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        FALSE_KW "false"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- fails (SELECT hjtest_1.b * 5) = (SELECT hjtest_2.c*5)"
  WHITESPACE "\n\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        TRUE_KW "true"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'another'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- matches"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        TRUE_KW "true"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'another'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "7"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- fails id join condition"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        TRUE_KW "true"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'another'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "90"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "  "
  COMMENT "-- fails < 55"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        TRUE_KW "true"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'another'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "3"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- fails (SELECT hjtest_1.b * 5) = (SELECT hjtest_2.c*5)"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "hjtest_2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        TRUE_KW "true"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'text'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "--  fails hjtest_1.a <> hjtest_2.b;"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    VERBOSE_KW "VERBOSE"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a1"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a2"
        COMMA ","
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_1"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t1"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_2"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t2"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_1"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_2"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE "\n    "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            BIN_EXPR
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "hjtest_1"
                  DOT "."
                  NAME_REF
                    IDENT "id"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          LITERAL
                            INT_NUMBER "1"
                    WHITESPACE " "
                    WHERE_CLAUSE
                      WHERE_KW "WHERE"
                      WHITESPACE " "
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "id"
                        WHITESPACE " "
                        EQ "="
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "1"
                  R_PAREN ")"
              WHITESPACE "\n    "
              AND_KW "AND"
              WHITESPACE " "
              BIN_EXPR
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_1"
                              DOT "."
                              NAME_REF
                                IDENT "b"
                            WHITESPACE " "
                            STAR "*"
                            WHITESPACE " "
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_2"
                              DOT "."
                              NAME_REF
                                IDENT "c"
                            STAR "*"
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
            WHITESPACE "\n    "
            AND_KW "AND"
            WHITESPACE " "
            BIN_EXPR
              PAREN_EXPR
                L_PAREN "("
                SELECT
                  SELECT_CLAUSE
                    SELECT_KW "SELECT"
                    WHITESPACE " "
                    TARGET_LIST
                      TARGET
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "hjtest_1"
                            DOT "."
                            NAME_REF
                              IDENT "b"
                          WHITESPACE " "
                          STAR "*"
                          WHITESPACE " "
                          LITERAL
                            INT_NUMBER "5"
                R_PAREN ")"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "50"
          WHITESPACE "\n    "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            PAREN_EXPR
              L_PAREN "("
              SELECT
                SELECT_CLAUSE
                  SELECT_KW "SELECT"
                  WHITESPACE " "
                  TARGET_LIST
                    TARGET
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "c"
                        WHITESPACE " "
                        STAR "*"
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "5"
              R_PAREN ")"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "55"
        WHITESPACE "\n    "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NEQB "<>"
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "b"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a1"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a2"
        COMMA ","
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_1"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t1"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_2"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t2"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_1"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_2"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE "\n    "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            BIN_EXPR
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "hjtest_1"
                  DOT "."
                  NAME_REF
                    IDENT "id"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          LITERAL
                            INT_NUMBER "1"
                    WHITESPACE " "
                    WHERE_CLAUSE
                      WHERE_KW "WHERE"
                      WHITESPACE " "
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "id"
                        WHITESPACE " "
                        EQ "="
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "1"
                  R_PAREN ")"
              WHITESPACE "\n    "
              AND_KW "AND"
              WHITESPACE " "
              BIN_EXPR
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_1"
                              DOT "."
                              NAME_REF
                                IDENT "b"
                            WHITESPACE " "
                            STAR "*"
                            WHITESPACE " "
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_2"
                              DOT "."
                              NAME_REF
                                IDENT "c"
                            STAR "*"
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
            WHITESPACE "\n    "
            AND_KW "AND"
            WHITESPACE " "
            BIN_EXPR
              PAREN_EXPR
                L_PAREN "("
                SELECT
                  SELECT_CLAUSE
                    SELECT_KW "SELECT"
                    WHITESPACE " "
                    TARGET_LIST
                      TARGET
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "hjtest_1"
                            DOT "."
                            NAME_REF
                              IDENT "b"
                          WHITESPACE " "
                          STAR "*"
                          WHITESPACE " "
                          LITERAL
                            INT_NUMBER "5"
                R_PAREN ")"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "50"
          WHITESPACE "\n    "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            PAREN_EXPR
              L_PAREN "("
              SELECT
                SELECT_CLAUSE
                  SELECT_KW "SELECT"
                  WHITESPACE " "
                  TARGET_LIST
                    TARGET
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "c"
                        WHITESPACE " "
                        STAR "*"
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "5"
              R_PAREN ")"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "55"
        WHITESPACE "\n    "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NEQB "<>"
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "b"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    VERBOSE_KW "VERBOSE"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a1"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a2"
        COMMA ","
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_1"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t1"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_2"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t2"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_2"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_1"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE "\n    "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            BIN_EXPR
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "hjtest_1"
                  DOT "."
                  NAME_REF
                    IDENT "id"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          LITERAL
                            INT_NUMBER "1"
                    WHITESPACE " "
                    WHERE_CLAUSE
                      WHERE_KW "WHERE"
                      WHITESPACE " "
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "id"
                        WHITESPACE " "
                        EQ "="
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "1"
                  R_PAREN ")"
              WHITESPACE "\n    "
              AND_KW "AND"
              WHITESPACE " "
              BIN_EXPR
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_1"
                              DOT "."
                              NAME_REF
                                IDENT "b"
                            WHITESPACE " "
                            STAR "*"
                            WHITESPACE " "
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_2"
                              DOT "."
                              NAME_REF
                                IDENT "c"
                            STAR "*"
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
            WHITESPACE "\n    "
            AND_KW "AND"
            WHITESPACE " "
            BIN_EXPR
              PAREN_EXPR
                L_PAREN "("
                SELECT
                  SELECT_CLAUSE
                    SELECT_KW "SELECT"
                    WHITESPACE " "
                    TARGET_LIST
                      TARGET
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "hjtest_1"
                            DOT "."
                            NAME_REF
                              IDENT "b"
                          WHITESPACE " "
                          STAR "*"
                          WHITESPACE " "
                          LITERAL
                            INT_NUMBER "5"
                R_PAREN ")"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "50"
          WHITESPACE "\n    "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            PAREN_EXPR
              L_PAREN "("
              SELECT
                SELECT_CLAUSE
                  SELECT_KW "SELECT"
                  WHITESPACE " "
                  TARGET_LIST
                    TARGET
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "c"
                        WHITESPACE " "
                        STAR "*"
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "5"
              R_PAREN ")"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "55"
        WHITESPACE "\n    "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NEQB "<>"
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "b"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a1"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NAME
            IDENT "a2"
        COMMA ","
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_1"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t1"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "hjtest_2"
              DOT "."
              NAME_REF
                IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
          WHITESPACE " "
          NAME
            IDENT "t2"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_2"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "hjtest_1"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE "\n    "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            BIN_EXPR
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "hjtest_1"
                  DOT "."
                  NAME_REF
                    IDENT "id"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          LITERAL
                            INT_NUMBER "1"
                    WHITESPACE " "
                    WHERE_CLAUSE
                      WHERE_KW "WHERE"
                      WHITESPACE " "
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "id"
                        WHITESPACE " "
                        EQ "="
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "1"
                  R_PAREN ")"
              WHITESPACE "\n    "
              AND_KW "AND"
              WHITESPACE " "
              BIN_EXPR
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_1"
                              DOT "."
                              NAME_REF
                                IDENT "b"
                            WHITESPACE " "
                            STAR "*"
                            WHITESPACE " "
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "hjtest_2"
                              DOT "."
                              NAME_REF
                                IDENT "c"
                            STAR "*"
                            LITERAL
                              INT_NUMBER "5"
                  R_PAREN ")"
            WHITESPACE "\n    "
            AND_KW "AND"
            WHITESPACE " "
            BIN_EXPR
              PAREN_EXPR
                L_PAREN "("
                SELECT
                  SELECT_CLAUSE
                    SELECT_KW "SELECT"
                    WHITESPACE " "
                    TARGET_LIST
                      TARGET
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "hjtest_1"
                            DOT "."
                            NAME_REF
                              IDENT "b"
                          WHITESPACE " "
                          STAR "*"
                          WHITESPACE " "
                          LITERAL
                            INT_NUMBER "5"
                R_PAREN ")"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "50"
          WHITESPACE "\n    "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            PAREN_EXPR
              L_PAREN "("
              SELECT
                SELECT_CLAUSE
                  SELECT_KW "SELECT"
                  WHITESPACE " "
                  TARGET_LIST
                    TARGET
                      BIN_EXPR
                        FIELD_EXPR
                          NAME_REF
                            IDENT "hjtest_2"
                          DOT "."
                          NAME_REF
                            IDENT "c"
                        WHITESPACE " "
                        STAR "*"
                        WHITESPACE " "
                        LITERAL
                          INT_NUMBER "5"
              R_PAREN ")"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "55"
        WHITESPACE "\n    "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_1"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          NEQB "<>"
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "hjtest_2"
            DOT "."
            NAME_REF
              IDENT "b"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Verify that we behave sanely when the inner hash keys contain parameters"
  WHITESPACE "\n"
  COMMENT "-- (that is, outer or lateral references).  This situation has to defeat"
  WHITESPACE "\n"
  COMMENT "-- re-use of the inner hash table across rescans."
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "begin"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    LOCAL_KW "local"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_hashjoin"
    WHITESPACE " "
    EQ "="
  WHITESPACE " "
  ERROR
    ON_KW "on"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "i8"
            DOT "."
            NAME_REF
              IDENT "q2"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "ss"
            DOT "."
            STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE "\n"
      NAME_REF
        IDENT "int8_tbl"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "i8"
      COMMA ","
      WHITESPACE "\n"
      LATERAL_KW "lateral"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "select"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                FIELD_EXPR
                  NAME_REF
                    IDENT "t1"
                  DOT "."
                  NAME_REF
                    IDENT "fivethous"
              COMMA ","
              WHITESPACE " "
              TARGET
                FIELD_EXPR
                  NAME_REF
                    IDENT "i4"
                  DOT "."
                  NAME_REF
                    IDENT "f1"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "from"
            WHITESPACE " "
            NAME_REF
              IDENT "tenk1"
            WHITESPACE " "
            ALIAS
              NAME
                IDENT "t1"
            WHITESPACE " "
            JOIN
              JOIN_KW "join"
              WHITESPACE " "
              NAME_REF
                IDENT "int4_tbl"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "i4"
              WHITESPACE "\n         "
              ON_KW "on"
              WHITESPACE " "
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "t1"
                  DOT "."
                  NAME_REF
                    IDENT "fivethous"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                BIN_EXPR
                  FIELD_EXPR
                    NAME_REF
                      IDENT "i4"
                    DOT "."
                    NAME_REF
                      IDENT "f1"
                  PLUS "+"
                  FIELD_EXPR
                    NAME_REF
                      IDENT "i8"
                    DOT "."
                    NAME_REF
                      IDENT "q2"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "order"
            WHITESPACE " "
            BY_KW "by"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "ss"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "i8"
            DOT "."
            NAME_REF
              IDENT "q2"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "ss"
            DOT "."
            STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE "\n"
      NAME_REF
        IDENT "int8_tbl"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "i8"
      COMMA ","
      WHITESPACE "\n"
      LATERAL_KW "lateral"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "select"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                FIELD_EXPR
                  NAME_REF
                    IDENT "t1"
                  DOT "."
                  NAME_REF
                    IDENT "fivethous"
              COMMA ","
              WHITESPACE " "
              TARGET
                FIELD_EXPR
                  NAME_REF
                    IDENT "i4"
                  DOT "."
                  NAME_REF
                    IDENT "f1"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "from"
            WHITESPACE " "
            NAME_REF
              IDENT "tenk1"
            WHITESPACE " "
            ALIAS
              NAME
                IDENT "t1"
            WHITESPACE " "
            JOIN
              JOIN_KW "join"
              WHITESPACE " "
              NAME_REF
                IDENT "int4_tbl"
              WHITESPACE " "
              ALIAS
                NAME
                  IDENT "i4"
              WHITESPACE "\n         "
              ON_KW "on"
              WHITESPACE " "
              BIN_EXPR
                FIELD_EXPR
                  NAME_REF
                    IDENT "t1"
                  DOT "."
                  NAME_REF
                    IDENT "fivethous"
                WHITESPACE " "
                EQ "="
                WHITESPACE " "
                BIN_EXPR
                  FIELD_EXPR
                    NAME_REF
                      IDENT "i4"
                    DOT "."
                    NAME_REF
                      IDENT "f1"
                  PLUS "+"
                  FIELD_EXPR
                    NAME_REF
                      IDENT "i8"
                    DOT "."
                    NAME_REF
                      IDENT "q2"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "order"
            WHITESPACE " "
            BY_KW "by"
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "ss"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@157: expected config value, got ON_KW
ERROR@157: expected SEMICOLON
ERROR@158: expected command, found ON_KW
ERROR@3154: expected R_PAREN
ERROR@3155: expected command, found OFF_KW
ERROR@3158: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@3158: expected SEMICOLON
ERROR@3158: expected command, found R_PAREN
ERROR@3702: expected R_PAREN
ERROR@3703: expected command, found OFF_KW
ERROR@3706: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@3706: expected SEMICOLON
ERROR@3706: expected command, found R_PAREN
ERROR@4226: expected config value, got ON_KW
ERROR@4226: expected SEMICOLON
ERROR@4227: expected command, found ON_KW
ERROR@4245: expected R_PAREN
ERROR@4246: expected command, found OFF_KW
ERROR@4249: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@4249: expected SEMICOLON
ERROR@4249: expected command, found R_PAREN
ERROR@4921: expected R_PAREN
ERROR@4922: expected command, found OFF_KW
ERROR@4925: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@4925: expected SEMICOLON
ERROR@4925: expected command, found R_PAREN
ERROR@5471: expected R_PAREN
ERROR@5472: expected command, found OFF_KW
ERROR@5475: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@5475: expected SEMICOLON
ERROR@5475: expected command, found R_PAREN
ERROR@5997: expected config value, got ON_KW
ERROR@5997: expected SEMICOLON
ERROR@5998: expected command, found ON_KW
ERROR@6016: expected R_PAREN
ERROR@6017: expected command, found OFF_KW
ERROR@6020: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@6020: expected SEMICOLON
ERROR@6020: expected command, found R_PAREN
ERROR@6819: expected R_PAREN
ERROR@6820: expected command, found OFF_KW
ERROR@6823: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@6823: expected SEMICOLON
ERROR@6823: expected command, found R_PAREN
ERROR@7411: expected R_PAREN
ERROR@7412: expected command, found OFF_KW
ERROR@7415: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@7415: expected SEMICOLON
ERROR@7415: expected command, found R_PAREN
ERROR@7979: expected config value, got ON_KW
ERROR@7979: expected SEMICOLON
ERROR@7980: expected command, found ON_KW
ERROR@7998: expected R_PAREN
ERROR@7999: expected command, found OFF_KW
ERROR@8002: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@8002: expected SEMICOLON
ERROR@8002: expected command, found R_PAREN
ERROR@8858: expected R_PAREN
ERROR@8859: expected command, found OFF_KW
ERROR@8862: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@8862: expected SEMICOLON
ERROR@8862: expected command, found R_PAREN
ERROR@9362: expected R_PAREN
ERROR@9363: expected command, found OFF_KW
ERROR@9366: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@9366: expected SEMICOLON
ERROR@9366: expected command, found R_PAREN
ERROR@9842: expected config value, got ON_KW
ERROR@9842: expected SEMICOLON
ERROR@9843: expected command, found ON_KW
ERROR@9861: expected R_PAREN
ERROR@9862: expected command, found OFF_KW
ERROR@9865: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@9865: expected SEMICOLON
ERROR@9865: expected command, found R_PAREN
ERROR@11384: expected R_PAREN
ERROR@11385: expected command, found OFF_KW
ERROR@11388: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@11388: expected SEMICOLON
ERROR@11388: expected command, found R_PAREN
ERROR@12397: expected R_PAREN
ERROR@12398: expected command, found OFF_KW
ERROR@12401: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@12401: expected SEMICOLON
ERROR@12401: expected command, found R_PAREN
ERROR@13099: expected config value, got ON_KW
ERROR@13099: expected SEMICOLON
ERROR@13100: expected command, found ON_KW
ERROR@13405: expected R_PAREN
ERROR@13406: expected command, found OFF_KW
ERROR@13409: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@13409: expected SEMICOLON
ERROR@13409: expected command, found R_PAREN
ERROR@14108: expected config value, got ON_KW
ERROR@14108: expected SEMICOLON
ERROR@14109: expected command, found ON_KW
ERROR@14413: expected R_PAREN
ERROR@14414: expected command, found OFF_KW
ERROR@14417: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@14417: expected SEMICOLON
ERROR@14417: expected command, found R_PAREN
ERROR@15176: expected R_PAREN
ERROR@15177: expected command, found OFF_KW
ERROR@15180: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@15180: expected SEMICOLON
ERROR@15180: expected command, found R_PAREN
ERROR@15526: expected R_PAREN
ERROR@15527: expected command, found OFF_KW
ERROR@15530: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@15530: expected SEMICOLON
ERROR@15530: expected command, found R_PAREN
ERROR@15839: expected R_PAREN
ERROR@15840: expected command, found OFF_KW
ERROR@15843: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@15843: expected SEMICOLON
ERROR@15843: expected command, found R_PAREN
ERROR@16163: expected R_PAREN
ERROR@16164: expected command, found OFF_KW
ERROR@16167: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@16167: expected SEMICOLON
ERROR@16167: expected command, found R_PAREN
ERROR@16533: expected R_PAREN
ERROR@16534: expected command, found OFF_KW
ERROR@16537: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@16537: expected SEMICOLON
ERROR@16537: expected command, found R_PAREN
ERROR@16866: expected R_PAREN
ERROR@16867: expected command, found OFF_KW
ERROR@16870: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@16870: expected SEMICOLON
ERROR@16870: expected command, found R_PAREN
ERROR@17446: expected config value, got ON_KW
ERROR@17446: expected SEMICOLON
ERROR@17447: expected command, found ON_KW
ERROR@17520: expected R_PAREN
ERROR@17521: expected command, found OFF_KW
ERROR@17524: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@17524: expected SEMICOLON
ERROR@17524: expected command, found R_PAREN
ERROR@18235: expected config value, got ON_KW
ERROR@18235: expected SEMICOLON
ERROR@18236: expected command, found ON_KW
ERROR@20887: expected R_PAREN
ERROR@20888: expected command, found OFF_KW
ERROR@20891: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@20891: expected SEMICOLON
ERROR@20891: expected command, found COMMA
ERROR@20893: expected command, found VERBOSE_KW
ERROR@20900: expected command, found R_PAREN
ERROR@21606: expected R_PAREN
ERROR@21607: expected command, found OFF_KW
ERROR@21610: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@21610: expected SEMICOLON
ERROR@21610: expected command, found COMMA
ERROR@21612: expected command, found VERBOSE_KW
ERROR@21619: expected command, found R_PAREN
ERROR@22555: expected config value, got ON_KW
ERROR@22555: expected SEMICOLON
ERROR@22556: expected command, found ON_KW
ERROR@22575: expected R_PAREN
ERROR@22576: expected command, found OFF_KW
ERROR@22579: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@22579: expected SEMICOLON
ERROR@22579: expected command, found R_PAREN
