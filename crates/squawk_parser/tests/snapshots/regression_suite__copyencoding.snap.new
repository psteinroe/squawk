---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/copyencoding.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test cases for encoding with COPY commands"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- skip test if not UTF8 server encoding"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            CALL_EXPR
              NAME_REF
                IDENT "getdatabaseencoding"
              ARG_LIST
                L_PAREN "("
                R_PAREN ")"
            WHITESPACE " "
            NEQB "<>"
            WHITESPACE " "
            LITERAL
              STRING "'UTF8'"
          WHITESPACE "\n       "
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "skip_test"
  WHITESPACE " "
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- directory paths are passed to us in environment variables"
  WHITESPACE "\n\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "copy_encoding_tab"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "t"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Valid cases"
  WHITESPACE "\n\n"
  COMMENT "-- Use ENCODING option"
  WHITESPACE "\n"
  COMMENT "-- U+3042 HIRAGANA LETTER A"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              ESC_STRING "E'\\u3042'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        COMMA ","
        WHITESPACE " "
        COLUMN
          NAME
            ENCODING_KW "ENCODING"
  WHITESPACE " "
  ERROR
    STRING "'UTF8'"
  ERROR
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Read UTF8 data as LATIN1: no error"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "copy_encoding_tab"
    WHITESPACE " "
    FROM_KW "FROM"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        COMMA ","
        WHITESPACE " "
        COLUMN
          NAME
            ENCODING_KW "ENCODING"
  WHITESPACE " "
  ERROR
    STRING "'LATIN1'"
  ERROR
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Use client_encoding"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "UTF8"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- U+3042 HIRAGANA LETTER A"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              ESC_STRING "E'\\u3042'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Read UTF8 data as LATIN1: no error"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "LATIN1"
  SEMICOLON ";"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "copy_encoding_tab"
    WHITESPACE " "
    FROM_KW "FROM"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Invalid cases"
  WHITESPACE "\n\n"
  COMMENT "-- Use ENCODING explicitly"
  WHITESPACE "\n"
  COMMENT "-- U+3042 HIRAGANA LETTER A"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              ESC_STRING "E'\\u3042'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        COMMA ","
        WHITESPACE " "
        COLUMN
          NAME
            ENCODING_KW "ENCODING"
  WHITESPACE " "
  ERROR
    STRING "'UTF8'"
  ERROR
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Read UTF8 data as EUC_JP: no error"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "copy_encoding_tab"
    WHITESPACE " "
    FROM_KW "FROM"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        COMMA ","
        WHITESPACE " "
        COLUMN
          NAME
            ENCODING_KW "ENCODING"
  WHITESPACE " "
  ERROR
    STRING "'EUC_JP'"
  ERROR
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Use client_encoding"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "UTF8"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- U+3042 HIRAGANA LETTER A"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              ESC_STRING "E'\\u3042'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Read UTF8 data as EUC_JP: no error"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "EUC_JP"
  SEMICOLON ";"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "copy_encoding_tab"
    WHITESPACE " "
    FROM_KW "FROM"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'utf8_csv'"
  WHITESPACE " "
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      COLUMN_LIST
        L_PAREN "("
        COLUMN
          NAME
            FORMAT_KW "FORMAT"
        WHITESPACE " "
        COLUMN
          NAME
            CSV_KW "csv"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_encoding"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "copy_encoding_tab"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@354: expected string literal
ERROR@354: expected SEMICOLON
ERROR@355: expected command, found COLON
ERROR@356: expected command, found STRING
ERROR@372: expected name
ERROR@379: expected COMMA
ERROR@393: expected R_PAREN
ERROR@393: expected AS_KW
ERROR@393: expected L_PAREN
ERROR@393: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: STRING
ERROR@393: expected R_PAREN
ERROR@393: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: STRING
ERROR@394: expected command, found STRING
ERROR@400: expected command, found R_PAREN
ERROR@468: expected string literal
ERROR@468: expected SEMICOLON
ERROR@469: expected command, found COLON
ERROR@470: expected command, found STRING
ERROR@486: expected name
ERROR@493: expected COMMA
ERROR@507: expected R_PAREN
ERROR@507: expected AS_KW
ERROR@507: expected L_PAREN
ERROR@507: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: STRING
ERROR@507: expected R_PAREN
ERROR@507: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: STRING
ERROR@508: expected command, found STRING
ERROR@516: expected command, found R_PAREN
ERROR@626: expected string literal
ERROR@626: expected SEMICOLON
ERROR@627: expected command, found COLON
ERROR@628: expected command, found STRING
ERROR@644: expected name
ERROR@651: expected COMMA
ERROR@656: expected AS_KW
ERROR@656: expected L_PAREN
ERROR@656: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: SEMICOLON
ERROR@656: expected R_PAREN
ERROR@656: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: SEMICOLON
ERROR@754: expected string literal
ERROR@754: expected SEMICOLON
ERROR@755: expected command, found COLON
ERROR@756: expected command, found STRING
ERROR@772: expected name
ERROR@779: expected COMMA
ERROR@784: expected AS_KW
ERROR@784: expected L_PAREN
ERROR@784: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: SEMICOLON
ERROR@784: expected R_PAREN
ERROR@784: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: SEMICOLON
ERROR@909: expected string literal
ERROR@909: expected SEMICOLON
ERROR@910: expected command, found COLON
ERROR@911: expected command, found STRING
ERROR@927: expected name
ERROR@934: expected COMMA
ERROR@948: expected R_PAREN
ERROR@948: expected AS_KW
ERROR@948: expected L_PAREN
ERROR@948: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: STRING
ERROR@948: expected R_PAREN
ERROR@948: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: STRING
ERROR@949: expected command, found STRING
ERROR@955: expected command, found R_PAREN
ERROR@1023: expected string literal
ERROR@1023: expected SEMICOLON
ERROR@1024: expected command, found COLON
ERROR@1025: expected command, found STRING
ERROR@1041: expected name
ERROR@1048: expected COMMA
ERROR@1062: expected R_PAREN
ERROR@1062: expected AS_KW
ERROR@1062: expected L_PAREN
ERROR@1062: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: STRING
ERROR@1062: expected R_PAREN
ERROR@1062: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: STRING
ERROR@1063: expected command, found STRING
ERROR@1071: expected command, found R_PAREN
ERROR@1181: expected string literal
ERROR@1181: expected SEMICOLON
ERROR@1182: expected command, found COLON
ERROR@1183: expected command, found STRING
ERROR@1199: expected name
ERROR@1206: expected COMMA
ERROR@1211: expected AS_KW
ERROR@1211: expected L_PAREN
ERROR@1211: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: SEMICOLON
ERROR@1211: expected R_PAREN
ERROR@1211: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: SEMICOLON
ERROR@1309: expected string literal
ERROR@1309: expected SEMICOLON
ERROR@1310: expected command, found COLON
ERROR@1311: expected command, found STRING
ERROR@1327: expected name
ERROR@1334: expected COMMA
ERROR@1339: expected AS_KW
ERROR@1339: expected L_PAREN
ERROR@1339: expected DELETE, SELECT, TABLE, VALUES, INSERT, WITH, or UPDATE, got: SEMICOLON
ERROR@1339: expected R_PAREN
ERROR@1339: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: SEMICOLON
