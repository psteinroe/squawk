---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/create_function_c.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- CREATE_FUNCTION_C"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- This script used to create C functions for other scripts to use."
  WHITESPACE "\n"
  COMMENT "-- But to get rid of the ordering dependencies that caused, such"
  WHITESPACE "\n"
  COMMENT "-- functions are now made either in test_setup.sql or in the specific"
  WHITESPACE "\n"
  COMMENT "-- test script that needs them.  All that remains here is error cases."
  WHITESPACE "\n\n"
  COMMENT "-- directory path and dlsuffix are passed to us in environment variables"
  WHITESPACE "\n\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Check LOAD command.  (The alternative of implicitly loading the library"
  WHITESPACE "\n"
  COMMENT "-- is checked in many other test scripts.)"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  LOAD_STMT
    LOAD_KW "LOAD"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'regresslib'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Things that shouldn't work:"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "test1"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "C"
      WHITESPACE "\n    "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          STRING "'nosuchfile'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- To produce stable regression test output, we have to filter the name"
  WHITESPACE "\n"
  COMMENT "-- of the regresslib file out of the error message in this test."
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "test1"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "C"
      WHITESPACE "\n    "
      AS_FUNC_OPTION
        AS_KW "AS"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'regresslib'"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    STRING "'nosuchsymbol'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "regexp_replace"
            ARG_LIST
              L_PAREN "("
              ERROR
                COLON ":"
        TARGET
          LITERAL
            STRING "'LAST_ERROR_MESSAGE'"
        COMMA ","
        WHITESPACE " "
        TARGET
          LITERAL
            STRING "'file \".*\"'"
        COMMA ","
        WHITESPACE " "
        TARGET
          LITERAL
            STRING "'file \"...\"'"
  ERROR
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "test1"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "internal"
      WHITESPACE "\n    "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          STRING "'nosuch'"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@505: expected string literal
ERROR@505: expected SEMICOLON
ERROR@506: expected command, found COLON
ERROR@507: expected command, found STRING
ERROR@821: expected string literal
ERROR@821: expected SEMICOLON
ERROR@822: expected command, found COLON
ERROR@823: expected command, found STRING
ERROR@835: expected command, found COMMA
ERROR@837: expected command, found STRING
ERROR@875: expected an expression, found COLON
ERROR@876: expected R_PAREN
ERROR@876: missing comma
ERROR@923: expected SEMICOLON
ERROR@923: expected command, found R_PAREN
