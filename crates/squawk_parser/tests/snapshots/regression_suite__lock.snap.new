---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/lock.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test the LOCK statement"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- directory paths and dlsuffix are passed to us in environment variables"
  WHITESPACE "\n\n\n"
  COMMENT "-- Setup"
  WHITESPACE "\n"
  CREATE_SCHEMA_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    SCHEMA_KW "SCHEMA"
    WHITESPACE " "
    NAME
      IDENT "lock_schema1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "search_path"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    IDENT "lock_schema1"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_tbl1"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                BIGINT_KW "BIGINT"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_tbl1a"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                BIGINT_KW "BIGINT"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view1"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view2"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
      COMMA ","
      COLUMN
        NAME_REF
          IDENT "b"
      R_PAREN ")"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1a"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view3"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_view2"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view4"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            PAREN_EXPR
              L_PAREN "("
              SELECT
                SELECT_CLAUSE
                  SELECT_KW "select"
                  WHITESPACE " "
                  TARGET_LIST
                    TARGET
                      NAME_REF
                        IDENT "a"
                WHITESPACE " "
                FROM_CLAUSE
                  FROM_KW "from"
                  WHITESPACE " "
                  NAME_REF
                    IDENT "lock_tbl1a"
                WHITESPACE " "
                LIMIT_CLAUSE
                  LIMIT_KW "limit"
                  WHITESPACE " "
                  LITERAL
                    INT_NUMBER "1"
              R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view5"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1"
      WHITESPACE " "
      WHERE_CLAUSE
        WHERE_KW "where"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "a"
          WHITESPACE " "
          IN_KW "in"
          WHITESPACE " "
          PAREN_EXPR
            L_PAREN "("
            SELECT
              SELECT_CLAUSE
                SELECT_KW "select"
                WHITESPACE " "
                TARGET_LIST
                  TARGET
                    STAR "*"
              WHITESPACE " "
              FROM_CLAUSE
                FROM_KW "from"
                WHITESPACE " "
                NAME_REF
                  IDENT "lock_tbl1a"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view6"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  STAR "*"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "from"
              WHITESPACE " "
              NAME_REF
                IDENT "lock_tbl1"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "sub"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "search_path"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    IDENT "lock_schema1"
  SEMICOLON ";"
  WHITESPACE "\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    IDENT "USAGE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    SCHEMA_KW "SCHEMA"
    WHITESPACE " "
    NAME_REF
      IDENT "lock_schema1"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Try all valid lock options; also try omitting the optional TABLE keyword."
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Try using NOWAIT along with valid options."
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    SHARE_KW "SHARE"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
    WHITESPACE " "
    NOWAIT_KW "NOWAIT"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Verify that we can lock views."
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view1 and lock_tbl1 are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view2"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view1, lock_tbl1, and lock_tbl1a are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view3"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view3, lock_view2, lock_tbl1, and lock_tbl1a are locked recursively."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view4"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view4, lock_tbl1, and lock_tbl1a are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view5"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view5, lock_tbl1, and lock_tbl1a are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view6"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view6 an lock_tbl1 are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'ExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- Verify that we cope with infinite recursion in view definitions."
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view2"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_view3"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view2"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view7"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_view2"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view7"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- Verify that we can lock a table with inheritance children."
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_tbl2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                BIGINT_KW "BIGINT"
      R_PAREN ")"
    WHITESPACE " "
    INHERITS_KW "INHERITS"
    WHITESPACE " "
    L_PAREN "("
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_tbl3"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    INHERITS_KW "INHERITS"
    WHITESPACE " "
    L_PAREN "("
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl2"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
    WHITESPACE " "
    TRANSACTION_KW "TRANSACTION"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
      WHITESPACE " "
      STAR "*"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Child tables are locked without granting explicit permission to do so as"
  WHITESPACE "\n"
  COMMENT "-- long as we have permission to lock the parent."
  WHITESPACE "\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    SET_KW "SET"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- fail when child locked directly"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl2"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
      WHITESPACE " "
      STAR "*"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      ONLY_KW "ONLY"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  REVOKE_STMT
    REVOKE_KW "REVOKE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Tables referred to by views are locked without explicit permission to do so"
  WHITESPACE "\n"
  COMMENT "-- as long as we have permission to lock the view itself."
  WHITESPACE "\n"
  SET_ROLE_STMT
    SET_KW "SET"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- fail without permissions on the view"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view1"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    SET_KW "SET"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view1"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view1 and lock_tbl1 (plus children lock_tbl2 and lock_tbl3) are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'AccessExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  REVOKE_STMT
    REVOKE_KW "REVOKE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view1"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Tables referred to by security invoker views require explicit permission to"
  WHITESPACE "\n"
  COMMENT "-- be locked."
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "lock_view8"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "security_invoker"
      R_PAREN ")"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "lock_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    SET_KW "SET"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- fail without permissions on the view"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view8"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view8"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    SET_KW "SET"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- fail without permissions on the table referenced by the view"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view8"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  LOCK_STMT
    LOCK_KW "LOCK"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "lock_view8"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    ACCESS_KW "ACCESS"
    WHITESPACE " "
    EXCLUSIVE_KW "EXCLUSIVE"
    WHITESPACE " "
    MODE_KW "MODE"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- lock_view8 and lock_tbl1 (plus children lock_tbl2 and lock_tbl3) are locked."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "relname"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_locks"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "l"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "pg_class"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "c"
    WHITESPACE "\n "
    WHERE_CLAUSE
      WHERE_KW "where"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "l"
              DOT "."
              NAME_REF
                IDENT "relation"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "c"
              DOT "."
              NAME_REF
                IDENT "oid"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "relname"
            WHITESPACE " "
            LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%lock_%'"
        WHITESPACE " "
        AND_KW "and"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            MODE_KW "mode"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            STRING "'AccessExclusiveLock'"
    WHITESPACE "\n "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      NAME_REF
        IDENT "relname"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_ROLE_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    ROLE_KW "ROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  REVOKE_STMT
    REVOKE_KW "REVOKE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view8"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Clean up"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view8"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view7"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view6"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view5"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view4"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view3"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_view1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl3"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl2"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "lock_tbl1a"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_SCHEMA_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    SCHEMA_KW "SCHEMA"
    WHITESPACE " "
    NAME
      IDENT "lock_schema1"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_rol_lock1"
  SEMICOLON ";"
  WHITESPACE "\n\n\n"
  COMMENT "-- atomic ops tests"
  WHITESPACE "\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "search_path"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "test_atomic_ops"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE "\n    "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "bool"
    WHITESPACE "\n    "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "AS"
  WHITESPACE " "
  ERROR
    COLON ":"
  ERROR
    STRING "'regresslib'"
  WHITESPACE "\n    "
  ERROR
    LANGUAGE_KW "LANGUAGE"
  WHITESPACE " "
  ERROR
    IDENT "C"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "test_atomic_ops"
            ARG_LIST
              L_PAREN "("
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@6440: expected string literal
ERROR@6440: expected SEMICOLON
ERROR@6441: expected command, found COLON
ERROR@6442: expected command, found STRING
ERROR@6459: expected command, found LANGUAGE_KW
ERROR@6468: expected command, found IDENT
