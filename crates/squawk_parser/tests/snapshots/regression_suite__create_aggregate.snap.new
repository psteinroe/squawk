---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/create_aggregate.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- CREATE_AGGREGATE"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- all functions CREATEd"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "newavg"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4_avg_accum"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "basetype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "_int8"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8_avg"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond1"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'{0,0}'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- test comments"
  WHITESPACE "\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "newavg_wrong"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int4"
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'an agg comment'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "newavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int4"
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'an agg comment'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "newavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int4"
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    NULL_KW "NULL"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- without finalfunc; test obsolete spellings 'sfunc1' etc"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "newsum"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc1"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4pl"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "basetype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype1"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond1"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- zero-argument aggregate"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "newcnt"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      STAR "*"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8inc"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    COMMA ","
    WHITESPACE " "
    NAME
      PARALLEL_KW "parallel"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "safe"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- old-style spelling of same (except without parallel-safe; that's too new)"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "oldcnt"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8inc"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "basetype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'ANY'"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- aggregate that only cares about null/nonnull input"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "newcnt"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "\"any\""
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8inc_any"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "nosuchagg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      STAR "*"
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'should fail'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "newcnt"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      STAR "*"
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'an agg(*) comment'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT_STMT
    COMMENT_KW "COMMENT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "newcnt"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "\"any\""
      R_PAREN ")"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'an agg(any) comment'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- multi-argument aggregate"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sum3"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "int8"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          STRING "'select $1 + $2 + $3'"
      WHITESPACE " "
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      STRICT_FUNC_OPTION
        STRICT_KW "strict"
      WHITESPACE " "
      VOLATILITY_FUNC_OPTION
        IMMUTABLE_KW "immutable"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sum2"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "sum3"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- multi-argument aggregates sensitive to distinct/order, strict/nonstrict"
  WHITESPACE "\n"
  CREATE_TYPE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TYPE_KW "type"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "aggtype"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "a"
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            INTEGER_KW "integer"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "b"
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            INTEGER_KW "integer"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "c"
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            TEXT_KW "text"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "aggf_trans"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "aggtype"
  ERROR
    L_BRACK "["
  ERROR
    R_BRACK "]"
  ERROR
    COMMA ","
  ERROR
    INTEGER_KW "integer"
  ERROR
    COMMA ","
  ERROR
    INTEGER_KW "integer"
  ERROR
    COMMA ","
  ERROR
    TEXT_KW "text"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  ERROR
    RETURNS_KW "returns"
  WHITESPACE " "
  ERROR
    IDENT "aggtype"
  ERROR
    L_BRACK "["
  ERROR
    R_BRACK "]"
  WHITESPACE "\n"
  ERROR
    AS_KW "as"
  WHITESPACE " "
  ERROR
    STRING "'select array_append($1,ROW($2,$3,$4)::aggtype)'"
  WHITESPACE "\n"
  ERROR
    LANGUAGE_KW "language"
  WHITESPACE " "
  ERROR
    SQL_KW "sql"
  WHITESPACE " "
  ERROR
    STRICT_KW "strict"
  WHITESPACE " "
  ERROR
    IMMUTABLE_KW "immutable"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "aggfns_trans"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "aggtype"
  ERROR
    L_BRACK "["
  ERROR
    R_BRACK "]"
  ERROR
    COMMA ","
  ERROR
    INTEGER_KW "integer"
  ERROR
    COMMA ","
  ERROR
    INTEGER_KW "integer"
  ERROR
    COMMA ","
  ERROR
    TEXT_KW "text"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  ERROR
    RETURNS_KW "returns"
  WHITESPACE " "
  ERROR
    IDENT "aggtype"
  ERROR
    L_BRACK "["
  ERROR
    R_BRACK "]"
  WHITESPACE "\n"
  ERROR
    AS_KW "as"
  WHITESPACE " "
  ERROR
    STRING "'select array_append($1,ROW($2,$3,$4)::aggtype)'"
  WHITESPACE "\n"
  ERROR
    LANGUAGE_KW "language"
  WHITESPACE " "
  ERROR
    SQL_KW "sql"
  WHITESPACE " "
  ERROR
    IMMUTABLE_KW "immutable"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "aggfstr"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      PARAM
        PATH_TYPE
          TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "aggf_trans"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    ARRAY_TYPE
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "aggtype"
      L_BRACK "["
      R_BRACK "]"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'{}'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "aggfns"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      PARAM
        PATH_TYPE
          TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n   "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "aggfns_trans"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    ARRAY_TYPE
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "aggtype"
      L_BRACK "["
      R_BRACK "]"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sspace"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "10000"
    COMMA ","
    WHITESPACE "\n   "
    NAME
      IDENT "initcond"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'{}'"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check error cases that would require run-time type coercion"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "int8"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n  "
        LITERAL
          STRING "'select least($1, $2)'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int4"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "least_accum"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "  "
  COMMENT "-- fails"
  WHITESPACE "\n\n"
  DROP_FUNCTION_STMT
    DROP_KW "drop"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "least_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "anycompatible"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "anycompatible"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "anycompatible"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n  "
        LITERAL
          STRING "'select least($1, $2)'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int4"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "least_accum"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "  "
  COMMENT "-- fails"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "least_accum"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_FUNCTION_STMT
    DROP_KW "drop"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "least_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "anycompatible"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "anycompatible"
      R_PAREN ")"
    WHITESPACE " "
    CASCADE_KW "cascade"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- variadic aggregates"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "anyelement"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "variadic"
        WHITESPACE " "
        PATH_TYPE
          IDENT "anyarray"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "anyelement"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n  "
        LITERAL
          STRING "'select least($1, min($2[i])) from generate_subscripts($2,1) g(i)'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "least_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "variadic"
        WHITESPACE " "
        NAME
          IDENT "items"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "anyarray"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "anyelement"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "least_accum"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "cleast_accum"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "anycompatible"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "variadic"
        WHITESPACE " "
        PATH_TYPE
          IDENT "anycompatiblearray"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "anycompatible"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n  "
        LITERAL
          STRING "'select least($1, min($2[i])) from generate_subscripts($2,1) g(i)'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "cleast_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "variadic"
        WHITESPACE " "
        NAME
          IDENT "items"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "anycompatiblearray"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "anycompatible"
    COMMA ","
    WHITESPACE " "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "cleast_accum"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- test ordered-set aggs using built-in support functions"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "my_percentile_disc"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      WHITESPACE " "
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "anyelement"
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "ordered_set_transition"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "percentile_disc_final"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "finalfunc_extra"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      TRUE_KW "true"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "finalfunc_modify"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "read_write"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "create"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "my_rank"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "VARIADIC"
        WHITESPACE " "
        PATH_TYPE
          IDENT "\"any\""
      WHITESPACE " "
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "VARIADIC"
        WHITESPACE " "
        PATH_TYPE
          IDENT "\"any\""
      R_PAREN ")"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE "\n  "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "ordered_set_transition_multi"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "rank_final"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "finalfunc_extra"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      TRUE_KW "true"
    COMMA ","
    WHITESPACE "\n  "
    NAME
      IDENT "hypothetical"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_AGGREGATE_STMT
    ALTER_KW "alter"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "my_percentile_disc"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      WHITESPACE " "
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "anyelement"
      R_PAREN ")"
    WHITESPACE "\n  "
    RENAME_KW "rename"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "test_percentile_disc"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_AGGREGATE_STMT
    ALTER_KW "alter"
    WHITESPACE " "
    AGGREGATE_KW "aggregate"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "my_rank"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "VARIADIC"
        WHITESPACE " "
        PATH_TYPE
          IDENT "\"any\""
      WHITESPACE " "
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      PARAM
        PARAM_VARIADIC
          VARIADIC_KW "VARIADIC"
        WHITESPACE " "
        PATH_TYPE
          IDENT "\"any\""
      R_PAREN ")"
    WHITESPACE "\n  "
    RENAME_KW "rename"
    WHITESPACE " "
    TO_KW "to"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "test_rank"
  SEMICOLON ";"
  WHITESPACE "\n\n\n"
  COMMENT "-- moving-aggregate options"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sumdouble"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n    "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "mstype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "msfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "minvfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8mi"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- aggregate combine and serialization functions"
  WHITESPACE "\n\n"
  COMMENT "-- can't specify just one of serialfunc and deserialfunc"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- serialfunc must have correct parameters"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_deserialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "deserialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_deserialize"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- deserialfunc must have correct parameters"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "deserialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- ensure combine function parameters are checked"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "deserialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_deserialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "combinefunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4larger"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- ensure create aggregate works."
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "deserialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_deserialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "combinefunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_combine"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc_modify"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "shareable"
    WHITESPACE "  "
    COMMENT "-- just to test a non-default setting"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure all these functions made it into the catalog"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "aggfnoid"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggtransfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggcombinefn"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "aggtranstype"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regtype"
        COMMA ","
        WHITESPACE "\n       "
        TARGET
          NAME_REF
            IDENT "aggserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggdeserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggfinalmodify"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_aggregate"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "aggfnoid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        CAST_EXPR
          LITERAL
            STRING "'myavg'"
          COLON2 "::"
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  IDENT "REGPROC"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_AGGREGATE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    CALL_EXPR
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "myavg"
      WHITESPACE " "
      PARAM_LIST
        L_PAREN "("
        PARAM
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  NUMERIC_KW "numeric"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- create or replace aggregate"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_accum"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "serialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_serialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "deserialfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_deserialize"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "combinefunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_avg_combine"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc_modify"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "shareable"
    WHITESPACE "  "
    COMMENT "-- just to test a non-default setting"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure all these functions made it into the catalog again"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "aggfnoid"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggtransfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggcombinefn"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "aggtranstype"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regtype"
        COMMA ","
        WHITESPACE "\n       "
        TARGET
          NAME_REF
            IDENT "aggserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggdeserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggfinalmodify"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_aggregate"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "aggfnoid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        CAST_EXPR
          LITERAL
            STRING "'myavg'"
          COLON2 "::"
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  IDENT "REGPROC"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- can change stype:"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            NUMERIC_KW "numeric"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_add"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "aggfnoid"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggtransfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggcombinefn"
        COMMA ","
        WHITESPACE " "
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "aggtranstype"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regtype"
        COMMA ","
        WHITESPACE "\n       "
        TARGET
          NAME_REF
            IDENT "aggserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggdeserialfn"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "aggfinalmodify"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_aggregate"
    WHITESPACE "\n"
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "aggfnoid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        CAST_EXPR
          LITERAL
            STRING "'myavg'"
          COLON2 "::"
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  IDENT "REGPROC"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- can't change return type:"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            NUMERIC_KW "numeric"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_add"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "finalfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_out"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- can't change to a different kind:"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "myavg"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                NUMERIC_KW "numeric"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            NUMERIC_KW "numeric"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "numeric_add"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- can't change plain function to aggregate:"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sum4"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "int8"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          STRING "'select $1 + $2 + $3 + $4'"
      WHITESPACE " "
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      STRICT_FUNC_OPTION
        STRICT_KW "strict"
      WHITESPACE " "
      VOLATILITY_FUNC_OPTION
        IMMUTABLE_KW "immutable"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sum3"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int8"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "sum4"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_FUNCTION_STMT
    DROP_KW "drop"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sum4"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      COMMA ","
      PARAM
        PATH_TYPE
          IDENT "int8"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_AGGREGATE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    CALL_EXPR
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "myavg"
      WHITESPACE " "
      PARAM_LIST
        L_PAREN "("
        PARAM
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  NUMERIC_KW "numeric"
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- invalid: bad parallel-safety marking"
  WHITESPACE "\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "mysum"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            INT_KW "int"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4pl"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      PARALLEL_KW "parallel"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "pear"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- invalid: nonstrict inverse with strict forward function"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "float8mi_n"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "float8"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$ SELECT $1 - $2; $$"
      WHITESPACE "\n"
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        SQL_KW "SQL"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "invalidsumdouble"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n    "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "mstype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "msfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "minvfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8mi_n"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- invalid: non-matching result types"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "float8mi_int"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      COMMA ","
      WHITESPACE " "
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$ SELECT CAST($1 - $2 AS INT); $$"
      WHITESPACE "\n"
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        SQL_KW "SQL"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "wrongreturntype"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n    "
    NAME
      IDENT "stype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "sfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "mstype"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "msfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8pl"
    COMMA ","
    WHITESPACE "\n    "
    NAME
      IDENT "minvfunc"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "float8mi_int"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- invalid: non-lowercase quoted identifiers"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "case_agg"
    WHITESPACE " "
    L_PAREN "("
    WHITESPACE " "
    COMMENT "-- old syntax"
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Sfunc1\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4pl"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Basetype\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Stype1\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "int4"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Initcond1\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'0'"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Parallel\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "safe"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_AGGREGATE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    AGGREGATE_KW "AGGREGATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "case_agg"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          IDENT "float8"
      R_PAREN ")"
    WHITESPACE "\n"
    L_PAREN "("
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Stype\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "internal"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Sfunc\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "ordered_set_transition"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Finalfunc\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "percentile_disc_final"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Finalfunc_extra\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      TRUE_KW "true"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Finalfunc_modify\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "read_write"
    COMMA ","
    WHITESPACE "\n\t"
    NAME
      IDENT "\"Parallel\""
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "safe"
    WHITESPACE "\n"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@1544: expected type name
ERROR@1544: expected R_PAREN
ERROR@1544: expected function option
ERROR@1544: expected SEMICOLON
ERROR@1544: expected command, found L_BRACK
ERROR@1545: expected command, found R_BRACK
ERROR@1546: expected command, found COMMA
ERROR@1547: expected command, found INTEGER_KW
ERROR@1554: expected command, found COMMA
ERROR@1555: expected command, found INTEGER_KW
ERROR@1562: expected command, found COMMA
ERROR@1563: expected command, found TEXT_KW
ERROR@1567: expected command, found R_PAREN
ERROR@1569: expected command, found RETURNS_KW
ERROR@1577: expected command, found IDENT
ERROR@1584: expected command, found L_BRACK
ERROR@1585: expected command, found R_BRACK
ERROR@1587: expected command, found AS_KW
ERROR@1590: expected command, found STRING
ERROR@1639: expected command, found LANGUAGE_KW
ERROR@1648: expected command, found SQL_KW
ERROR@1652: expected command, found STRICT_KW
ERROR@1659: expected command, found IMMUTABLE_KW
ERROR@1707: expected type name
ERROR@1707: expected R_PAREN
ERROR@1707: expected function option
ERROR@1707: expected SEMICOLON
ERROR@1707: expected command, found L_BRACK
ERROR@1708: expected command, found R_BRACK
ERROR@1709: expected command, found COMMA
ERROR@1710: expected command, found INTEGER_KW
ERROR@1717: expected command, found COMMA
ERROR@1718: expected command, found INTEGER_KW
ERROR@1725: expected command, found COMMA
ERROR@1726: expected command, found TEXT_KW
ERROR@1730: expected command, found R_PAREN
ERROR@1732: expected command, found RETURNS_KW
ERROR@1740: expected command, found IDENT
ERROR@1747: expected command, found L_BRACK
ERROR@1748: expected command, found R_BRACK
ERROR@1750: expected command, found AS_KW
ERROR@1753: expected command, found STRING
ERROR@1802: expected command, found LANGUAGE_KW
ERROR@1811: expected command, found SQL_KW
ERROR@1815: expected command, found IMMUTABLE_KW
