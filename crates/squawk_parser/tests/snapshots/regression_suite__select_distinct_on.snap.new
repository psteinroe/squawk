---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/select_distinct_on.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- SELECT_DISTINCT_ON"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "string4"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "string4"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "two"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "ten"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "onek"
    WHITESPACE "\n   "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "string4"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "two"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      R_ANGLE ">"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "ten"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- this will fail due to conflict of ordering requirements"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "string4"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "ten"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "string4"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "two"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "ten"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "onek"
    WHITESPACE "\n   "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "string4"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "two"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "ten"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "string4"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "ten"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "string4"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "ten"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "two"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "onek"
    WHITESPACE "\n   "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "string4"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "ten"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      R_ANGLE ">"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "two"
      WHITESPACE " "
      USING_KW "using"
      WHITESPACE " "
      L_ANGLE "<"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- bug #5049: early 8.4.x chokes on volatile DISTINCT ON clauses"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "distinct"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        L_PAREN "("
        LITERAL
          INT_NUMBER "1"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "floor"
            ARG_LIST
              L_PAREN "("
              CALL_EXPR
                NAME_REF
                  IDENT "random"
                ARG_LIST
                  L_PAREN "("
                  R_PAREN ")"
              R_PAREN ")"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "r"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "f1"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "int4_tbl"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "order"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test the planner's ability to use a LIMIT 1 instead of a Unique node when"
  WHITESPACE "\n"
  COMMENT "-- all of the distinct_pathkeys have been marked as redundant"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure we also get a LIMIT plan with DISTINCT ON"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "four"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "four"
        COMMA ","
        TARGET
          NAME_REF
            IDENT "two"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "four"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "0"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- and check the result of the above query is correct"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "four"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "four"
        COMMA ","
        TARGET
          NAME_REF
            IDENT "two"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "four"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "0"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure a Sort -> Limit is used when the ORDER BY contains additional cols"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "four"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "four"
        COMMA ","
        TARGET
          NAME_REF
            IDENT "two"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "four"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "0"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Same again but use a column that is indexed so that we get an index scan"
  WHITESPACE "\n"
  COMMENT "-- then a limit"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "four"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "four"
        COMMA ","
        TARGET
          NAME_REF
            IDENT "hundred"
    WHITESPACE "\n   "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "four"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "0"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test the planner's ability to reorder the distinctClause Pathkeys to match"
  WHITESPACE "\n"
  COMMENT "-- the input path's ordering"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "distinct_on_tbl"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "x"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "y"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "z"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "distinct_on_tbl"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "i"
              PERCENT "%"
              LITERAL
                INT_NUMBER "10"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "i"
              PERCENT "%"
              LITERAL
                INT_NUMBER "10"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "i"
              PERCENT "%"
              LITERAL
                INT_NUMBER "10"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1000"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "i"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_INDEX_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    INDEX_KW "INDEX"
    WHITESPACE " "
    NAME
      IDENT "distinct_on_tbl_x_y_idx"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "distinct_on_tbl"
    WHITESPACE " "
    INDEX_PARAMS
      L_PAREN "("
      NAME_REF
        IDENT "x"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "y"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "ANALYZE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "distinct_on_tbl"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Produce results with sorting."
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_hashagg"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    OFF_KW "OFF"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure we avoid the need to re-sort by reordering the distinctClause"
  WHITESPACE "\n"
  COMMENT "-- Pathkeys to match the ordering of the input path"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "distinct_on_tbl"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "distinct_on_tbl"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure we leverage incremental-sort by reordering the distinctClause"
  WHITESPACE "\n"
  COMMENT "-- Pathkeys to partially match the ordering of the input path"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "distinct_on_tbl"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "ORDER"
            WHITESPACE " "
            BY_KW "BY"
            WHITESPACE " "
            NAME_REF
              IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "distinct_on_tbl"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "ORDER"
            WHITESPACE " "
            BY_KW "BY"
            WHITESPACE " "
            NAME_REF
              IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure we reorder the distinctClause Pathkeys to match the ordering of the"
  WHITESPACE "\n"
  COMMENT "-- input path even if there is ORDER BY clause"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "distinct_on_tbl"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "y"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "distinct_on_tbl"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "y"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Ensure the resulting pathkey list matches the initial distinctClause Pathkeys"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "select"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "from"
            WHITESPACE " "
            NAME_REF
              IDENT "distinct_on_tbl"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "order"
            WHITESPACE " "
            BY_KW "by"
            WHITESPACE " "
            NAME_REF
              IDENT "x"
            COMMA ","
            WHITESPACE " "
            NAME_REF
              IDENT "z"
            COMMA ","
            WHITESPACE " "
            NAME_REF
              IDENT "y"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "y"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "x"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "z"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      DISTINCT_CLAUSE
        DISTINCT_KW "DISTINCT"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        L_PAREN "("
        NAME_REF
          IDENT "y"
        COMMA ","
        WHITESPACE " "
        NAME_REF
          IDENT "x"
        R_PAREN ")"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "x"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "y"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "select"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "from"
            WHITESPACE " "
            NAME_REF
              IDENT "distinct_on_tbl"
          WHITESPACE " "
          ORDER_BY_CLAUSE
            ORDER_KW "order"
            WHITESPACE " "
            BY_KW "by"
            WHITESPACE " "
            NAME_REF
              IDENT "x"
            COMMA ","
            WHITESPACE " "
            NAME_REF
              IDENT "z"
            COMMA ","
            WHITESPACE " "
            NAME_REF
              IDENT "y"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "y"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "x"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "z"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "enable_hashagg"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "distinct_on_tbl"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@800: expected R_PAREN
ERROR@801: expected command, found OFF_KW
ERROR@804: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@804: expected SEMICOLON
ERROR@804: expected command, found R_PAREN
ERROR@1105: expected R_PAREN
ERROR@1106: expected command, found OFF_KW
ERROR@1109: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@1109: expected SEMICOLON
ERROR@1109: expected command, found R_PAREN
ERROR@1296: expected R_PAREN
ERROR@1297: expected command, found OFF_KW
ERROR@1300: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@1300: expected SEMICOLON
ERROR@1300: expected command, found R_PAREN
ERROR@1928: expected R_PAREN
ERROR@1929: expected command, found OFF_KW
ERROR@1932: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@1932: expected SEMICOLON
ERROR@1932: expected command, found R_PAREN
ERROR@2189: expected R_PAREN
ERROR@2190: expected command, found OFF_KW
ERROR@2193: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@2193: expected SEMICOLON
ERROR@2193: expected command, found R_PAREN
ERROR@2499: expected R_PAREN
ERROR@2500: expected command, found OFF_KW
ERROR@2503: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@2503: expected SEMICOLON
ERROR@2503: expected command, found R_PAREN
ERROR@2729: expected R_PAREN
ERROR@2730: expected command, found OFF_KW
ERROR@2733: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@2733: expected SEMICOLON
ERROR@2733: expected command, found R_PAREN
