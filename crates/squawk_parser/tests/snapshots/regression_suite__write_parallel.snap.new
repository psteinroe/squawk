---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/write_parallel.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- PARALLEL"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "begin"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- encourage use of parallel plans"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_setup_cost"
    EQ "="
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "parallel_tuple_cost"
    EQ "="
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "min_parallel_table_scan_size"
    EQ "="
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "set"
    WHITESPACE " "
    NAME_REF
      IDENT "max_parallel_workers_per_gather"
    EQ "="
    LITERAL
      INT_NUMBER "4"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test write operations that has an underlying query that is eligible"
  WHITESPACE "\n"
  COMMENT "-- for parallel plans"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_write"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n    "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "length"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "stringu1"
                R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "tenk1"
      WHITESPACE " "
      GROUP_BY_CLAUSE
        GROUP_KW "group"
        WHITESPACE " "
        BY_KW "by"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "length"
          ARG_LIST
            L_PAREN "("
            NAME_REF
              IDENT "stringu1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_write"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n    "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "length"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "stringu1"
                R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "tenk1"
      WHITESPACE " "
      GROUP_BY_CLAUSE
        GROUP_KW "group"
        WHITESPACE " "
        BY_KW "by"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "length"
          ARG_LIST
            L_PAREN "("
            NAME_REF
              IDENT "stringu1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "drop"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_write"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  SELECT_INTO_STMT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "length"
            ARG_LIST
              L_PAREN "("
              NAME_REF
                IDENT "stringu1"
              R_PAREN ")"
    WHITESPACE " "
    INTO_CLAUSE
      INTO_KW "into"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME
            IDENT "parallel_write"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    GROUP_BY_CLAUSE
      GROUP_KW "group"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "length"
        ARG_LIST
          L_PAREN "("
          NAME_REF
            IDENT "stringu1"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT_INTO_STMT
    SELECT_CLAUSE
      SELECT_KW "select"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "length"
            ARG_LIST
              L_PAREN "("
              NAME_REF
                IDENT "stringu1"
              R_PAREN ")"
    WHITESPACE " "
    INTO_CLAUSE
      INTO_KW "into"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME
            IDENT "parallel_write"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "from"
      WHITESPACE " "
      NAME_REF
        IDENT "tenk1"
    WHITESPACE " "
    GROUP_BY_CLAUSE
      GROUP_KW "group"
      WHITESPACE " "
      BY_KW "by"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "length"
        ARG_LIST
          L_PAREN "("
          NAME_REF
            IDENT "stringu1"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "drop"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_write"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  CREATE_MATERIALIZED_VIEW_STMT
    CREATE_KW "create"
    WHITESPACE " "
    MATERIALIZED_KW "materialized"
    WHITESPACE " "
    VIEW_KW "view"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_mat_view"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n    "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "length"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "stringu1"
                R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "tenk1"
      WHITESPACE " "
      GROUP_BY_CLAUSE
        GROUP_KW "group"
        WHITESPACE " "
        BY_KW "by"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "length"
          ARG_LIST
            L_PAREN "("
            NAME_REF
              IDENT "stringu1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_MATERIALIZED_VIEW_STMT
    CREATE_KW "create"
    WHITESPACE " "
    MATERIALIZED_KW "materialized"
    WHITESPACE " "
    VIEW_KW "view"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_mat_view"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE "\n    "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "length"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "stringu1"
                R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "tenk1"
      WHITESPACE " "
      GROUP_BY_CLAUSE
        GROUP_KW "group"
        WHITESPACE " "
        BY_KW "by"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "length"
          ARG_LIST
            L_PAREN "("
            NAME_REF
              IDENT "stringu1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_INDEX_STMT
    CREATE_KW "create"
    WHITESPACE " "
    UNIQUE_KW "unique"
    WHITESPACE " "
    INDEX_KW "index"
    WHITESPACE " "
    ON_KW "on"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_mat_view"
    INDEX_PARAMS
      L_PAREN "("
      NAME_REF
        IDENT "length"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  REFRESH_STMT
    REFRESH_KW "refresh"
    WHITESPACE " "
    MATERIALIZED_KW "materialized"
    WHITESPACE " "
    VIEW_KW "view"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_mat_view"
  SEMICOLON ";"
  WHITESPACE "\n"
  REFRESH_STMT
    REFRESH_KW "refresh"
    WHITESPACE " "
    MATERIALIZED_KW "materialized"
    WHITESPACE " "
    VIEW_KW "view"
    WHITESPACE " "
    CONCURRENTLY_KW "concurrently"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_mat_view"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_MATERIALIZED_VIEW_STMT
    DROP_KW "drop"
    WHITESPACE " "
    MATERIALIZED_KW "materialized"
    WHITESPACE " "
    VIEW_KW "view"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_mat_view"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  PREPARE_STMT
    PREPARE_KW "prepare"
    WHITESPACE " "
    NAME
      IDENT "prep_stmt"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "select"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "length"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "stringu1"
                R_PAREN ")"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "from"
        WHITESPACE " "
        NAME_REF
          IDENT "tenk1"
      WHITESPACE " "
      GROUP_BY_CLAUSE
        GROUP_KW "group"
        WHITESPACE " "
        BY_KW "by"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "length"
          ARG_LIST
            L_PAREN "("
            NAME_REF
              IDENT "stringu1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "explain"
    WHITESPACE " "
    L_PAREN "("
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_write"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    EXECUTE_STMT
      EXECUTE_KW "execute"
      WHITESPACE " "
      NAME_REF
        IDENT "prep_stmt"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE_AS_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "parallel_write"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    EXECUTE_STMT
      EXECUTE_KW "execute"
      WHITESPACE " "
      NAME_REF
        IDENT "prep_stmt"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "drop"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "parallel_write"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ROLLBACK_STMT
    ROLLBACK_KW "rollback"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@305: expected R_PAREN
ERROR@306: expected command, found OFF_KW
ERROR@309: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@309: expected SEMICOLON
ERROR@309: expected command, found R_PAREN
ERROR@547: expected R_PAREN
ERROR@548: expected command, found OFF_KW
ERROR@551: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@551: expected SEMICOLON
ERROR@551: expected command, found R_PAREN
ERROR@767: expected R_PAREN
ERROR@768: expected command, found OFF_KW
ERROR@771: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@771: expected SEMICOLON
ERROR@771: expected command, found R_PAREN
ERROR@1290: expected R_PAREN
ERROR@1291: expected command, found OFF_KW
ERROR@1294: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@1294: expected SEMICOLON
ERROR@1294: expected command, found R_PAREN
