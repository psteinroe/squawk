---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/security_label.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test for facilities of security label"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- initial setups"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_min_messages"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    LITERAL
      STRING "'warning'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IF_EXISTS
      IF_KW "IF"
      WHITESPACE " "
      EXISTS_KW "EXISTS"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_seclabel_user1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IF_EXISTS
      IF_KW "IF"
      WHITESPACE " "
      EXISTS_KW "EXISTS"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_seclabel_user2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  RESET_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    NAME_REF
      IDENT "client_min_messages"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_USER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME
      IDENT "regress_seclabel_user1"
    WHITESPACE " "
    WITH_KW "WITH"
    WHITESPACE " "
    IDENT "CREATEROLE"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_USER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME
      IDENT "regress_seclabel_user2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl1"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "x"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "y"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_view1"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "seclabel_tbl2"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_four"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INTEGER_KW "integer"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          DOLLAR_QUOTED_STRING "$$SELECT 4$$"
      WHITESPACE " "
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        SQL_KW "sql"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_DOMAIN_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    DOMAIN_KW "DOMAIN"
    WHITESPACE " "
    NAME
      IDENT "seclabel_domain"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            TEXT_KW "text"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_tbl1"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_seclabel_user1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_tbl2"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_seclabel_user2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Test of SECURITY LABEL statement without a plugin"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'classified'"
  SEMICOLON ";"
  WHITESPACE "\t\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    LITERAL
      STRING "'dummy'"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'classified'"
  SEMICOLON ";"
  WHITESPACE "\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'...invalid label...'"
  SEMICOLON ";"
  WHITESPACE "\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "seclabel_tbl3"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'unclassified'"
  SEMICOLON ";"
  WHITESPACE "\t\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "regress_seclabel_user1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'classified'"
  SEMICOLON ";"
  WHITESPACE "\t\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    LITERAL
      STRING "'dummy'"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "regress_seclabel_user1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'classified'"
  SEMICOLON ";"
  WHITESPACE "\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "regress_seclabel_user1"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'...invalid label...'"
  SEMICOLON ";"
  WHITESPACE "\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n"
  SECURITY_LABEL_STMT
    SECURITY_KW "SECURITY"
    WHITESPACE " "
    LABEL_KW "LABEL"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "regress_seclabel_user3"
    WHITESPACE " "
    IS_KW "IS"
    WHITESPACE " "
    LITERAL
      STRING "'unclassified'"
  SEMICOLON ";"
  WHITESPACE "\t\t\t"
  COMMENT "-- fail"
  WHITESPACE "\n\n"
  COMMENT "-- clean up objects"
  WHITESPACE "\n"
  DROP_FUNCTION_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_four"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_DOMAIN_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    DOMAIN_KW "DOMAIN"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_domain"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_view1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_tbl1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "seclabel_tbl2"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_USER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_seclabel_user1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_USER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_seclabel_user2"
  SEMICOLON ";"
  WHITESPACE "\n"
