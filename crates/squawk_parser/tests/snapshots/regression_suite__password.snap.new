---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/password.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Tests for password types"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  COMMENT "-- Tests for GUC password_encryption"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'novalue'"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- error"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      TRUE_KW "true"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- error"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'md5'"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- ok"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'scram-sha-256'"
  SEMICOLON ";"
  WHITESPACE " "
  COMMENT "-- ok"
  WHITESPACE "\n\n"
  COMMENT "-- consistency of password entries"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'md5'"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd1"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'role_pwd1'"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd2"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd2"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'role_pwd2'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'scram-sha-256'"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd3"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'role_pwd3'"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd4"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    NULL_KW "NULL"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check list of created entries"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- The scram secret will look something like:"
  WHITESPACE "\n"
  COMMENT "-- SCRAM-SHA-256$4096:E4HxLGtnRzsYwg==$6YtlR4t69SguDiwFvbVgVZtuz6gpJQQqUMZ7IQJK5yI=:ps75jrHeYU4lXCcXI4O8oIdJ3eO8o2jirjruw9phBTo="
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Since the salt is random, the exact value stored will be different on every test"
  WHITESPACE "\n"
  COMMENT "-- run. Use a regular expression to mask the changing parts."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolname"
        COMMA ","
        WHITESPACE " "
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "regexp_replace"
            ARG_LIST
              L_PAREN "("
              NAME_REF
                IDENT "rolpassword"
              COMMA ","
              WHITESPACE " "
              LITERAL
                STRING "'(SCRAM-SHA-256)\\$(\\d+):([a-zA-Z0-9+/=]+)\\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)'"
              COMMA ","
              WHITESPACE " "
              LITERAL
                STRING "'\\1$\\2:<salt>$<storedkey>:<serverkey>'"
              R_PAREN ")"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "rolpassword_masked"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE "\n    "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        WHITESPACE " "
        LIKE_KW "LIKE"
        WHITESPACE " "
        LITERAL
          STRING "'regress_passwd%'"
    WHITESPACE "\n    "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "rolname"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "rolpassword"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Rename a role"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd2"
    WHITESPACE " "
    RENAME_KW "RENAME"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd2_new"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- md5 entry should have been removed"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolname"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "rolpassword"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE "\n    "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        WHITESPACE " "
        LIKE_KW "LIKE"
        WHITESPACE " "
        LITERAL
          STRING "'regress_passwd2_new'"
    WHITESPACE "\n    "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "rolname"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "rolpassword"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd2_new"
    WHITESPACE " "
    RENAME_KW "RENAME"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Change passwords with ALTER USER. With plaintext or already-encrypted"
  WHITESPACE "\n"
  COMMENT "-- passwords."
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'md5'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- encrypt with MD5"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd2"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'foo'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- already encrypted, use as they are"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd1"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'md5cd3578025fe2c3d7ed1b9a9b26238b70'"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd3"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$4096:VLK4RMaQLCvNtQ==$6YtlR4t69SguDiwFvbVgVZtuz6gpJQQqUMZ7IQJK5yI=:ps75jrHeYU4lXCcXI4O8oIdJ3eO8o2jirjruw9phBTo='"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "password_encryption"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      STRING "'scram-sha-256'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- create SCRAM secret"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE "  "
    IDENT "regress_passwd4"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'foo'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- already encrypted with MD5, use as it is"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd5"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'md5e73a4b11df52a6068f8b39f90be36023'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- This looks like a valid SCRAM-SHA-256 secret, but it is not"
  WHITESPACE "\n"
  COMMENT "-- so it should be hashed with SCRAM-SHA-256."
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd6"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$1234'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- These may look like valid MD5 secrets, but they are not, so they"
  WHITESPACE "\n"
  COMMENT "-- should be hashed with SCRAM-SHA-256."
  WHITESPACE "\n"
  COMMENT "-- trailing garbage at the end"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd7"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'md5012345678901234567890123456789zz'"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- invalid length"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd8"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'md501234567890123456789012345678901zz'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Changing the SCRAM iteration count"
  WHITESPACE "\n"
  SET_STMT
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "scram_iterations"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "1024"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd9"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'alterediterationcount'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolname"
        COMMA ","
        WHITESPACE " "
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "regexp_replace"
            ARG_LIST
              L_PAREN "("
              NAME_REF
                IDENT "rolpassword"
              COMMA ","
              WHITESPACE " "
              LITERAL
                STRING "'(SCRAM-SHA-256)\\$(\\d+):([a-zA-Z0-9+/=]+)\\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)'"
              COMMA ","
              WHITESPACE " "
              LITERAL
                STRING "'\\1$\\2:<salt>$<storedkey>:<serverkey>'"
              R_PAREN ")"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "rolpassword_masked"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE "\n    "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        WHITESPACE " "
        LIKE_KW "LIKE"
        WHITESPACE " "
        LITERAL
          STRING "'regress_passwd%'"
    WHITESPACE "\n    "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "rolname"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "rolpassword"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- An empty password is not allowed, in any form"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd_empty"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "''"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd_empty"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'md585939a5ce845f1a1b620742e3c659e0a'"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd_empty"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$4096:hpFyHTUsSWcR7O9P$LgZFIt6Oqdo27ZFKbZ2nV+vtnYM995pDh9ca6WSi120=:qVV5NeluNfUPkwm7Vqat25RjSPLkGeoZBQs6wVv+um4='"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolpassword"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        EQ "="
        LITERAL
          STRING "'regress_passwd_empty'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Test with invalid stored and server keys."
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- The first is valid, to act as a control. The others have too long"
  WHITESPACE "\n"
  COMMENT "-- stored/server keys. They will be re-hashed."
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd_sha_len0"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI='"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd_sha_len1"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96RqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI='"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd_sha_len2"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA='"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Check that the invalid secrets were re-hashed. A re-hashed secret"
  WHITESPACE "\n"
  COMMENT "-- should not contain the original salt."
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolname"
        COMMA ","
        WHITESPACE " "
        TARGET
          BIN_EXPR
            NAME_REF
              IDENT "rolpassword"
            WHITESPACE " "
            NOT_LIKE
              NOT_KW "not"
              WHITESPACE " "
              LIKE_KW "like"
            WHITESPACE " "
            LITERAL
              STRING "'%A6xHKoH/494E941doaPOYg==%'"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            IDENT "is_rolpassword_rehashed"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE "\n    "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        WHITESPACE " "
        LIKE_KW "LIKE"
        WHITESPACE " "
        LITERAL
          STRING "'regress_passwd_sha_len%'"
    WHITESPACE "\n    "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "rolname"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Test that valid hashes that are too long are rejected"
  WHITESPACE "\n"
  CREATE_ROLE_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME
      IDENT "regress_passwd10"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004096:wNFxNSk1hAXBkgub8py3bg==$65zC6E+R0U7tiYTC9+Wtq4Thw6gUDj3eDCINij8TflU=:rC1I7tcVugrHEY2DT0iPjGyjM4aJxkMM9n8WBxtUtHU='"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_ROLE_STMT
    ALTER_KW "ALTER"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    IDENT "regress_passwd9"
    WHITESPACE " "
    PASSWORD_KW "PASSWORD"
    WHITESPACE " "
    LITERAL
      STRING "'SCRAM-SHA-256$000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004096:wNFxNSk1hAXBkgub8py3bg==$65zC6E+R0U7tiYTC9+Wtq4Thw6gUDj3eDCINij8TflU=:rC1I7tcVugrHEY2DT0iPjGyjM4aJxkMM9n8WBxtUtHU='"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd2"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd3"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd4"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd5"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd6"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd7"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd8"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd9"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd_empty"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd_sha_len0"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd_sha_len1"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_ROLE_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    ROLE_KW "ROLE"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_passwd_sha_len2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- all entries should have been removed"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          NAME_REF
            IDENT "rolname"
        COMMA ","
        WHITESPACE " "
        TARGET
          NAME_REF
            IDENT "rolpassword"
    WHITESPACE "\n    "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_authid"
    WHITESPACE "\n    "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "rolname"
        WHITESPACE " "
        LIKE_KW "LIKE"
        WHITESPACE " "
        LITERAL
          STRING "'regress_passwd%'"
    WHITESPACE "\n    "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "rolname"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "rolpassword"
  SEMICOLON ";"
  WHITESPACE "\n"
