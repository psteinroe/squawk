---
source: crates/squawk_parser/tests/regression_suite.rs
assertion_line: 87
input_file: crates/squawk_parser/tests/data/regression_suite/merge.sql
---
SOURCE_FILE
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- MERGE"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n\n"
  CREATE_USER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME
      IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_USER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME
      IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_USER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME
      IDENT "regress_merge_none"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    IF_EXISTS
      IF_KW "IF"
      WHITESPACE " "
      EXISTS_KW "EXISTS"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    IF_EXISTS
      IF_KW "IF"
      WHITESPACE " "
      EXISTS_KW "EXISTS"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          TARGET_KW "target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          SOURCE_KW "source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE " "
    COMMENT "-- no index"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "30"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "t"
              DOT "."
              NAME_REF
                IDENT "ctid"
            WHITESPACE " "
            IS_NOT
              IS_KW "is"
              WHITESPACE " "
              NOT_KW "not"
            WHITESPACE " "
            LITERAL
              NULL_KW "null"
          WHITESPACE " "
          AS_KW "as"
          WHITESPACE " "
          NAME
            MATCHED_KW "matched"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            STAR "*"
        COMMA ","
        WHITESPACE " "
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      JOIN
        FULL_KW "FULL"
        WHITESPACE " "
        OUTER_KW "OUTER"
        WHITESPACE " "
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          TARGET_KW "target"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "t"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "target2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "source2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "target2"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "source2"
    WHITESPACE " "
    OWNER_TO
      OWNER_KW "OWNER"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SET_SESSION_AUTH_STMT
    SET_KW "SET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
    WHITESPACE " "
    IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- Errors"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      NAME_REF
        IDENT "RANDOMWORD"
      WHITESPACE "\n"
      ERROR
        USING_KW "USING"
  WHITESPACE " "
  ERROR
    SOURCE_KW "source"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "s"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "s"
  ERROR
    DOT "."
  ERROR
    IDENT "sid"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SET_KW "SET"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- MATCHED/INSERT error"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- NOT MATCHED BY SOURCE/INSERT error"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- incorrectly specifying INTO target"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
  WHITESPACE " "
  ERROR
    INTO_KW "INTO"
  WHITESPACE " "
  ERROR
    TARGET_KW "target"
  WHITESPACE " "
  ERROR
    DEFAULT_KW "DEFAULT"
  WHITESPACE " "
  SELECT
    VALUES_KW "VALUES"
    ERROR
      SEMICOLON ";"
    WHITESPACE "\n"
    COMMENT "-- Multiple VALUES clause"
    WHITESPACE "\n"
    ERROR
      MERGE_KW "MERGE"
    WHITESPACE " "
    ERROR
      INTO_KW "INTO"
    WHITESPACE " "
    ERROR
      TARGET_KW "target"
    WHITESPACE " "
    ERROR
      IDENT "t"
    WHITESPACE "\n"
    ERROR
      USING_KW "USING"
    WHITESPACE " "
    ERROR
      SOURCE_KW "source"
    WHITESPACE " "
    ERROR
      AS_KW "AS"
    WHITESPACE " "
    ERROR
      IDENT "s"
    WHITESPACE "\n"
    ERROR
      ON_KW "ON"
    WHITESPACE " "
    ERROR
      IDENT "t"
    ERROR
      DOT "."
    ERROR
      IDENT "tid"
    WHITESPACE " "
    ERROR
      EQ "="
    WHITESPACE " "
    ERROR
      IDENT "s"
    ERROR
      DOT "."
    ERROR
      IDENT "sid"
    WHITESPACE "\n"
    ERROR
      WHEN_KW "WHEN"
    WHITESPACE " "
    ERROR
      NOT_KW "NOT"
    WHITESPACE " "
    ERROR
      MATCHED_KW "MATCHED"
    WHITESPACE " "
    ERROR
      THEN_KW "THEN"
    WHITESPACE "\n\t"
    ERROR
      INSERT_KW "INSERT"
    WHITESPACE " "
    ERROR
      VALUES_KW "VALUES"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "1"
    COMMA ","
    LITERAL
      INT_NUMBER "1"
    R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "2"
    COMMA ","
    LITERAL
      INT_NUMBER "2"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- SELECT query for INSERT"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
  WHITESPACE " "
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          TUPLE_EXPR
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            WHITESPACE " "
            LITERAL
              INT_NUMBER "1"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- NOT MATCHED/UPDATE"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- NOT MATCHED BY TARGET/UPDATE"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    TARGET_KW "TARGET"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- UPDATE tablename"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    NAME_REF
      TARGET_KW "target"
    WHITESPACE " "
    NAME_REF
      SET_KW "SET"
  WHITESPACE " "
  ERROR
    IDENT "balance"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- source and target names the same"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "tid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DO_KW "DO"
    WHITESPACE " "
    NOTHING_KW "NOTHING"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- used in a CTE without RETURNING"
  WHITESPACE "\n"
  SELECT
    WITH_CLAUSE
      WITH_KW "WITH"
      WHITESPACE " "
      WITH_TABLE
        NAME
          IDENT "foo"
        WHITESPACE " "
        AS_KW "AS"
        WHITESPACE " "
        L_PAREN "("
        WHITESPACE "\n  "
        MERGE_STMT
          MERGE_KW "MERGE"
          WHITESPACE " "
          INTO_KW "INTO"
          WHITESPACE " "
          PATH
            PATH_SEGMENT
              NAME_REF
                TARGET_KW "target"
          WHITESPACE " "
          USING_CLAUSE
            USING_KW "USING"
            WHITESPACE " "
            NAME_REF
              SOURCE_KW "source"
            WHITESPACE " "
            ON_KW "ON"
            WHITESPACE " "
            PAREN_EXPR
              L_PAREN "("
              LITERAL
                TRUE_KW "true"
              R_PAREN ")"
          WHITESPACE "\n  "
          WHEN_KW "WHEN"
          WHITESPACE " "
          MATCHED_KW "MATCHED"
          WHITESPACE " "
          THEN_KW "THEN"
          WHITESPACE " "
          DELETE_KW "DELETE"
        WHITESPACE "\n"
        R_PAREN ")"
    WHITESPACE " "
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "foo"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- used in COPY without RETURNING"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
  WHITESPACE "\n  "
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        LITERAL
          TRUE_KW "true"
        R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
  WHITESPACE "\n"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  ERROR
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    STDOUT_KW "stdout"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- unsupported relation types"
  WHITESPACE "\n"
  COMMENT "-- materialized view"
  WHITESPACE "\n"
  CREATE_MATERIALIZED_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    MATERIALIZED_KW "MATERIALIZED"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "mv"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          TARGET_KW "target"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "mv"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_MATERIALIZED_VIEW_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    MATERIALIZED_KW "MATERIALIZED"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "mv"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- permissions"
  WHITESPACE "\n\n"
  SET_SESSION_AUTH_STMT
    SET_KW "SET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
    WHITESPACE " "
    IDENT "regress_merge_none"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                LITERAL
                  INT_NUMBER "1"
        R_PAREN ")"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      LITERAL
        TRUE_KW "true"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DO_KW "DO"
    WHITESPACE " "
    NOTHING_KW "NOTHING"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SET_SESSION_AUTH_STMT
    SET_KW "SET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
    WHITESPACE " "
    IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "source2"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            TARGET_KW "target"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "source2"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_SESSION_AUTH_STMT
    SET_KW "SET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
    WHITESPACE " "
    IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "source2"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            TARGET_KW "target"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "source2"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  GRANT_STMT
    GRANT_KW "GRANT"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "target2"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  SET_SESSION_AUTH_STMT
    SET_KW "SET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
    WHITESPACE " "
    IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "target2"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "target2"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            SOURCE_KW "source"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "target2"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "target2"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            SOURCE_KW "source"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check if the target can be accessed from source relation subquery; we should"
  WHITESPACE "\n"
  COMMENT "-- not be able to do so"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              SOURCE_KW "source"
          WHITESPACE " "
          WHERE_CLAUSE
            WHERE_KW "WHERE"
            WHITESPACE " "
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  IDENT "t"
                DOT "."
                NAME_REF
                  IDENT "tid"
              WHITESPACE " "
              R_ANGLE ">"
              WHITESPACE " "
              NAME_REF
                IDENT "sid"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- initial tests"
  WHITESPACE "\n"
  COMMENT "--"
  WHITESPACE "\n"
  COMMENT "-- zero rows in source has no effect"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            TARGET_KW "target"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            SOURCE_KW "source"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- insert some non-matching source rows to work from"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "40"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DO_KW "DO"
    WHITESPACE " "
    NOTHING_KW "NOTHING"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE " "
    VALUES_KW "VALUES"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- DELETE/INSERT not matched by source/target"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    TARGET_KW "TARGET"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
    WHITESPACE "\n"
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      OLD_KW "old"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      NEW_KW "new"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "t"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- index plans"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            CALL_EXPR
              NAME_REF
                IDENT "generate_series"
              ARG_LIST
                L_PAREN "("
                LITERAL
                  INT_NUMBER "1000"
                COMMA ","
                LITERAL
                  INT_NUMBER "2500"
                R_PAREN ")"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ADD_CONSTRAINT
      ADD_KW "ADD"
      WHITESPACE " "
      PRIMARY_KEY_CONSTRAINT
        PRIMARY_KW "PRIMARY"
        WHITESPACE " "
        KEY_KW "KEY"
        WHITESPACE " "
        COLUMN_LIST
          L_PAREN "("
          COLUMN
            NAME_REF
              IDENT "tid"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "ANALYZE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DELETE_STMT
    DELETE_KW "DELETE"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        R_ANGLE ">"
        WHITESPACE " "
        LITERAL
          INT_NUMBER "100"
  SEMICOLON ";"
  WHITESPACE "\n"
  ANALYZE_STMT
    ANALYZE_KW "ANALYZE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- insert some matching source rows to work from"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "5"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- equivalent of an UPDATE join"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- equivalent of a DELETE join"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DO_KW "DO"
    WHITESPACE " "
    NOTHING_KW "NOTHING"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- duplicate source row causes multiple target row update ERROR"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "5"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- remove duplicate MATCHED data from source data"
  WHITESPACE "\n"
  DELETE_STMT
    DELETE_KW "DELETE"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "5"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- duplicate source row on INSERT should fail because of target_pkey"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "40"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n  "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- remove duplicate NOT MATCHED data from source data"
  WHITESPACE "\n"
  DELETE_STMT
    DELETE_KW "DELETE"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "4"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "40"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- remove constraints"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    DROP_CONSTRAINT
      DROP_KW "drop"
      WHITESPACE " "
      CONSTRAINT_KW "CONSTRAINT"
      WHITESPACE " "
      NAME_REF
        IDENT "target_pkey"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "alter"
    WHITESPACE " "
    TABLE_KW "table"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALTER_COLUMN
      ALTER_KW "alter"
      WHITESPACE " "
      COLUMN_KW "column"
      WHITESPACE " "
      IDENT "tid"
      WHITESPACE " "
      DROP_NOT_NULL
        DROP_KW "drop"
        WHITESPACE " "
        NOT_KW "not"
        WHITESPACE " "
        NULL_KW "null"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- multiple actions"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "4"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- should be equivalent"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "4"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- column references"
  WHITESPACE "\n"
  COMMENT "-- do a simple equivalent of an UPDATE join"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- do a simple equivalent of an INSERT SELECT"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- and again with duplicate source rows"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "5"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "50"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "5"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "50"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- do a simple equivalent of an INSERT SELECT"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n  "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- removing duplicate source rows"
  WHITESPACE "\n"
  DELETE_STMT
    DELETE_KW "DELETE"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "5"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- and again with explicitly identified column list"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- and again with a subtle error: referring to non-existent target row for NOT MATCHED"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- and again with a constant ON clause"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                LITERAL
                  TRUE_KW "true"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- now the classic UPSERT"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- unreachable WHEN clause should ERROR"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    COMMENT "/* Terminal WHEN clause for MATCHED */"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      MINUS "-"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- conditional WHEN clause"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "wq_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "not"
          WHITESPACE " "
          NULL_KW "null"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        DEFAULT_CONSTRAINT
          DEFAULT_KW "DEFAULT"
          WHITESPACE " "
          PREFIX_EXPR
            MINUS "-"
            LITERAL
              INT_NUMBER "1"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "wq_source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_source"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- try a simple INSERT with default values first"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- this time with a FALSE condition"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    LITERAL
      FALSE_KW "FALSE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- this time with an actual condition which returns false"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      NEQB "<>"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- and now with a condition which returns true"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- conditions in the NOT MATCHED clause can only refer to source columns"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- conditions in NOT MATCHED BY SOURCE clause can only refer to target columns"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- conditions in MATCHED clause can refer to both source and target"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check if AND works"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "99"
      WHITESPACE " "
      AND_KW "AND"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        R_ANGLE ">"
        WHITESPACE " "
        LITERAL
          INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "99"
      WHITESPACE " "
      AND_KW "AND"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check if OR works"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "99"
      WHITESPACE " "
      OR_KW "OR"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        R_ANGLE ">"
        WHITESPACE " "
        LITERAL
          INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "199"
      WHITESPACE " "
      OR_KW "OR"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "balance"
        WHITESPACE " "
        R_ANGLE ">"
        WHITESPACE " "
        LITERAL
          INT_NUMBER "100"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check source-side whole-row references"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "matched"
    WHITESPACE " "
    AND_KW "and"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        NAME_REF
          IDENT "t"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "s"
      WHITESPACE " "
      OR_KW "or"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check if subqueries work in the conditions?"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      R_ANGLE ">"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                CALL_EXPR
                  NAME_REF
                    IDENT "max"
                  ARG_LIST
                    L_PAREN "("
                    NAME_REF
                      IDENT "balance"
                    R_PAREN ")"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              TARGET_KW "target"
        R_PAREN ")"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- check if we can access system columns in the conditions"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "xmin"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "xmax"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "tableoid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "0"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "balance"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "wq_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_target"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "wq_source"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- test triggers"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "or"
      WHITESPACE " "
      REPLACE_KW "replace"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_trigfunc"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TRIGGER_KW "trigger"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nDECLARE\n\tline text;\nBEGIN\n\tSELECT INTO line format('%s %s %s trigger%s',\n\t\tTG_WHEN, TG_OP, TG_LEVEL, CASE\n\t\tWHEN TG_OP = 'INSERT' AND TG_LEVEL = 'ROW'\n\t\t\tTHEN format(' row: %s', NEW)\n\t\tWHEN TG_OP = 'UPDATE' AND TG_LEVEL = 'ROW'\n\t\t\tTHEN format(' row: %s -> %s', OLD, NEW)\n\t\tWHEN TG_OP = 'DELETE' AND TG_LEVEL = 'ROW'\n\t\t\tTHEN format(' row: %s', OLD)\n\t\tEND);\n\n\tRAISE NOTICE '%', line;\n\tIF (TG_WHEN = 'BEFORE' AND TG_LEVEL = 'ROW') THEN\n\t\tIF (TG_OP = 'DELETE') THEN\n\t\t\tRETURN OLD;\n\t\tELSE\n\t\t\tRETURN NEW;\n\t\tEND IF;\n\tELSE\n\t\tRETURN NULL;\n\tEND IF;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_bsi"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_bsu"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_bsd"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_asi"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_asu"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_asd"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    STATEMENT_KW "STATEMENT"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_bri"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_bru"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_brd"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_ari"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_aru"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "merge_ard"
    WHITESPACE " "
    AFTER_KW "AFTER"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "merge_trigfunc"
      WHITESPACE " "
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- now the classic UPSERT, with a DELETE"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "3"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "--EXPLAIN (ANALYZE ON, COSTS OFF, SUMMARY OFF, TIMING OFF)"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      R_ANGLE ">"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      MINUS "-"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- UPSERT with UPDATE/DELETE when not matched by source"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  DELETE_STMT
    DELETE_KW "DELETE"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "SOURCE"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        SOURCE_KW "source"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      R_ANGLE ">"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      MINUS "-"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "0"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      OLD_KW "old"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      NEW_KW "new"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "t"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Test behavior of triggers that turn UPDATE/DELETE into no-ops"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "create"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "or"
      WHITESPACE " "
      REPLACE_KW "replace"
    WHITESPACE " "
    FUNCTION_KW "function"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "skip_merge_op"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "returns"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TRIGGER_KW "trigger"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "language"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "as"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nBEGIN\n\tRETURN NULL;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
      WHITESPACE " "
      JOIN
        FULL_KW "full"
        WHITESPACE " "
        OUTER_KW "outer"
        WHITESPACE " "
        JOIN_KW "join"
        WHITESPACE " "
        NAME_REF
          SOURCE_KW "source"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            NAME_REF
              IDENT "sid"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            NAME_REF
              IDENT "tid"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "create"
    WHITESPACE " "
    TRIGGER_KW "trigger"
    WHITESPACE " "
    NAME
      IDENT "merge_skip"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    OR_KW "OR"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    OR_KW "or"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n  "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "skip_merge_op"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO target t\nUSING source AS s\nON t.tid = s.sid\nWHEN MATCHED AND s.sid = 3 THEN UPDATE SET balance = t.balance + s.delta\nWHEN MATCHED THEN DELETE\nWHEN NOT MATCHED THEN INSERT VALUES (sid, delta);\nIF FOUND THEN\n  RAISE NOTICE 'Found';\nELSE\n  RAISE NOTICE 'Not found';\nEND IF;\nGET DIAGNOSTICS result := ROW_COUNT;\nRAISE NOTICE 'ROW_COUNT = %', result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
      WHITESPACE " "
      JOIN
        FULL_KW "FULL"
        WHITESPACE " "
        OUTER_KW "OUTER"
        WHITESPACE " "
        JOIN_KW "JOIN"
        WHITESPACE " "
        NAME_REF
          SOURCE_KW "source"
        WHITESPACE " "
        ON_KW "ON"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            NAME_REF
              IDENT "sid"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            NAME_REF
              IDENT "tid"
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TRIGGER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "merge_skip"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_FUNCTION_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "skip_merge_op"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- test from PL/pgSQL"
  WHITESPACE "\n"
  COMMENT "-- make sure MERGE INTO isn't interpreted to mean returning variables like SELECT INTO"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LANGUAGE_KW "LANGUAGE"
    WHITESPACE " "
    IDENT "plpgsql"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nBEGIN\nMERGE INTO target t\nUSING source AS s\nON t.tid = s.sid\nWHEN MATCHED AND t.balance > s.delta THEN\n\tUPDATE SET balance = t.balance - s.delta;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--source constants"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                LITERAL
                  INT_NUMBER "9"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "sid"
              COMMA ","
              WHITESPACE " "
              TARGET
                LITERAL
                  INT_NUMBER "57"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "delta"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--source query"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  IDENT "sid"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "delta"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              SOURCE_KW "source"
          WHITESPACE " "
          WHERE_CLAUSE
            WHERE_KW "WHERE"
            WHITESPACE " "
            BIN_EXPR
              NAME_REF
                IDENT "delta"
              WHITESPACE " "
              R_ANGLE ">"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "0"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  IDENT "sid"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "delta"
                WHITESPACE " "
                AS_KW "as"
                WHITESPACE " "
                NAME
                  IDENT "newname"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              SOURCE_KW "source"
          WHITESPACE " "
          WHERE_CLAUSE
            WHERE_KW "WHERE"
            WHITESPACE " "
            BIN_EXPR
              NAME_REF
                IDENT "delta"
              WHITESPACE " "
              R_ANGLE ">"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "0"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "newname"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "--self-merge"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t1"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "t2"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t1"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "t2"
          DOT "."
          NAME_REF
            IDENT "tid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t1"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "t2"
        DOT "."
        NAME_REF
          IDENT "balance"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "t2"
        DOT "."
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "t2"
        DOT "."
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  IDENT "tid"
                WHITESPACE " "
                AS_KW "as"
                WHITESPACE " "
                NAME
                  IDENT "sid"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "balance"
                WHITESPACE " "
                AS_KW "as"
                WHITESPACE " "
                NAME
                  IDENT "delta"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              TARGET_KW "target"
          WHITESPACE " "
          WHERE_CLAUSE
            WHERE_KW "WHERE"
            WHITESPACE " "
            BIN_EXPR
              NAME_REF
                IDENT "balance"
              WHITESPACE " "
              R_ANGLE ">"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "0"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE "\n"
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  IDENT "sid"
              COMMA ","
              WHITESPACE " "
              TARGET
                CALL_EXPR
                  NAME_REF
                    IDENT "max"
                  ARG_LIST
                    L_PAREN "("
                    NAME_REF
                      IDENT "delta"
                    R_PAREN ")"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "delta"
          WHITESPACE "\n "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              SOURCE_KW "source"
          WHITESPACE "\n "
          GROUP_BY_CLAUSE
            GROUP_KW "GROUP"
            WHITESPACE " "
            BY_KW "BY"
            WHITESPACE " "
            NAME_REF
              IDENT "sid"
          WHITESPACE "\n "
          HAVING_CLAUSE
            HAVING_KW "HAVING"
            WHITESPACE " "
            BIN_EXPR
              CALL_EXPR
                NAME_REF
                  IDENT "count"
                ARG_LIST
                  L_PAREN "("
                  STAR "*"
                  R_PAREN ")"
              WHITESPACE " "
              EQ "="
              WHITESPACE " "
              LITERAL
                INT_NUMBER "1"
          WHITESPACE "\n "
          ORDER_BY_CLAUSE
            ORDER_KW "ORDER"
            WHITESPACE " "
            BY_KW "BY"
            WHITESPACE " "
            NAME_REF
              IDENT "sid"
            WHITESPACE " "
            ASC_KW "ASC"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- plpgsql parameters and results"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_func"
    WHITESPACE " "
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "p_id"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      PARAM
        NAME
          IDENT "p_bal"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INTEGER_KW "INTEGER"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE "\n"
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nDECLARE\n result integer;\nBEGIN\nMERGE INTO target t\nUSING (SELECT p_id AS sid) AS s\nON t.tid = s.sid\nWHEN MATCHED THEN\n\tUPDATE SET balance = t.balance - p_bal;\nIF FOUND THEN\n\tGET DIAGNOSTICS result := ROW_COUNT;\nEND IF;\nRETURN result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "merge_func"
            ARG_LIST
              L_PAREN "("
              LITERAL
                INT_NUMBER "3"
              COMMA ","
              WHITESPACE " "
              LITERAL
                INT_NUMBER "4"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- PREPARE"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  PREPARE_STMT
    PREPARE_KW "prepare"
    WHITESPACE " "
    NAME
      IDENT "foom"
    WHITESPACE " "
    AS_KW "as"
    WHITESPACE " "
    MERGE_STMT
      MERGE_KW "merge"
      WHITESPACE " "
      INTO_KW "into"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME_REF
            TARGET_KW "target"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "t"
      WHITESPACE " "
      USING_CLAUSE
        USING_KW "using"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "select"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  LITERAL
                    INT_NUMBER "1"
                  WHITESPACE " "
                  AS_KW "as"
                  WHITESPACE " "
                  NAME
                    IDENT "sid"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE " "
        ON_KW "on"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "t"
              DOT "."
              NAME_REF
                IDENT "tid"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "s"
              DOT "."
              NAME_REF
                IDENT "sid"
          R_PAREN ")"
      WHITESPACE " "
      WHEN_KW "when"
      WHITESPACE " "
      MATCHED_KW "matched"
      WHITESPACE " "
      THEN_KW "then"
      WHITESPACE " "
      UPDATE_KW "update"
      WHITESPACE " "
      SET_KW "set"
      WHITESPACE " "
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  EXECUTE_STMT
    EXECUTE_KW "execute"
    WHITESPACE " "
    NAME_REF
      IDENT "foom"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  PREPARE_STMT
    PREPARE_KW "PREPARE"
    WHITESPACE " "
    NAME
      IDENT "foom2"
    WHITESPACE " "
    L_PAREN "("
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            INTEGER_KW "integer"
    COMMA ","
    WHITESPACE " "
    PATH_TYPE
      PATH
        PATH_SEGMENT
          NAME_REF
            INTEGER_KW "integer"
    R_PAREN ")"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE "\n"
    MERGE_STMT
      MERGE_KW "MERGE"
      WHITESPACE " "
      INTO_KW "INTO"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME_REF
            TARGET_KW "target"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "t"
      WHITESPACE "\n"
      USING_CLAUSE
        USING_KW "USING"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "SELECT"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  LITERAL
                    INT_NUMBER "1"
          R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "s"
        WHITESPACE "\n"
        ON_KW "ON"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            PARAM "$1"
      WHITESPACE "\n"
      WHEN_KW "WHEN"
      WHITESPACE " "
      MATCHED_KW "MATCHED"
      WHITESPACE " "
      THEN_KW "THEN"
      WHITESPACE "\n"
      UPDATE_KW "UPDATE"
      WHITESPACE " "
      SET_KW "SET"
      WHITESPACE " "
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        PARAM "$2"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "--EXPLAIN (ANALYZE ON, COSTS OFF, SUMMARY OFF, TIMING OFF)"
  WHITESPACE "\n"
  EXECUTE_STMT
    EXECUTE_KW "execute"
    WHITESPACE " "
    NAME_REF
      IDENT "foom2"
    WHITESPACE " "
    ARG_LIST
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        TARGET_KW "target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- subqueries in source relation"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sq_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "NOT"
          WHITESPACE " "
          NULL_KW "NULL"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sq_source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        DEFAULT_CONSTRAINT
          DEFAULT_KW "DEFAULT"
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "100"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      LITERAL
        INT_NUMBER "200"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      LITERAL
        INT_NUMBER "300"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_source"
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "4"
      COMMA ","
      LITERAL
        INT_NUMBER "40"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "sq_source"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      R_ANGLE ">"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try a view"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "v"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "sq_source"
      WHITESPACE " "
      WHERE_CLAUSE
        WHERE_KW "WHERE"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "sid"
          WHITESPACE " "
          L_ANGLE "<"
          WHITESPACE " "
          LITERAL
            INT_NUMBER "2"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "v"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- ambiguous reference to a column"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      BIN_EXPR
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PLUS "+"
        WHITESPACE " "
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      L_ANGLE "<"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_source"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      BIN_EXPR
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PLUS "+"
        WHITESPACE " "
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      L_ANGLE "<"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- CTEs"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_source"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    WITH_CLAUSE
      WITH_KW "WITH"
      WHITESPACE " "
      WITH_TABLE
        NAME
          IDENT "targq"
        WHITESPACE " "
        AS_KW "AS"
        WHITESPACE " "
        L_PAREN "("
        WHITESPACE "\n\t"
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "v"
        WHITESPACE "\n"
        R_PAREN ")"
    WHITESPACE "\n"
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      BIN_EXPR
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PLUS "+"
        WHITESPACE " "
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      L_ANGLE "<"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- RETURNING"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_source"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_actions"
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          ACTION_KW "action"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "abbrev"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "merge_actions"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'INSERT'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'ins'"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'UPDATE'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'upd'"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        STRING "'DELETE'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'del'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      BIN_EXPR
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PLUS "+"
        WHITESPACE " "
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      L_ANGLE "<"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    PAREN_EXPR
      L_PAREN "("
      SELECT
        SELECT_CLAUSE
          SELECT_KW "SELECT"
          WHITESPACE " "
          TARGET_LIST
            TARGET
              NAME_REF
                IDENT "abbrev"
        WHITESPACE " "
        FROM_CLAUSE
          FROM_KW "FROM"
          WHITESPACE " "
          NAME_REF
            IDENT "merge_actions"
        WHITESPACE "\n            "
        WHERE_CLAUSE
          WHERE_KW "WHERE"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              ACTION_KW "action"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            CALL_EXPR
              NAME_REF
                MERGE_ACTION_KW "merge_action"
              ARG_LIST
                L_PAREN "("
                R_PAREN ")"
      R_PAREN ")"
    WHITESPACE " "
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    ACTION_KW "action"
  ERROR
    COMMA ","
  WHITESPACE "\n          "
  ERROR
    OLD_KW "old"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "old_tid"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    OLD_KW "old"
  ERROR
    DOT "."
  ERROR
    IDENT "balance"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "old_balance"
  ERROR
    COMMA ","
  WHITESPACE "\n          "
  ERROR
    NEW_KW "new"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "new_tid"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    NEW_KW "new"
  ERROR
    DOT "."
  ERROR
    IDENT "balance"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "new_balance"
  ERROR
    COMMA ","
  WHITESPACE "\n          "
  PAREN_EXPR
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            BIN_EXPR
              FIELD_EXPR
                NAME_REF
                  NEW_KW "new"
                DOT "."
                NAME_REF
                  IDENT "balance"
              WHITESPACE " "
              MINUS "-"
              WHITESPACE " "
              FIELD_EXPR
                NAME_REF
                  OLD_KW "old"
                DOT "."
                NAME_REF
                  IDENT "balance"
            WHITESPACE " "
            AS_KW "AS"
            WHITESPACE " "
            NAME
              IDENT "delta_balance"
    R_PAREN ")"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    STAR "*"
  ERROR
    COMMA ","
  WHITESPACE "\n          "
  ERROR
    CASE_KW "CASE"
  WHITESPACE " "
  ERROR
    MERGE_ACTION_KW "merge_action"
  ERROR
    L_PAREN "("
  ERROR
    R_PAREN ")"
  WHITESPACE "\n              "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'INSERT'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Inserted '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "t"
  WHITESPACE "\n              "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'UPDATE'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Added '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "delta"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    STRING "' to balance'"
  WHITESPACE "\n              "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'DELETE'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Removed '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "t"
  WHITESPACE "\n          "
  COMMIT_STMT
    END_KW "END"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "description"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- error when using merge_action() outside MERGE"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              MERGE_ACTION_KW "merge_action"
            ARG_LIST
              L_PAREN "("
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
    WHITESPACE " "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- RETURNING in CTEs"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "sq_target_merge_log"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "NOT"
          WHITESPACE " "
          NULL_KW "NULL"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "last_change"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target_merge_log"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'Original value'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  WITH_CLAUSE
    WITH_KW "WITH"
    WHITESPACE " "
    WITH_TABLE
      NAME
        IDENT "m"
      WHITESPACE " "
      AS_KW "AS"
      WHITESPACE " "
      L_PAREN "("
      WHITESPACE "\n    "
      MERGE_STMT
        MERGE_KW "MERGE"
        WHITESPACE " "
        INTO_KW "INTO"
        WHITESPACE " "
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "sq_target"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "t"
        WHITESPACE "\n    "
        USING_CLAUSE
          USING_KW "USING"
          WHITESPACE " "
          NAME_REF
            IDENT "sq_source"
          WHITESPACE " "
          ALIAS
            NAME
              IDENT "s"
          WHITESPACE "\n    "
          ON_KW "ON"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "tid"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            NAME_REF
              IDENT "sid"
        WHITESPACE "\n    "
        WHEN_KW "WHEN"
        WHITESPACE " "
        MATCHED_KW "MATCHED"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "tid"
          WHITESPACE " "
          GTEQ ">="
          WHITESPACE " "
          LITERAL
            INT_NUMBER "2"
        WHITESPACE " "
        THEN_KW "THEN"
        WHITESPACE "\n        "
        UPDATE_KW "UPDATE"
        WHITESPACE " "
        SET_KW "SET"
        WHITESPACE " "
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "balance"
          WHITESPACE " "
          PLUS "+"
          WHITESPACE " "
          NAME_REF
            IDENT "delta"
        WHITESPACE "\n    "
        WHEN_KW "WHEN"
        WHITESPACE " "
        NOT_KW "NOT"
        WHITESPACE " "
        MATCHED_KW "MATCHED"
        WHITESPACE " "
        THEN_KW "THEN"
        WHITESPACE "\n        "
        INSERT_KW "INSERT"
        WHITESPACE " "
        COLUMN_LIST
          L_PAREN "("
          COLUMN
            NAME_REF
              IDENT "balance"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME_REF
              IDENT "tid"
          R_PAREN ")"
        WHITESPACE " "
        SELECT
          VALUES_KW "VALUES"
          WHITESPACE " "
          L_PAREN "("
          BIN_EXPR
            NAME_REF
              IDENT "balance"
            WHITESPACE " "
            PLUS "+"
            WHITESPACE " "
            NAME_REF
              IDENT "delta"
          COMMA ","
          WHITESPACE " "
          NAME_REF
            IDENT "sid"
          R_PAREN ")"
        WHITESPACE "\n    "
        WHEN_KW "WHEN"
        WHITESPACE " "
        MATCHED_KW "MATCHED"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "tid"
          WHITESPACE " "
          L_ANGLE "<"
          WHITESPACE " "
          LITERAL
            INT_NUMBER "2"
        WHITESPACE " "
        THEN_KW "THEN"
        WHITESPACE "\n        "
        DELETE_KW "DELETE"
        WHITESPACE "\n    "
        RETURNING_KW "RETURNING"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            MERGE_ACTION_KW "merge_action"
          ARG_LIST
            L_PAREN "("
            R_PAREN ")"
        WHITESPACE " "
        AS_KW "AS"
  WHITESPACE " "
  ERROR
    ACTION_KW "action"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    OLD_KW "old"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "old_data"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    NEW_KW "new"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "new_data"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    STAR "*"
  ERROR
    COMMA ","
  WHITESPACE "\n              "
  ERROR
    CASE_KW "CASE"
  WHITESPACE " "
  ERROR
    MERGE_ACTION_KW "merge_action"
  ERROR
    L_PAREN "("
  ERROR
    R_PAREN ")"
  WHITESPACE "\n                  "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'INSERT'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Inserted '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "t"
  WHITESPACE "\n                  "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'UPDATE'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Added '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "delta"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    STRING "' to balance'"
  WHITESPACE "\n                  "
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    STRING "'DELETE'"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE " "
  ERROR
    STRING "'Removed '"
  ERROR
    PIPE "|"
  ERROR
    PIPE "|"
  ERROR
    IDENT "t"
  WHITESPACE "\n              "
  COMMIT_STMT
    END_KW "END"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    IDENT "description"
  WHITESPACE "\n"
  ERROR
    R_PAREN ")"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    IDENT "m2"
  WHITESPACE " "
  ERROR
    AS_KW "AS"
  WHITESPACE " "
  ERROR
    L_PAREN "("
  WHITESPACE "\n    "
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target_merge_log"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "l"
    WHITESPACE "\n    "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "m"
      WHITESPACE "\n    "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "l"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "m"
          DOT "."
          NAME_REF
            IDENT "tid"
    WHITESPACE "\n    "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n        "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "last_change"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    NAME_REF
      IDENT "description"
    WHITESPACE "\n    "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n        "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "m"
        DOT "."
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "description"
      R_PAREN ")"
    WHITESPACE "\n    "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "m"
      DOT "."
      STAR "*"
    COMMA ","
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    IDENT "log_action"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      OLD_KW "old"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    IDENT "old_log"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      NEW_KW "new"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    IDENT "new_log"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "l"
      DOT "."
      STAR "*"
  WHITESPACE "\n"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "m2"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target_merge_log"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- COPY (MERGE ... RETURNING) TO ..."
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  COPY_STMT
    COPY_KW "COPY"
    WHITESPACE " "
    L_PAREN "("
  WHITESPACE "\n    "
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n    "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n    "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n    "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      GTEQ ">="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n        "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    WHITESPACE "\n    "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n        "
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      BIN_EXPR
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PLUS "+"
        WHITESPACE " "
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      R_PAREN ")"
    WHITESPACE "\n    "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      L_ANGLE "<"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n        "
    DELETE_KW "DELETE"
    WHITESPACE "\n    "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        OLD_KW "old"
      DOT "."
      STAR "*"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        NEW_KW "new"
      DOT "."
      STAR "*"
  WHITESPACE "\n"
  ERROR
    R_PAREN ")"
  WHITESPACE " "
  ERROR
    TO_KW "TO"
  WHITESPACE " "
  ERROR
    STDOUT_KW "stdout"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- SQL function with MERGE ... RETURNING"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_into_sq_target"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        NAME
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        NAME
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE "\n                                     "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          ACTION_KW "action"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          IDENT "new_balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\n    MERGE INTO sq_target t\n    USING (VALUES ($1, $2, $3)) AS v(sid, balance, delta)\n    ON tid = v.sid\n    WHEN MATCHED AND tid >= 2 THEN\n        UPDATE SET balance = t.balance + v.delta\n    WHEN NOT MATCHED THEN\n        INSERT (balance, tid) VALUES (v.balance + v.delta, v.sid)\n    WHEN MATCHED AND tid < 2 THEN\n        DELETE\n    RETURNING merge_action(), t.*;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "m"
            DOT "."
            STAR "*"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          VALUES_KW "VALUES"
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "1"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          R_PAREN ")"
          COMMA ","
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "3"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "20"
          R_PAREN ")"
          COMMA ","
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "4"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "10"
          R_PAREN ")"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "v"
        COLUMN_LIST
          L_PAREN "("
          COLUMN
            NAME
              IDENT "sid"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME
              IDENT "balance"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME
              IDENT "delta"
          R_PAREN ")"
      COMMA ","
      WHITESPACE "\n"
      LATERAL_KW "LATERAL"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  ACTION_KW "action"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "tid"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "new_balance"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            CALL_EXPR
              NAME_REF
                IDENT "merge_into_sq_target"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "sid"
                COMMA ","
                WHITESPACE " "
                NAME_REF
                  IDENT "balance"
                COMMA ","
                WHITESPACE " "
                NAME_REF
                  IDENT "delta"
                R_PAREN ")"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "m"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- SQL SRF with MERGE ... RETURNING"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_sq_source_into_sq_target"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      TABLE_KW "TABLE"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        ACTION_KW "action"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        SQL_KW "sql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\n    MERGE INTO sq_target t\n    USING sq_source s\n    ON tid = sid\n    WHEN MATCHED AND tid >= 2 THEN\n        UPDATE SET balance = t.balance + delta\n    WHEN NOT MATCHED THEN\n        INSERT (balance, tid) VALUES (balance + delta, sid)\n    WHEN MATCHED AND tid < 2 THEN\n        DELETE\n    RETURNING merge_action(), t.*;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "merge_sq_source_into_sq_target"
        ARG_LIST
          L_PAREN "("
          R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- PL/pgSQL function with MERGE ... RETURNING ... INTO"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_into_sq_target"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        NAME
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        NAME
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE "\n                                     "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          IDENT "r_action"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          IDENT "r_tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      PARAM
        PARAM_OUT
          OUT_KW "OUT"
        WHITESPACE " "
        NAME
          IDENT "r_balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nBEGIN\n    MERGE INTO sq_target t\n    USING (VALUES ($1, $2, $3)) AS v(sid, balance, delta)\n    ON tid = v.sid\n    WHEN MATCHED AND tid >= 2 THEN\n        UPDATE SET balance = t.balance + v.delta\n    WHEN NOT MATCHED THEN\n        INSERT (balance, tid) VALUES (v.balance + v.delta, v.sid)\n    WHEN MATCHED AND tid < 2 THEN\n        DELETE\n    RETURNING merge_action(), t.* INTO r_action, r_tid, r_balance;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          FIELD_EXPR
            NAME_REF
              IDENT "m"
            DOT "."
            STAR "*"
    WHITESPACE "\n"
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          VALUES_KW "VALUES"
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "1"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          R_PAREN ")"
          COMMA ","
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "3"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "20"
          R_PAREN ")"
          COMMA ","
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "4"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "10"
          R_PAREN ")"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "v"
        COLUMN_LIST
          L_PAREN "("
          COLUMN
            NAME
              IDENT "sid"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME
              IDENT "balance"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME
              IDENT "delta"
          R_PAREN ")"
      COMMA ","
      WHITESPACE "\n"
      LATERAL_KW "LATERAL"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                NAME_REF
                  IDENT "r_action"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "r_tid"
              COMMA ","
              WHITESPACE " "
              TARGET
                NAME_REF
                  IDENT "r_balance"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            CALL_EXPR
              NAME_REF
                IDENT "merge_into_sq_target"
              ARG_LIST
                L_PAREN "("
                NAME_REF
                  IDENT "sid"
                COMMA ","
                WHITESPACE " "
                NAME_REF
                  IDENT "balance"
                COMMA ","
                WHITESPACE " "
                NAME_REF
                  IDENT "delta"
                R_PAREN ")"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "m"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- EXPLAIN"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "ex_mtarget"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "ex_msource"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "ex_mtarget"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "i"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "i"
              STAR "*"
              LITERAL
                INT_NUMBER "10"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "100"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "i"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "ex_msource"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "i"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "i"
              STAR "*"
              LITERAL
                INT_NUMBER "10"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "100"
            COMMA ","
            LITERAL
              INT_NUMBER "1"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          NAME
            IDENT "i"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "explain_merge"
    PARAM_LIST
      L_PAREN "("
      PARAM
        NAME
          IDENT "query"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      SETOF_KW "SETOF"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TEXT_KW "text"
    WHITESPACE "\n"
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n"
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nDECLARE ln text;\nBEGIN\n    FOR ln IN\n        EXECUTE 'explain (analyze, timing off, summary off, costs off, buffers off) ' ||\n\t\t  query\n    LOOP\n        ln := regexp_replace(ln, '(Memory( Usage)?|Buckets|Batches): \\S*',  '\\1: xxx', 'g');\n        RETURN NEXT ln;\n    END LOOP;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- only updates"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET b = t.b + 1'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- only updates to selected tuples"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN MATCHED AND t.a < 10 THEN\n\tUPDATE SET b = t.b + 1'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- updates + deletes"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN MATCHED AND t.a < 10 THEN\n\tUPDATE SET b = t.b + 1\nWHEN MATCHED AND t.a >= 10 AND t.a <= 20 THEN\n\tDELETE'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- only inserts"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN NOT MATCHED AND s.a < 10 THEN\n\tINSERT VALUES (a, b)'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- all three"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN MATCHED AND t.a < 10 THEN\n\tUPDATE SET b = t.b + 1\nWHEN MATCHED AND t.a >= 30 AND t.a <= 40 THEN\n\tDELETE\nWHEN NOT MATCHED AND s.a < 20 THEN\n\tINSERT VALUES (a, b)'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- not matched by source"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN NOT MATCHED BY SOURCE and t.a < 10 THEN\n\tDELETE'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- not matched by source and target"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a\nWHEN NOT MATCHED BY SOURCE AND t.a < 10 THEN\n\tDELETE\nWHEN NOT MATCHED BY TARGET AND s.a < 20 THEN\n\tINSERT VALUES (a, b)'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- nothing"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "explain_merge"
            ARG_LIST
              L_PAREN "("
              LITERAL
                STRING "'\nMERGE INTO ex_mtarget t USING ex_msource s ON t.a = s.a AND t.a < -1000\nWHEN MATCHED AND t.a < 10 THEN\n\tDO NOTHING'"
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "ex_msource"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "ex_mtarget"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_FUNCTION_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "explain_merge"
    PARAM_LIST
      L_PAREN "("
      PARAM
        PATH_TYPE
          TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- EXPLAIN SubPlans and InitPlans"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "src"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "d"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "tgt"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "d"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          REF_KW "ref"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "ab"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "cd"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    VERBOSE_KW "verbose"
    COMMA ","
    WHITESPACE " "
    IDENT "costs"
    WHITESPACE " "
    ERROR
      OFF_KW "off"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "tgt"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
              COMMA ","
              WHITESPACE " "
              TARGET
                PAREN_EXPR
                  L_PAREN "("
                  SELECT
                    SELECT_CLAUSE
                      SELECT_KW "SELECT"
                      WHITESPACE " "
                      TARGET_LIST
                        TARGET
                          CALL_EXPR
                            NAME_REF
                              IDENT "count"
                            ARG_LIST
                              L_PAREN "("
                              STAR "*"
                              R_PAREN ")"
                    WHITESPACE " "
                    FROM_CLAUSE
                      FROM_KW "FROM"
                      WHITESPACE " "
                      NAME_REF
                        REF_KW "ref"
                      WHITESPACE " "
                      ALIAS
                        NAME
                          IDENT "r"
                    WHITESPACE "\n                   "
                    WHERE_CLAUSE
                      WHERE_KW "WHERE"
                      WHITESPACE " "
                      BIN_EXPR
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "r"
                            DOT "."
                            NAME_REF
                              IDENT "ab"
                          WHITESPACE " "
                          EQ "="
                          WHITESPACE " "
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "s"
                              DOT "."
                              NAME_REF
                                IDENT "a"
                            WHITESPACE " "
                            PLUS "+"
                            WHITESPACE " "
                            FIELD_EXPR
                              NAME_REF
                                IDENT "s"
                              DOT "."
                              NAME_REF
                                IDENT "b"
                        WHITESPACE "\n                     "
                        AND_KW "AND"
                        WHITESPACE " "
                        BIN_EXPR
                          FIELD_EXPR
                            NAME_REF
                              IDENT "r"
                            DOT "."
                            NAME_REF
                              IDENT "cd"
                          WHITESPACE " "
                          EQ "="
                          WHITESPACE " "
                          BIN_EXPR
                            FIELD_EXPR
                              NAME_REF
                                IDENT "s"
                              DOT "."
                              NAME_REF
                                IDENT "c"
                            WHITESPACE " "
                            MINUS "-"
                            WHITESPACE " "
                            FIELD_EXPR
                              NAME_REF
                                IDENT "s"
                              DOT "."
                              NAME_REF
                                IDENT "d"
                  R_PAREN ")"
                WHITESPACE " "
                NAME
                  IDENT "cnt"
          WHITESPACE "\n         "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "src"
            WHITESPACE " "
            ALIAS
              NAME
                IDENT "s"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "a"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "a"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "b"
          WHITESPACE " "
          L_ANGLE "<"
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "cnt"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "t"
        DOT "."
        NAME_REF
          IDENT "c"
      WHITESPACE " "
      R_ANGLE ">"
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "cnt"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n  "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "b"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "c"
    R_PAREN ")"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    L_PAREN "("
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            FIELD_EXPR
              NAME_REF
                IDENT "s"
              DOT "."
              NAME_REF
                IDENT "b"
          COMMA ","
          WHITESPACE " "
          TARGET
            FIELD_EXPR
              NAME_REF
                IDENT "s"
              DOT "."
              NAME_REF
                IDENT "cnt"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "src"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "tgt"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          REF_KW "ref"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Subqueries"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    PAREN_EXPR
      L_PAREN "("
      SELECT
        SELECT_CLAUSE
          SELECT_KW "SELECT"
          WHITESPACE " "
          TARGET_LIST
            TARGET
              CALL_EXPR
                NAME_REF
                  IDENT "count"
                ARG_LIST
                  L_PAREN "("
                  STAR "*"
                  R_PAREN ")"
        WHITESPACE " "
        FROM_CLAUSE
          FROM_KW "FROM"
          WHITESPACE " "
          NAME_REF
            IDENT "sq_target"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "sid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    PAREN_EXPR
      L_PAREN "("
      SELECT
        SELECT_CLAUSE
          SELECT_KW "SELECT"
          WHITESPACE " "
          TARGET_LIST
            TARGET
              BIN_EXPR
                CALL_EXPR
                  NAME_REF
                    IDENT "count"
                  ARG_LIST
                    L_PAREN "("
                    STAR "*"
                    R_PAREN ")"
                WHITESPACE " "
                R_ANGLE ">"
                WHITESPACE " "
                LITERAL
                  INT_NUMBER "0"
        WHITESPACE " "
        FROM_CLAUSE
          FROM_KW "FROM"
          WHITESPACE " "
          NAME_REF
            IDENT "sq_target"
      R_PAREN ")"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "42"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "v"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          NAME_REF
            IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          NAME_REF
            IDENT "sid"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        PAREN_EXPR
          L_PAREN "("
          SELECT
            SELECT_CLAUSE
              SELECT_KW "SELECT"
              WHITESPACE " "
              TARGET_LIST
                TARGET
                  BIN_EXPR
                    CALL_EXPR
                      NAME_REF
                        IDENT "count"
                      ARG_LIST
                        L_PAREN "("
                        STAR "*"
                        R_PAREN ")"
                    WHITESPACE " "
                    R_ANGLE ">"
                    WHITESPACE " "
                    LITERAL
                      INT_NUMBER "0"
            WHITESPACE " "
            FROM_CLAUSE
              FROM_KW "FROM"
              WHITESPACE " "
              NAME_REF
                IDENT "sq_target"
          R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    LITERAL
      INT_NUMBER "42"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "sq_target"
    WHITESPACE " "
    WHERE_CLAUSE
      WHERE_KW "WHERE"
      WHITESPACE " "
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        LITERAL
          INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_target_merge_log"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "sq_source"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n\t"
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    IDENT "LIST"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "tid"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part1"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "1"
    COMMA ","
    LITERAL
      INT_NUMBER "4"
    R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part2"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "2"
    COMMA ","
    LITERAL
      INT_NUMBER "5"
    COMMA ","
    LITERAL
      INT_NUMBER "6"
    R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part3"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "3"
    COMMA ","
    LITERAL
      INT_NUMBER "8"
    COMMA ","
    LITERAL
      INT_NUMBER "9"
    R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part4"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- insert many rows to the source table"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "10"
      WHITESPACE "  "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "14"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- insert a few rows in the target table (odd numbered tid)"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'initial'"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "15"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try simple MERGE"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "sid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'inserted by merge'"
      R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' not matched by source'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- same with a constant qual"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            INT_NUMBER "1"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "sid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'inserted by merge'"
      R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' not matched by source'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try updating the partition key column"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "merge_func"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              INTEGER_KW "integer"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO pa_target t\n  USING pa_source s\n  ON t.tid = s.sid\n  WHEN MATCHED THEN\n    UPDATE SET tid = tid + 1, balance = balance + delta, val = val || ' updated by merge'\n  WHEN NOT MATCHED THEN\n    INSERT VALUES (sid, delta, 'inserted by merge')\n  WHEN NOT MATCHED BY SOURCE THEN\n    UPDATE SET tid = 1, val = val || ' not matched by source';\nIF FOUND THEN\n  GET DIAGNOSTICS result := ROW_COUNT;\nEND IF;\nRETURN result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "merge_func"
            ARG_LIST
              L_PAREN "("
              R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- update partition key to partition not initially scanned"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          LITERAL
            INT_NUMBER "1"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "tid"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
    WHITESPACE "\n  "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      OLD_KW "old"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      NEW_KW "new"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "t"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- bug #18871: ExecInitPartitionInfo()'s handling of DO NOTHING actions"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  TRUNCATE_STMT
    TRUNCATE_KW "TRUNCATE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "pa_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          VALUES_KW "VALUES"
          WHITESPACE " "
          L_PAREN "("
          LITERAL
            INT_NUMBER "10"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "100"
          R_PAREN ")"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "s"
        COLUMN_LIST
          L_PAREN "("
          COLUMN
            NAME
              IDENT "sid"
          COMMA ","
          WHITESPACE " "
          COLUMN
            NAME
              IDENT "delta"
          R_PAREN ")"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'inserted by merge'"
      R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    DO_KW "DO"
    WHITESPACE " "
    NOTHING_KW "NOTHING"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- The target table is partitioned in the same way, but this time by attaching"
    WHITESPACE "\n"
    COMMENT "-- partitions which have columns in different order, dropped columns etc."
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n\t"
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    IDENT "LIST"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "tid"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part1"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part3"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part4"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "extraid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "part4"
    WHITESPACE " "
    DROP_COLUMN
      DROP_KW "DROP"
      WHITESPACE " "
      COLUMN_KW "COLUMN"
      WHITESPACE " "
      NAME_REF
        IDENT "extraid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ATTACH_PARTITION
      ATTACH_KW "ATTACH"
      WHITESPACE " "
      PARTITION_KW "PARTITION"
      WHITESPACE " "
      NAME_REF
        IDENT "part1"
      WHITESPACE " "
      FOR_KW "FOR"
      WHITESPACE " "
      VALUES_KW "VALUES"
      WHITESPACE " "
      IN_KW "IN"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      LITERAL
        INT_NUMBER "4"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ATTACH_PARTITION
      ATTACH_KW "ATTACH"
      WHITESPACE " "
      PARTITION_KW "PARTITION"
      WHITESPACE " "
      NAME_REF
        IDENT "part2"
      WHITESPACE " "
      FOR_KW "FOR"
      WHITESPACE " "
      VALUES_KW "VALUES"
      WHITESPACE " "
      IN_KW "IN"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      LITERAL
        INT_NUMBER "5"
      COMMA ","
      LITERAL
        INT_NUMBER "6"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ATTACH_PARTITION
      ATTACH_KW "ATTACH"
      WHITESPACE " "
      PARTITION_KW "PARTITION"
      WHITESPACE " "
      NAME_REF
        IDENT "part3"
      WHITESPACE " "
      FOR_KW "FOR"
      WHITESPACE " "
      VALUES_KW "VALUES"
      WHITESPACE " "
      IN_KW "IN"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      LITERAL
        INT_NUMBER "8"
      COMMA ","
      LITERAL
        INT_NUMBER "9"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ATTACH_PARTITION
      ATTACH_KW "ATTACH"
      WHITESPACE " "
      PARTITION_KW "PARTITION"
      WHITESPACE " "
      NAME_REF
        IDENT "part4"
      WHITESPACE " "
      DEFAULT_KW "DEFAULT"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- insert a few rows in the target table (odd numbered tid)"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'initial'"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "15"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try simple MERGE"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO pa_target t\n  USING pa_source s\n  ON t.tid = s.sid\n  WHEN MATCHED THEN\n    UPDATE SET balance = balance + delta, val = val || ' updated by merge'\n  WHEN NOT MATCHED THEN\n    INSERT VALUES (sid, delta, 'inserted by merge')\n  WHEN NOT MATCHED BY SOURCE THEN\n    UPDATE SET val = val || ' not matched by source';\nGET DIAGNOSTICS result := ROW_COUNT;\nRAISE NOTICE 'ROW_COUNT = %', result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- same with a constant qual"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          NAME_REF
            IDENT "tid"
          WHITESPACE " "
          IN_KW "IN"
          WHITESPACE " "
          TUPLE_EXPR
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            WHITESPACE " "
            LITERAL
              INT_NUMBER "5"
            R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      BIN_EXPR
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PERCENT "%"
        WHITESPACE " "
        LITERAL
          INT_NUMBER "5"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "0"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "sid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'inserted by merge'"
      R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' not matched by source'"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try updating the partition key column"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO pa_target t\n  USING pa_source s\n  ON t.tid = s.sid\n  WHEN MATCHED THEN\n    UPDATE SET tid = tid + 1, balance = balance + delta, val = val || ' updated by merge'\n  WHEN NOT MATCHED THEN\n    INSERT VALUES (sid, delta, 'inserted by merge')\n  WHEN NOT MATCHED BY SOURCE THEN\n    UPDATE SET tid = 1, val = val || ' not matched by source';\nGET DIAGNOSTICS result := ROW_COUNT;\nRAISE NOTICE 'ROW_COUNT = %', result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- as above, but blocked by BEFORE DELETE ROW trigger"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "trig_fn"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TRIGGER_KW "trigger"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n  "
        LITERAL
          DOLLAR_QUOTED_STRING "$$ BEGIN RETURN NULL; END; $$"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "del_trig"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE "\n  "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "trig_fn"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO pa_target t\n  USING pa_source s\n  ON t.tid = s.sid\n  WHEN MATCHED THEN\n    UPDATE SET tid = tid + 1, balance = balance + delta, val = val || ' updated by merge'\n  WHEN NOT MATCHED THEN\n    INSERT VALUES (sid, delta, 'inserted by merge')\n  WHEN NOT MATCHED BY SOURCE THEN\n    UPDATE SET val = val || ' not matched by source';\nGET DIAGNOSTICS result := ROW_COUNT;\nRAISE NOTICE 'ROW_COUNT = %', result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- as above, but blocked by BEFORE INSERT ROW trigger"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "trig_fn"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE " "
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TRIGGER_KW "trigger"
    WHITESPACE " "
    FUNC_OPTION_LIST
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
      WHITESPACE " "
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE "\n  "
        LITERAL
          DOLLAR_QUOTED_STRING "$$ BEGIN RETURN NULL; END; $$"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "ins_trig"
    WHITESPACE " "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE "\n  "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "trig_fn"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DO_STMT
    DO_KW "DO"
    WHITESPACE " "
    LITERAL
      DOLLAR_QUOTED_STRING "$$\nDECLARE\n  result integer;\nBEGIN\nMERGE INTO pa_target t\n  USING pa_source s\n  ON t.tid = s.sid\n  WHEN MATCHED THEN\n    UPDATE SET tid = tid + 1, balance = balance + delta, val = val || ' updated by merge'\n  WHEN NOT MATCHED THEN\n    INSERT VALUES (sid, delta, 'inserted by merge')\n  WHEN NOT MATCHED BY SOURCE THEN\n    UPDATE SET val = val || ' not matched by source';\nGET DIAGNOSTICS result := ROW_COUNT;\nRAISE NOTICE 'ROW_COUNT = %', result;\nEND;\n$$"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "val"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- test RLS enforcement"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ENABLE_RLS
      ENABLE_KW "ENABLE"
      WHITESPACE " "
      ROW_KW "ROW"
      WHITESPACE " "
      LEVEL_KW "LEVEL"
      WHITESPACE " "
      SECURITY_KW "SECURITY"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    FORCE_RLS
      FORCE_KW "FORCE"
      WHITESPACE " "
      ROW_KW "ROW"
      WHITESPACE " "
      LEVEL_KW "LEVEL"
      WHITESPACE " "
      SECURITY_KW "SECURITY"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_POLICY_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    POLICY_KW "POLICY"
    WHITESPACE " "
    NAME
      IDENT "pa_target_pol"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    USING_KW "USING"
    WHITESPACE " "
    L_PAREN "("
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      NEQ "!="
      WHITESPACE " "
      LITERAL
        INT_NUMBER "0"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          EQ "="
          WHITESPACE " "
          FIELD_EXPR
            NAME_REF
              IDENT "s"
            DOT "."
            NAME_REF
              IDENT "sid"
        WHITESPACE " "
        AND_KW "AND"
        WHITESPACE " "
        BIN_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "t"
            DOT "."
            NAME_REF
              IDENT "tid"
          WHITESPACE " "
          IN_KW "IN"
          WHITESPACE " "
          TUPLE_EXPR
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "2"
            COMMA ","
            LITERAL
              INT_NUMBER "3"
            COMMA ","
            LITERAL
              INT_NUMBER "4"
            R_PAREN ")"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "tid"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "tid"
      WHITESPACE " "
      MINUS "-"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- Sub-partitioning"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "logts"
        WHITESPACE " "
        TIME_TYPE
          NAME_REF
            TIMESTAMP_KW "timestamp"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n\t"
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    RANGE_KW "RANGE"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "logts"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m01"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      STRING "'2017-01-01'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      STRING "'2017-02-01'"
    R_PAREN ")"
    WHITESPACE "\n\t"
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    IDENT "LIST"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "tid"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m01_odd"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "part_m01"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "1"
    COMMA ","
    LITERAL
      INT_NUMBER "3"
    COMMA ","
    LITERAL
      INT_NUMBER "5"
    COMMA ","
    LITERAL
      INT_NUMBER "7"
    COMMA ","
    LITERAL
      INT_NUMBER "9"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m01_even"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "part_m01"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "2"
    COMMA ","
    LITERAL
      INT_NUMBER "4"
    COMMA ","
    LITERAL
      INT_NUMBER "6"
    COMMA ","
    LITERAL
      INT_NUMBER "8"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m02"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    FROM_KW "FROM"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      STRING "'2017-02-01'"
    R_PAREN ")"
    WHITESPACE " "
    TO_KW "TO"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      STRING "'2017-03-01'"
    R_PAREN ")"
    WHITESPACE "\n\t"
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    IDENT "LIST"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "tid"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m02_odd"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "part_m02"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "1"
    COMMA ","
    LITERAL
      INT_NUMBER "3"
    COMMA ","
    LITERAL
      INT_NUMBER "5"
    COMMA ","
    LITERAL
      INT_NUMBER "7"
    COMMA ","
    LITERAL
      INT_NUMBER "9"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "part_m02_even"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "part_m02"
    WHITESPACE "\n\t"
    FOR_KW "FOR"
    WHITESPACE " "
    VALUES_KW "VALUES"
    WHITESPACE " "
    IN_KW "IN"
    WHITESPACE " "
    L_PAREN "("
    LITERAL
      INT_NUMBER "2"
    COMMA ","
    LITERAL
      INT_NUMBER "4"
    COMMA ","
    LITERAL
      INT_NUMBER "6"
    COMMA ","
    LITERAL
      INT_NUMBER "8"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- insert many rows to the source table"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "10"
      WHITESPACE "  "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "14"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n"
  COMMENT "-- insert a few rows in the target table (odd numbered tid)"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              STRING "'2017-01-31'"
          COMMA ","
          WHITESPACE " "
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'initial'"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "1"
            COMMA ","
            LITERAL
              INT_NUMBER "9"
            COMMA ","
            LITERAL
              INT_NUMBER "3"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            LITERAL
              STRING "'2017-02-28'"
          COMMA ","
          WHITESPACE " "
          TARGET
            NAME_REF
              IDENT "id"
          COMMA ","
          WHITESPACE " "
          TARGET
            BIN_EXPR
              NAME_REF
                IDENT "id"
              WHITESPACE " "
              STAR "*"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "100"
          COMMA ","
          WHITESPACE " "
          TARGET
            LITERAL
              STRING "'initial'"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            IDENT "generate_series"
          ARG_LIST
            L_PAREN "("
            LITERAL
              INT_NUMBER "2"
            COMMA ","
            LITERAL
              INT_NUMBER "9"
            COMMA ","
            LITERAL
              INT_NUMBER "3"
            R_PAREN ")"
        WHITESPACE " "
        ALIAS
          AS_KW "AS"
          WHITESPACE " "
          NAME
            IDENT "id"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try simple MERGE"
  WHITESPACE "\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n  "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                LITERAL
                  STRING "'2017-01-15'"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "slogts"
              COMMA ","
              WHITESPACE " "
              TARGET
                STAR "*"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "pa_source"
          WHITESPACE " "
          WHERE_CLAUSE
            WHERE_KW "WHERE"
            WHITESPACE " "
            BIN_EXPR
              NAME_REF
                IDENT "sid"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              LITERAL
                INT_NUMBER "10"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE "\n  "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "balance"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "balance"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n    "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      CAST_EXPR
        NAME_REF
          IDENT "slogts"
        COLON2 "::"
        TIME_TYPE
          NAME_REF
            TIMESTAMP_KW "timestamp"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "delta"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'inserted by merge'"
      R_PAREN ")"
    WHITESPACE "\n  "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      OLD_KW "old"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      NEW_KW "new"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "t"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_target"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "tid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Partitioned table with primary key"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
        WHITESPACE " "
        PRIMARY_KEY_CONSTRAINT
          PRIMARY_KW "PRIMARY"
          WHITESPACE " "
          KEY_KW "KEY"
      R_PAREN ")"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    IDENT "LIST"
    WHITESPACE " "
    L_PAREN "("
    NAME_REF
      IDENT "tid"
    R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_targetp"
    WHITESPACE " "
    PARTITION_KW "PARTITION"
    WHITESPACE " "
    OF_KW "OF"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    DEFAULT_KW "DEFAULT"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "pa_source"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    VERBOSE_KW "VERBOSE"
    COMMA ","
    WHITESPACE " "
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- Partition-less partitioned table"
  WHITESPACE "\n"
  COMMENT "-- (the bug we are checking for appeared only if table had partitions before)"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_targetp"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  EXPLAIN_STMT
    EXPLAIN_KW "EXPLAIN"
    WHITESPACE " "
    L_PAREN "("
    VERBOSE_KW "VERBOSE"
    COMMA ","
    WHITESPACE " "
    IDENT "COSTS"
    WHITESPACE " "
    ERROR
      OFF_KW "OFF"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pa_source"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "tid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "sid"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "s"
        DOT "."
        NAME_REF
          IDENT "sid"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_source"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pa_target"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- some complex joins on the source side"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "cj_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                FLOAT_KW "float"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "cj_source1"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid1"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "scat"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "cj_source2"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid2"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INTEGER_KW "integer"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sval"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "100"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "200"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "300"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "400"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source2"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'initial source2'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source2"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'initial source2'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source2"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "3"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'initial source2'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- source relation is an unaliased join"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_source1"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s1"
      WHITESPACE "\n\t"
      NAME_REF
        INNER_KW "INNER"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source2"
  WHITESPACE " "
  ERROR
    IDENT "s2"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid2"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    NOT_KW "NOT"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          VALUES_KW "VALUES"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid1"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sval"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try accessing columns from either side of the source join"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_source2"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s2"
      WHITESPACE "\n\t"
      NAME_REF
        INNER_KW "INNER"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source1"
  WHITESPACE " "
  ERROR
    IDENT "s1"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid2"
  WHITESPACE " "
  ERROR
    AND_KW "AND"
  WHITESPACE " "
  ERROR
    IDENT "scat"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    INT_NUMBER "20"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    NOT_KW "NOT"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          VALUES_KW "VALUES"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid2"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sval"
      R_PAREN ")"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  DELETE_STMT
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- some simple expressions in INSERT targetlist"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_source2"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s2"
      WHITESPACE "\n\t"
      NAME_REF
        INNER_KW "INNER"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source1"
  WHITESPACE " "
  ERROR
    IDENT "s1"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid2"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    NOT_KW "NOT"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          VALUES_KW "VALUES"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "sid2"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
  WHITESPACE " "
  ERROR
    PLUS "+"
  WHITESPACE " "
  ERROR
    IDENT "scat"
  ERROR
    COMMA ","
  WHITESPACE " "
  ERROR
    IDENT "sval"
  ERROR
    R_PAREN ")"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SET_KW "SET"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      LITERAL
        STRING "' updated by merge'"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_source2"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s2"
      WHITESPACE "\n\t"
      NAME_REF
        INNER_KW "INNER"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source1"
  WHITESPACE " "
  ERROR
    IDENT "s1"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid2"
  WHITESPACE " "
  ERROR
    AND_KW "AND"
  WHITESPACE " "
  ERROR
    IDENT "scat"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    INT_NUMBER "20"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "sid1"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  UPDATE_STMT
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SET_KW "SET"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "val"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "val"
      WHITESPACE " "
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      BIN_EXPR
        LITERAL
          STRING "' '"
        WHITESPACE " "
        CUSTOM_OP
          PIPE "|"
          PIPE "|"
        WHITESPACE " "
        CAST_EXPR
          NAME_REF
            IDENT "delta"
          COLON2 "::"
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  TEXT_KW "text"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try it with an outer join and PlaceHolderVar"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                STAR "*"
              COMMA ","
              WHITESPACE " "
              TARGET
                CAST_EXPR
                  LITERAL
                    STRING "'join input'"
                  COLON2 "::"
                  PATH_TYPE
                    PATH
                      PATH_SEGMENT
                        NAME_REF
                          TEXT_KW "text"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "phv"
          WHITESPACE " "
          FROM_CLAUSE
            FROM_KW "FROM"
            WHITESPACE " "
            NAME_REF
              IDENT "cj_source1"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "fj"
      WHITESPACE "\n\t"
      NAME_REF
        FULL_KW "FULL"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source2"
  WHITESPACE " "
  ERROR
    IDENT "fj2"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "fj"
  ERROR
    DOT "."
  ERROR
    IDENT "scat"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "fj2"
  ERROR
    DOT "."
  ERROR
    IDENT "sid2"
  WHITESPACE " "
  ERROR
    STAR "*"
  WHITESPACE " "
  ERROR
    INT_NUMBER "10"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "fj"
  ERROR
    DOT "."
  ERROR
    IDENT "scat"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    NOT_KW "NOT"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "tid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "balance"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "val"
      R_PAREN ")"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      FIELD_EXPR
        NAME_REF
          IDENT "fj"
        DOT "."
        NAME_REF
          IDENT "scat"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "fj"
        DOT "."
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      FIELD_EXPR
        NAME_REF
          IDENT "fj"
        DOT "."
        NAME_REF
          IDENT "phv"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    WHITESPACE " "
    RENAME_COLUMN
      RENAME_KW "RENAME"
      WHITESPACE " "
      COLUMN_KW "COLUMN"
      WHITESPACE " "
      NAME_REF
        IDENT "sid1"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source2"
    WHITESPACE " "
    RENAME_COLUMN
      RENAME_KW "RENAME"
      WHITESPACE " "
      COLUMN_KW "COLUMN"
      WHITESPACE " "
      NAME_REF
        IDENT "sid2"
      WHITESPACE " "
      TO_KW "TO"
      WHITESPACE " "
      NAME_REF
        IDENT "sid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  TRUNCATE_STMT
    TRUNCATE_KW "TRUNCATE"
    WHITESPACE " "
    TABLE_LIST
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "cj_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "cj_source1"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s1"
      WHITESPACE "\n\t"
      NAME_REF
        INNER_KW "INNER"
  WHITESPACE " "
  ERROR
    JOIN_KW "JOIN"
  WHITESPACE " "
  ERROR
    IDENT "cj_source2"
  WHITESPACE " "
  ERROR
    IDENT "s2"
  WHITESPACE " "
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "s1"
  ERROR
    DOT "."
  ERROR
    IDENT "sid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "s2"
  ERROR
    DOT "."
  ERROR
    IDENT "sid"
  WHITESPACE "\n"
  ERROR
    ON_KW "ON"
  WHITESPACE " "
  ERROR
    IDENT "t"
  ERROR
    DOT "."
  ERROR
    IDENT "tid"
  WHITESPACE " "
  ERROR
    EQ "="
  WHITESPACE " "
  ERROR
    IDENT "s1"
  ERROR
    DOT "."
  ERROR
    IDENT "sid"
  WHITESPACE "\n"
  ERROR
    WHEN_KW "WHEN"
  WHITESPACE " "
  ERROR
    NOT_KW "NOT"
  WHITESPACE " "
  ERROR
    MATCHED_KW "MATCHED"
  WHITESPACE " "
  ERROR
    THEN_KW "THEN"
  WHITESPACE "\n\t"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          VALUES_KW "VALUES"
    WHITESPACE " "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        FIELD_EXPR
          NAME_REF
            IDENT "s2"
          DOT "."
          NAME_REF
            IDENT "sid"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "delta"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "sval"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source2"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_source1"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "cj_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- Function scans"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "fs_target"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
    WHITESPACE "\n  "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "fs_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "generate_series"
        ARG_LIST
          L_PAREN "("
          LITERAL
            INT_NUMBER "1"
          COMMA ","
          LITERAL
            INT_NUMBER "100"
          COMMA ","
          LITERAL
            INT_NUMBER "1"
          R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "id"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "a"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "id"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "b"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "b"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "id"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "id"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "fs_target"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          IDENT "generate_series"
        ARG_LIST
          L_PAREN "("
          LITERAL
            INT_NUMBER "1"
          COMMA ","
          LITERAL
            INT_NUMBER "100"
          COMMA ","
          LITERAL
            INT_NUMBER "2"
          R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "id"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "a"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        NAME_REF
          IDENT "id"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "b"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "b"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      NAME_REF
        IDENT "id"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "c"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      LITERAL
        STRING "'updated '"
      CUSTOM_OP
        PIPE "|"
        PIPE "|"
      WHITESPACE " "
      CAST_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "id"
          DOT "."
          STAR "*"
        COLON2 "::"
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    INSERT_KW "INSERT"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "id"
      COMMA ","
      WHITESPACE " "
      PREFIX_EXPR
        MINUS "-"
        LITERAL
          INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      BIN_EXPR
        LITERAL
          STRING "'inserted '"
        WHITESPACE " "
        CUSTOM_OP
          PIPE "|"
          PIPE "|"
        WHITESPACE " "
        CAST_EXPR
          FIELD_EXPR
            NAME_REF
              IDENT "id"
            DOT "."
            STAR "*"
          COLON2 "::"
          PATH_TYPE
            PATH
              PATH_SEGMENT
                NAME_REF
                  TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CALL_EXPR
            NAME_REF
              IDENT "count"
            ARG_LIST
              L_PAREN "("
              STAR "*"
              R_PAREN ")"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "fs_target"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "fs_target"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- SERIALIZABLE test"
  WHITESPACE "\n"
  COMMENT "-- handled in isolation tests"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "-- Inheritance-based partitioning"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "measurement"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "city_id"
        WHITESPACE "         "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "not"
          WHITESPACE " "
          NULL_KW "null"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "logdate"
        WHITESPACE "         "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "date"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "not"
          WHITESPACE " "
          NULL_KW "null"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "peaktemp"
        WHITESPACE "        "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "unitsales"
        WHITESPACE "       "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      WHITESPACE "\n"
      R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "measurement_y2006m02"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      WHITESPACE "\n    "
      CHECK_CONSTRAINT
        CHECK_KW "CHECK"
        WHITESPACE " "
        L_PAREN "("
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            NAME_REF
              IDENT "logdate"
            WHITESPACE " "
            GTEQ ">="
            WHITESPACE " "
            CAST_EXPR
              NAME_REF
                IDENT "DATE"
              WHITESPACE " "
              LITERAL
                STRING "'2006-02-01'"
          WHITESPACE " "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "logdate"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            CAST_EXPR
              NAME_REF
                IDENT "DATE"
              WHITESPACE " "
              LITERAL
                STRING "'2006-03-01'"
        WHITESPACE " "
        R_PAREN ")"
      WHITESPACE "\n"
      R_PAREN ")"
    WHITESPACE " "
    INHERITS_KW "INHERITS"
    WHITESPACE " "
    L_PAREN "("
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "measurement_y2006m03"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      WHITESPACE "\n    "
      CHECK_CONSTRAINT
        CHECK_KW "CHECK"
        WHITESPACE " "
        L_PAREN "("
        WHITESPACE " "
        BIN_EXPR
          BIN_EXPR
            NAME_REF
              IDENT "logdate"
            WHITESPACE " "
            GTEQ ">="
            WHITESPACE " "
            CAST_EXPR
              NAME_REF
                IDENT "DATE"
              WHITESPACE " "
              LITERAL
                STRING "'2006-03-01'"
          WHITESPACE " "
          AND_KW "AND"
          WHITESPACE " "
          BIN_EXPR
            NAME_REF
              IDENT "logdate"
            WHITESPACE " "
            L_ANGLE "<"
            WHITESPACE " "
            CAST_EXPR
              NAME_REF
                IDENT "DATE"
              WHITESPACE " "
              LITERAL
                STRING "'2006-04-01'"
        WHITESPACE " "
        R_PAREN ")"
      WHITESPACE "\n"
      R_PAREN ")"
    WHITESPACE " "
    INHERITS_KW "INHERITS"
    WHITESPACE " "
    L_PAREN "("
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "measurement_y2007m01"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "filler"
        WHITESPACE "          "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "peaktemp"
        WHITESPACE "        "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "logdate"
        WHITESPACE "         "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "date"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "not"
          WHITESPACE " "
          NULL_KW "null"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "city_id"
        WHITESPACE "         "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
        WHITESPACE " "
        NOT_NULL_CONSTRAINT
          NOT_KW "not"
          WHITESPACE " "
          NULL_KW "null"
      COMMA ","
      WHITESPACE "\n    "
      COLUMN
        NAME_REF
          IDENT "unitsales"
        WHITESPACE "       "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
        WHITESPACE "\n    "
        CHECK_CONSTRAINT
          CHECK_KW "CHECK"
          WHITESPACE " "
          L_PAREN "("
          WHITESPACE " "
          BIN_EXPR
            BIN_EXPR
              NAME_REF
                IDENT "logdate"
              WHITESPACE " "
              GTEQ ">="
              WHITESPACE " "
              CAST_EXPR
                NAME_REF
                  IDENT "DATE"
                WHITESPACE " "
                LITERAL
                  STRING "'2007-01-01'"
            WHITESPACE " "
            AND_KW "AND"
            WHITESPACE " "
            BIN_EXPR
              NAME_REF
                IDENT "logdate"
              WHITESPACE " "
              L_ANGLE "<"
              WHITESPACE " "
              CAST_EXPR
                NAME_REF
                  IDENT "DATE"
                WHITESPACE " "
                LITERAL
                  STRING "'2007-02-01'"
          R_PAREN ")"
      WHITESPACE "\n"
      R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement_y2007m01"
    WHITESPACE " "
    DROP_COLUMN
      DROP_KW "DROP"
      WHITESPACE " "
      COLUMN_KW "COLUMN"
      WHITESPACE " "
      NAME_REF
        IDENT "filler"
  SEMICOLON ";"
  WHITESPACE "\n"
  ALTER_TABLE
    ALTER_KW "ALTER"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement_y2007m01"
    WHITESPACE " "
    INHERIT
      INHERIT_KW "INHERIT"
      WHITESPACE " "
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "measurement"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "0"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2005-07-21'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "5"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "15"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_FUNCTION_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    OR_REPLACE
      OR_KW "OR"
      WHITESPACE " "
      REPLACE_KW "REPLACE"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "measurement_insert_trigger"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
    WHITESPACE "\n"
    RET_TYPE
      RETURNS_KW "RETURNS"
      WHITESPACE " "
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    FUNC_OPTION_LIST
      AS_FUNC_OPTION
        AS_KW "AS"
        WHITESPACE " "
        LITERAL
          DOLLAR_QUOTED_STRING "$$\nBEGIN\n    IF ( NEW.logdate >= DATE '2006-02-01' AND\n         NEW.logdate < DATE '2006-03-01' ) THEN\n        INSERT INTO measurement_y2006m02 VALUES (NEW.*);\n    ELSIF ( NEW.logdate >= DATE '2006-03-01' AND\n            NEW.logdate < DATE '2006-04-01' ) THEN\n        INSERT INTO measurement_y2006m03 VALUES (NEW.*);\n    ELSIF ( NEW.logdate >= DATE '2007-01-01' AND\n            NEW.logdate < DATE '2007-02-01' ) THEN\n        INSERT INTO measurement_y2007m01 (city_id, logdate, peaktemp, unitsales)\n            VALUES (NEW.*);\n    ELSE\n        RAISE EXCEPTION 'Date out of range.  Fix the measurement_insert_trigger() function!';\n    END IF;\n    RETURN NULL;\nEND;\n$$"
      WHITESPACE " "
      LANGUAGE_FUNC_OPTION
        LANGUAGE_KW "LANGUAGE"
        WHITESPACE " "
        IDENT "plpgsql"
  WHITESPACE " "
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_TRIGGER_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    TRIGGER_KW "TRIGGER"
    WHITESPACE " "
    NAME
      IDENT "insert_measurement_trigger"
    WHITESPACE "\n    "
    BEFORE_KW "BEFORE"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE " "
    ON_KW "ON"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE "\n    "
    FOR_KW "FOR"
    WHITESPACE " "
    EACH_KW "EACH"
    WHITESPACE " "
    ROW_KW "ROW"
    WHITESPACE " "
    EXECUTE_KW "EXECUTE"
    WHITESPACE " "
    PROCEDURE_KW "PROCEDURE"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        IDENT "measurement_insert_trigger"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-02-10'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "35"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-02-16'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "45"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-03-17'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "25"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-03-27'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "15"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "40"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2007-01-15'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2007-01-17'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
        COMMA ","
        WHITESPACE " "
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "measurement"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "new_measurement"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      LIKE_CLAUSE
        LIKE_KW "LIKE"
        WHITESPACE " "
        PATH
          PATH_SEGMENT
            NAME_REF
              IDENT "measurement"
      R_PAREN ")"
    WHITESPACE " "
    CONSTRAINT_STORAGE_PARAMS
      WITH_KW "WITH"
      WHITESPACE " "
      L_PAREN "("
      PATH
        PATH_SEGMENT
          NAME_REF
            IDENT "autovacuum_enabled"
      EQ "="
      PATH_TYPE
        PATH
          PATH_SEGMENT
            NAME_REF
              OFF_KW "off"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "0"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2005-07-21'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "25"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-03-01'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-02-16'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "50"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-02-10'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2006-03-27'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2007-01-17'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2007-01-15'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "5"
      COMMA ","
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'2007-01-16'"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    ONLY_KW "ONLY"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "m"
    WHITESPACE "\n "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "new_measurement"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "nm"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE "\n      "
      PAREN_EXPR
        L_PAREN "("
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "city_id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "city_id"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "logdate"
            EQ "="
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "logdate"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "nm"
        DOT "."
        NAME_REF
          IDENT "peaktemp"
      WHITESPACE " "
      IS_KW "IS"
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE "\n     "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "peaktemp"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        GREATEST_KW "greatest"
      ARG_LIST
        L_PAREN "("
        FIELD_EXPR
          NAME_REF
            IDENT "m"
          DOT "."
          NAME_REF
            IDENT "peaktemp"
        COMMA ","
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "nm"
          DOT "."
          NAME_REF
            IDENT "peaktemp"
        R_PAREN ")"
    COMMA ","
    WHITESPACE "\n        "
    NAME_REF
      IDENT "unitsales"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "m"
        DOT "."
        NAME_REF
          IDENT "unitsales"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          COALESCE_KW "coalesce"
        ARG_LIST
          L_PAREN "("
          FIELD_EXPR
            NAME_REF
              IDENT "nm"
            DOT "."
            NAME_REF
              IDENT "unitsales"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE "\n     "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "logdate"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "peaktemp"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "unitsales"
      R_PAREN ")"
    WHITESPACE "\n   "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "peaktemp"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "unitsales"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
        COMMA ","
        WHITESPACE " "
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "measurement"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "peaktemp"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "into"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "m"
    WHITESPACE "\n "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "new_measurement"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "nm"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE "\n      "
      PAREN_EXPR
        L_PAREN "("
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "city_id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "city_id"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "logdate"
            EQ "="
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "logdate"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "nm"
        DOT "."
        NAME_REF
          IDENT "peaktemp"
      WHITESPACE " "
      IS_KW "IS"
      WHITESPACE " "
      LITERAL
        NULL_KW "NULL"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE "\n     "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "peaktemp"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        GREATEST_KW "greatest"
      ARG_LIST
        L_PAREN "("
        FIELD_EXPR
          NAME_REF
            IDENT "m"
          DOT "."
          NAME_REF
            IDENT "peaktemp"
        COMMA ","
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "nm"
          DOT "."
          NAME_REF
            IDENT "peaktemp"
        R_PAREN ")"
    COMMA ","
    WHITESPACE "\n        "
    NAME_REF
      IDENT "unitsales"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "m"
        DOT "."
        NAME_REF
          IDENT "unitsales"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      CALL_EXPR
        NAME_REF
          COALESCE_KW "coalesce"
        ARG_LIST
          L_PAREN "("
          FIELD_EXPR
            NAME_REF
              IDENT "nm"
            DOT "."
            NAME_REF
              IDENT "unitsales"
          COMMA ","
          WHITESPACE " "
          LITERAL
            INT_NUMBER "0"
          R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    INSERT_KW "INSERT"
    WHITESPACE "\n     "
    COLUMN_LIST
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "logdate"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "peaktemp"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "unitsales"
      R_PAREN ")"
    WHITESPACE "\n   "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "peaktemp"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "unitsales"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          CAST_EXPR
            NAME_REF
              IDENT "tableoid"
            COLON2 "::"
            PATH_TYPE
              PATH
                PATH_SEGMENT
                  NAME_REF
                    IDENT "regclass"
        COMMA ","
        WHITESPACE " "
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "measurement"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  BEGIN_STMT
    BEGIN_KW "BEGIN"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "nm"
    WHITESPACE "\n "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      ONLY_KW "ONLY"
      WHITESPACE " "
      NAME_REF
        IDENT "measurement"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "m"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE "\n      "
      PAREN_EXPR
        L_PAREN "("
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "city_id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "city_id"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "logdate"
            EQ "="
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "logdate"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "new_measurement"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
  SEMICOLON ";"
  WHITESPACE "\n"
  ROLLBACK_STMT
    ROLLBACK_KW "ROLLBACK"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "nm"
    WHITESPACE "\n "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "measurement"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "m"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE "\n      "
      PAREN_EXPR
        L_PAREN "("
        BIN_EXPR
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "city_id"
            WHITESPACE " "
            EQ "="
            WHITESPACE " "
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "city_id"
          WHITESPACE " "
          AND_KW "and"
          WHITESPACE " "
          BIN_EXPR
            FIELD_EXPR
              NAME_REF
                IDENT "nm"
              DOT "."
              NAME_REF
                IDENT "logdate"
            EQ "="
            FIELD_EXPR
              NAME_REF
                IDENT "m"
              DOT "."
              NAME_REF
                IDENT "logdate"
        R_PAREN ")"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "new_measurement"
    WHITESPACE " "
    ORDER_BY_CLAUSE
      ORDER_KW "ORDER"
      WHITESPACE " "
      BY_KW "BY"
      WHITESPACE " "
      NAME_REF
        IDENT "city_id"
      COMMA ","
      WHITESPACE " "
      NAME_REF
        IDENT "logdate"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "new_measurement"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_FUNCTION_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "measurement_insert_trigger"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "--"
    WHITESPACE "\n"
    COMMENT "-- test non-strict join clause"
    WHITESPACE "\n"
    COMMENT "--"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "src"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "src"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'src row'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "tgt"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "tgt"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        NULL_KW "NULL"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'tgt row'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "tgt"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "src"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "tgt"
          DOT "."
          NAME_REF
            IDENT "a"
        WHITESPACE " "
        IS_NOT_DISTINCT_FROM
          IS_KW "IS"
          WHITESPACE " "
          NOT_KW "NOT"
          WHITESPACE " "
          DISTINCT_KW "DISTINCT"
          WHITESPACE " "
          FROM_KW "FROM"
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "src"
          DOT "."
          NAME_REF
            IDENT "a"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "a"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "src"
      DOT "."
      NAME_REF
        IDENT "a"
    COMMA ","
    WHITESPACE " "
    NAME_REF
      IDENT "b"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "src"
      DOT "."
      NAME_REF
        IDENT "b"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n  "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "src"
      DOT "."
      STAR "*"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "tgt"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "tgt"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "src"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "tgt"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    COMMENT "--"
    WHITESPACE "\n"
    COMMENT "-- test for bug #18634 (wrong varnullingrels error)"
    WHITESPACE "\n"
    COMMENT "--"
    WHITESPACE "\n"
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "bug18634t"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bug18634t"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "10"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'tgt1'"
      R_PAREN ")"
      COMMA ","
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "20"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'tgt2'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "bug18634v"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE "\n  "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "bug18634t"
      WHITESPACE " "
      WHERE_CLAUSE
        WHERE_KW "WHERE"
        WHITESPACE " "
        CALL_EXPR
          NAME_REF
            EXISTS_KW "EXISTS"
          WHITESPACE " "
          ARG_LIST
            L_PAREN "("
            SELECT
              SELECT_CLAUSE
                SELECT_KW "SELECT"
                WHITESPACE " "
                TARGET_LIST
                  TARGET
                    LITERAL
                      INT_NUMBER "1"
              WHITESPACE " "
              FROM_CLAUSE
                FROM_KW "FROM"
                WHITESPACE " "
                NAME_REF
                  IDENT "bug18634t"
            R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_TABLE
    CREATE_KW "CREATE"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "bug18634s"
    WHITESPACE " "
    TABLE_ARGS
      L_PAREN "("
      COLUMN
        NAME_REF
          IDENT "a"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "b"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                INT_KW "int"
      COMMA ","
      WHITESPACE " "
      COLUMN
        NAME_REF
          IDENT "c"
        WHITESPACE " "
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                TEXT_KW "text"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  INSERT_STMT
    INSERT_KW "INSERT"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bug18634s"
    WHITESPACE " "
    SELECT
      VALUES_KW "VALUES"
      WHITESPACE " "
      L_PAREN "("
      LITERAL
        INT_NUMBER "1"
      COMMA ","
      WHITESPACE " "
      LITERAL
        INT_NUMBER "2"
      COMMA ","
      WHITESPACE " "
      LITERAL
        STRING "'src1'"
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bug18634v"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "t"
    WHITESPACE " "
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "bug18634s"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "s"
      WHITESPACE " "
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "s"
          DOT "."
          NAME_REF
            IDENT "a"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "t"
          DOT "."
          NAME_REF
            IDENT "a"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "b"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "s"
      DOT "."
      NAME_REF
        IDENT "b"
    WHITESPACE "\n  "
    WHEN_KW "WHEN"
    WHITESPACE " "
    NOT_KW "NOT"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    BY_KW "BY"
    WHITESPACE " "
    SOURCE_KW "SOURCE"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE " "
    DELETE_KW "DELETE"
    WHITESPACE "\n  "
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    CALL_EXPR
      NAME_REF
        MERGE_ACTION_KW "merge_action"
      ARG_LIST
        L_PAREN "("
        R_PAREN ")"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "s"
      DOT "."
      NAME_REF
        IDENT "c"
    COMMA ","
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "t"
      DOT "."
      STAR "*"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  SELECT
    SELECT_CLAUSE
      SELECT_KW "SELECT"
      WHITESPACE " "
      TARGET_LIST
        TARGET
          STAR "*"
    WHITESPACE " "
    FROM_CLAUSE
      FROM_KW "FROM"
      WHITESPACE " "
      NAME_REF
        IDENT "bug18634t"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bug18634t"
    WHITESPACE " "
    CASCADE_KW "CASCADE"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "bug18634s"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- prepare"
  WHITESPACE "\n\n"
  SET_SESSION_AUTH_STMT
    RESET_KW "RESET"
    WHITESPACE " "
    SESSION_KW "SESSION"
    WHITESPACE " "
    AUTHORIZATION_KW "AUTHORIZATION"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  COMMENT "-- try a system catalog"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "pg_class"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "c"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      PAREN_EXPR
        L_PAREN "("
        SELECT
          SELECT_CLAUSE
            SELECT_KW "SELECT"
            WHITESPACE " "
            TARGET_LIST
              TARGET
                CAST_EXPR
                  LITERAL
                    STRING "'pg_depend'"
                  COLON2 "::"
                  PATH_TYPE
                    PATH
                      PATH_SEGMENT
                        NAME_REF
                          IDENT "regclass"
                WHITESPACE " "
                AS_KW "AS"
                WHITESPACE " "
                NAME
                  IDENT "oid"
        R_PAREN ")"
      WHITESPACE " "
      ALIAS
        AS_KW "AS"
        WHITESPACE " "
        NAME
          IDENT "j"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "j"
          DOT "."
          NAME_REF
            IDENT "oid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "c"
          DOT "."
          NAME_REF
            IDENT "oid"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "reltuples"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "reltuples"
      WHITESPACE " "
      PLUS "+"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
    WHITESPACE "\n"
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "j"
      DOT "."
      NAME_REF
        IDENT "oid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  CREATE_VIEW_STMT
    CREATE_KW "CREATE"
    WHITESPACE " "
    VIEW_KW "VIEW"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME
          IDENT "classv"
    WHITESPACE " "
    AS_KW "AS"
    WHITESPACE " "
    SELECT
      SELECT_CLAUSE
        SELECT_KW "SELECT"
        WHITESPACE " "
        TARGET_LIST
          TARGET
            STAR "*"
      WHITESPACE " "
      FROM_CLAUSE
        FROM_KW "FROM"
        WHITESPACE " "
        NAME_REF
          IDENT "pg_class"
  SEMICOLON ";"
  WHITESPACE "\n"
  MERGE_STMT
    MERGE_KW "MERGE"
    WHITESPACE " "
    INTO_KW "INTO"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "classv"
    WHITESPACE " "
    ALIAS
      NAME
        IDENT "c"
    WHITESPACE "\n"
    USING_CLAUSE
      USING_KW "USING"
      WHITESPACE " "
      NAME_REF
        IDENT "pg_namespace"
      WHITESPACE " "
      ALIAS
        NAME
          IDENT "n"
      WHITESPACE "\n"
      ON_KW "ON"
      WHITESPACE " "
      BIN_EXPR
        FIELD_EXPR
          NAME_REF
            IDENT "n"
          DOT "."
          NAME_REF
            IDENT "oid"
        WHITESPACE " "
        EQ "="
        WHITESPACE " "
        FIELD_EXPR
          NAME_REF
            IDENT "c"
          DOT "."
          NAME_REF
            IDENT "relnamespace"
    WHITESPACE "\n"
    WHEN_KW "WHEN"
    WHITESPACE " "
    MATCHED_KW "MATCHED"
    WHITESPACE " "
    AND_KW "AND"
    WHITESPACE " "
    BIN_EXPR
      FIELD_EXPR
        NAME_REF
          IDENT "c"
        DOT "."
        NAME_REF
          IDENT "oid"
      WHITESPACE " "
      EQ "="
      WHITESPACE " "
      CAST_EXPR
        LITERAL
          STRING "'pg_depend'"
        COLON2 "::"
        PATH_TYPE
          PATH
            PATH_SEGMENT
              NAME_REF
                IDENT "regclass"
    WHITESPACE " "
    THEN_KW "THEN"
    WHITESPACE "\n\t"
    UPDATE_KW "UPDATE"
    WHITESPACE " "
    SET_KW "SET"
    WHITESPACE " "
    NAME_REF
      IDENT "reltuples"
    WHITESPACE " "
    EQ "="
    WHITESPACE " "
    BIN_EXPR
      NAME_REF
        IDENT "reltuples"
      WHITESPACE " "
      MINUS "-"
      WHITESPACE " "
      LITERAL
        INT_NUMBER "1"
    WHITESPACE "\n"
    RETURNING_KW "RETURNING"
    WHITESPACE " "
    FIELD_EXPR
      NAME_REF
        IDENT "c"
      DOT "."
      NAME_REF
        IDENT "oid"
  SEMICOLON ";"
  WHITESPACE "\n\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          TARGET_KW "target"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "target2"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_TABLE
    DROP_KW "DROP"
    WHITESPACE " "
    TABLE_KW "TABLE"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          SOURCE_KW "source"
    COMMA ","
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "source2"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_FUNCTION_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    FUNCTION_KW "FUNCTION"
    WHITESPACE " "
    PATH
      PATH_SEGMENT
        NAME_REF
          IDENT "merge_trigfunc"
    PARAM_LIST
      L_PAREN "("
      R_PAREN ")"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_USER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_merge_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_USER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_merge_no_privs"
  SEMICOLON ";"
  WHITESPACE "\n"
  DROP_USER_STMT
    DROP_KW "DROP"
    WHITESPACE " "
    USER_KW "USER"
    WHITESPACE " "
    NAME_REF
      IDENT "regress_merge_none"
  SEMICOLON ";"
  WHITESPACE "\n"
---
ERROR@1074: expected R_PAREN
ERROR@1075: expected command, found OFF_KW
ERROR@1078: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@1078: expected SEMICOLON
ERROR@1078: expected command, found R_PAREN
ERROR@1199: expected USING_KW
ERROR@1209: expected ON_KW
ERROR@1210: expected an expression, found USING_KW
ERROR@1215: expected an expression
ERROR@1215: expected WHEN_KW
ERROR@1215: expected MATCHED, or NOT MATCHED
ERROR@1215: expected THEN_KW
ERROR@1215: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@1215: expected SEMICOLON
ERROR@1216: expected command, found SOURCE_KW
ERROR@1223: expected command, found AS_KW
ERROR@1226: expected command, found IDENT
ERROR@1228: expected command, found ON_KW
ERROR@1231: expected command, found IDENT
ERROR@1232: expected command, found DOT
ERROR@1233: expected command, found IDENT
ERROR@1237: expected command, found EQ
ERROR@1239: expected command, found IDENT
ERROR@1240: expected command, found DOT
ERROR@1241: expected command, found IDENT
ERROR@1245: expected command, found WHEN_KW
ERROR@1250: expected command, found MATCHED_KW
ERROR@1258: expected command, found THEN_KW
ERROR@1282: expected SET_KW
ERROR@1282: expected name
ERROR@1680: expected VALUES or DEFAULT VALUES
ERROR@1680: expected SEMICOLON
ERROR@1681: expected command, found INTO_KW
ERROR@1686: expected command, found TARGET_KW
ERROR@1693: expected command, found DEFAULT_KW
ERROR@1707: expected L_PAREN
ERROR@1735: expected L_PAREN
ERROR@1741: expected L_PAREN
ERROR@1746: expected L_PAREN
ERROR@1753: expected L_PAREN
ERROR@1755: expected L_PAREN
ERROR@1761: expected L_PAREN
ERROR@1768: expected L_PAREN
ERROR@1771: expected L_PAREN
ERROR@1773: expected L_PAREN
ERROR@1776: expected L_PAREN
ERROR@1777: expected L_PAREN
ERROR@1778: expected L_PAREN
ERROR@1782: expected L_PAREN
ERROR@1784: expected L_PAREN
ERROR@1785: expected L_PAREN
ERROR@1786: expected L_PAREN
ERROR@1790: expected L_PAREN
ERROR@1795: expected L_PAREN
ERROR@1799: expected L_PAREN
ERROR@1807: expected L_PAREN
ERROR@1813: expected L_PAREN
ERROR@1820: expected L_PAREN
ERROR@1952: expected VALUES or DEFAULT VALUES
ERROR@1952: expected SEMICOLON
ERROR@2336: expected SET_KW
ERROR@2343: expected EQ
ERROR@2347: expected SEMICOLON
ERROR@2348: expected command, found IDENT
ERROR@2356: expected command, found EQ
ERROR@2358: expected command, found INT_NUMBER
ERROR@2651: expected select stmt
ERROR@2651: expected R_PAREN
ERROR@2651: expected SEMICOLON
ERROR@2721: expected SEMICOLON
ERROR@2722: expected command, found R_PAREN
ERROR@2724: expected command, found TO_KW
ERROR@2727: expected command, found STDOUT_KW
ERROR@5471: expected R_PAREN
ERROR@5472: expected command, found OFF_KW
ERROR@5475: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@5475: expected SEMICOLON
ERROR@5475: expected command, found R_PAREN
ERROR@5589: expected R_PAREN
ERROR@5590: expected command, found OFF_KW
ERROR@5593: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@5593: expected SEMICOLON
ERROR@5593: expected command, found R_PAREN
ERROR@5691: expected R_PAREN
ERROR@5692: expected command, found OFF_KW
ERROR@5695: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@5695: expected SEMICOLON
ERROR@5695: expected command, found R_PAREN
ERROR@22860: expected IDENT
ERROR@22860: expected SEMICOLON
ERROR@22861: expected command, found ACTION_KW
ERROR@22867: expected command, found COMMA
ERROR@22879: expected command, found OLD_KW
ERROR@22882: expected command, found DOT
ERROR@22883: expected command, found IDENT
ERROR@22887: expected command, found AS_KW
ERROR@22890: expected command, found IDENT
ERROR@22897: expected command, found COMMA
ERROR@22899: expected command, found OLD_KW
ERROR@22902: expected command, found DOT
ERROR@22903: expected command, found IDENT
ERROR@22911: expected command, found AS_KW
ERROR@22914: expected command, found IDENT
ERROR@22925: expected command, found COMMA
ERROR@22937: expected command, found NEW_KW
ERROR@22940: expected command, found DOT
ERROR@22941: expected command, found IDENT
ERROR@22945: expected command, found AS_KW
ERROR@22948: expected command, found IDENT
ERROR@22955: expected command, found COMMA
ERROR@22957: expected command, found NEW_KW
ERROR@22960: expected command, found DOT
ERROR@22961: expected command, found IDENT
ERROR@22969: expected command, found AS_KW
ERROR@22972: expected command, found IDENT
ERROR@22983: expected command, found COMMA
ERROR@23046: expected SEMICOLON
ERROR@23046: expected command, found COMMA
ERROR@23048: expected command, found IDENT
ERROR@23049: expected command, found DOT
ERROR@23050: expected command, found STAR
ERROR@23051: expected command, found COMMA
ERROR@23063: expected command, found CASE_KW
ERROR@23068: expected command, found MERGE_ACTION_KW
ERROR@23080: expected command, found L_PAREN
ERROR@23081: expected command, found R_PAREN
ERROR@23097: expected command, found WHEN_KW
ERROR@23102: expected command, found STRING
ERROR@23111: expected command, found THEN_KW
ERROR@23116: expected command, found STRING
ERROR@23127: expected command, found PIPE
ERROR@23128: expected command, found PIPE
ERROR@23129: expected command, found IDENT
ERROR@23145: expected command, found WHEN_KW
ERROR@23150: expected command, found STRING
ERROR@23159: expected command, found THEN_KW
ERROR@23164: expected command, found STRING
ERROR@23172: expected command, found PIPE
ERROR@23173: expected command, found PIPE
ERROR@23174: expected command, found IDENT
ERROR@23179: expected command, found PIPE
ERROR@23180: expected command, found PIPE
ERROR@23181: expected command, found STRING
ERROR@23209: expected command, found WHEN_KW
ERROR@23214: expected command, found STRING
ERROR@23223: expected command, found THEN_KW
ERROR@23228: expected command, found STRING
ERROR@23238: expected command, found PIPE
ERROR@23239: expected command, found PIPE
ERROR@23240: expected command, found IDENT
ERROR@23255: expected SEMICOLON
ERROR@23256: expected command, found AS_KW
ERROR@23259: expected command, found IDENT
ERROR@23931: expected IDENT
ERROR@23931: expected R_PAREN
ERROR@23931: expected DELETE, SELECT, TABLE, UPDATE, or MERGE, got: ACTION_KW
ERROR@23932: expected command, found ACTION_KW
ERROR@23938: expected command, found COMMA
ERROR@23940: expected command, found OLD_KW
ERROR@23944: expected command, found AS_KW
ERROR@23947: expected command, found IDENT
ERROR@23955: expected command, found COMMA
ERROR@23957: expected command, found NEW_KW
ERROR@23961: expected command, found AS_KW
ERROR@23964: expected command, found IDENT
ERROR@23972: expected command, found COMMA
ERROR@23974: expected command, found IDENT
ERROR@23975: expected command, found DOT
ERROR@23976: expected command, found STAR
ERROR@23977: expected command, found COMMA
ERROR@23993: expected command, found CASE_KW
ERROR@23998: expected command, found MERGE_ACTION_KW
ERROR@24010: expected command, found L_PAREN
ERROR@24011: expected command, found R_PAREN
ERROR@24031: expected command, found WHEN_KW
ERROR@24036: expected command, found STRING
ERROR@24045: expected command, found THEN_KW
ERROR@24050: expected command, found STRING
ERROR@24061: expected command, found PIPE
ERROR@24062: expected command, found PIPE
ERROR@24063: expected command, found IDENT
ERROR@24083: expected command, found WHEN_KW
ERROR@24088: expected command, found STRING
ERROR@24097: expected command, found THEN_KW
ERROR@24102: expected command, found STRING
ERROR@24110: expected command, found PIPE
ERROR@24111: expected command, found PIPE
ERROR@24112: expected command, found IDENT
ERROR@24117: expected command, found PIPE
ERROR@24118: expected command, found PIPE
ERROR@24119: expected command, found STRING
ERROR@24151: expected command, found WHEN_KW
ERROR@24156: expected command, found STRING
ERROR@24165: expected command, found THEN_KW
ERROR@24170: expected command, found STRING
ERROR@24180: expected command, found PIPE
ERROR@24181: expected command, found PIPE
ERROR@24182: expected command, found IDENT
ERROR@24201: expected SEMICOLON
ERROR@24202: expected command, found AS_KW
ERROR@24205: expected command, found IDENT
ERROR@24217: expected command, found R_PAREN
ERROR@24218: expected command, found COMMA
ERROR@24220: expected command, found IDENT
ERROR@24223: expected command, found AS_KW
ERROR@24226: expected command, found L_PAREN
ERROR@24518: expected SEMICOLON
ERROR@24519: expected command, found R_PAREN
ERROR@24648: expected select stmt
ERROR@24648: expected R_PAREN
ERROR@24648: expected SEMICOLON
ERROR@24974: expected SEMICOLON
ERROR@24975: expected command, found R_PAREN
ERROR@24977: expected command, found TO_KW
ERROR@24980: expected command, found STDOUT_KW
ERROR@29598: expected R_PAREN
ERROR@29599: expected command, found OFF_KW
ERROR@29602: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@29602: expected SEMICOLON
ERROR@29602: expected command, found R_PAREN
ERROR@40075: expected R_PAREN
ERROR@40076: expected command, found OFF_KW
ERROR@40079: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@40079: expected SEMICOLON
ERROR@40079: expected command, found R_PAREN
ERROR@40473: expected R_PAREN
ERROR@40474: expected command, found OFF_KW
ERROR@40477: expected SELECT, INSERT, UPDATE, DELETE, MERGE, VALUES, EXECUTE, DECLARE, CREATE TABLE AS, or CREATE MATERIALIZED VIEW AS
ERROR@40477: expected SEMICOLON
ERROR@40477: expected command, found R_PAREN
ERROR@41486: expected ON_KW
ERROR@41493: expected WHEN_KW
ERROR@41493: expected MATCHED, or NOT MATCHED
ERROR@41493: expected THEN_KW
ERROR@41493: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@41493: expected SEMICOLON
ERROR@41494: expected command, found JOIN_KW
ERROR@41499: expected command, found IDENT
ERROR@41510: expected command, found IDENT
ERROR@41513: expected command, found ON_KW
ERROR@41516: expected command, found IDENT
ERROR@41521: expected command, found EQ
ERROR@41523: expected command, found IDENT
ERROR@41528: expected command, found ON_KW
ERROR@41531: expected command, found IDENT
ERROR@41532: expected command, found DOT
ERROR@41533: expected command, found IDENT
ERROR@41537: expected command, found EQ
ERROR@41539: expected command, found IDENT
ERROR@41544: expected command, found WHEN_KW
ERROR@41549: expected command, found NOT_KW
ERROR@41553: expected command, found MATCHED_KW
ERROR@41561: expected command, found THEN_KW
ERROR@41573: expected INTO_KW
ERROR@41600: expected select stmt
ERROR@41706: expected ON_KW
ERROR@41713: expected WHEN_KW
ERROR@41713: expected MATCHED, or NOT MATCHED
ERROR@41713: expected THEN_KW
ERROR@41713: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@41713: expected SEMICOLON
ERROR@41714: expected command, found JOIN_KW
ERROR@41719: expected command, found IDENT
ERROR@41730: expected command, found IDENT
ERROR@41733: expected command, found ON_KW
ERROR@41736: expected command, found IDENT
ERROR@41741: expected command, found EQ
ERROR@41743: expected command, found IDENT
ERROR@41748: expected command, found AND_KW
ERROR@41752: expected command, found IDENT
ERROR@41757: expected command, found EQ
ERROR@41759: expected command, found INT_NUMBER
ERROR@41762: expected command, found ON_KW
ERROR@41765: expected command, found IDENT
ERROR@41766: expected command, found DOT
ERROR@41767: expected command, found IDENT
ERROR@41771: expected command, found EQ
ERROR@41773: expected command, found IDENT
ERROR@41778: expected command, found WHEN_KW
ERROR@41783: expected command, found NOT_KW
ERROR@41787: expected command, found MATCHED_KW
ERROR@41795: expected command, found THEN_KW
ERROR@41807: expected INTO_KW
ERROR@41834: expected select stmt
ERROR@41834: expected SEMICOLON
ERROR@41835: expected command, found WHEN_KW
ERROR@41840: expected command, found MATCHED_KW
ERROR@41848: expected command, found THEN_KW
ERROR@41860: expected FROM_KW
ERROR@41860: expected path name
ERROR@41953: expected ON_KW
ERROR@41960: expected WHEN_KW
ERROR@41960: expected MATCHED, or NOT MATCHED
ERROR@41960: expected THEN_KW
ERROR@41960: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@41960: expected SEMICOLON
ERROR@41961: expected command, found JOIN_KW
ERROR@41966: expected command, found IDENT
ERROR@41977: expected command, found IDENT
ERROR@41980: expected command, found ON_KW
ERROR@41983: expected command, found IDENT
ERROR@41988: expected command, found EQ
ERROR@41990: expected command, found IDENT
ERROR@41995: expected command, found ON_KW
ERROR@41998: expected command, found IDENT
ERROR@41999: expected command, found DOT
ERROR@42000: expected command, found IDENT
ERROR@42004: expected command, found EQ
ERROR@42006: expected command, found IDENT
ERROR@42011: expected command, found WHEN_KW
ERROR@42016: expected command, found NOT_KW
ERROR@42020: expected command, found MATCHED_KW
ERROR@42028: expected command, found THEN_KW
ERROR@42040: expected INTO_KW
ERROR@42060: expected R_PAREN
ERROR@42060: expected select stmt
ERROR@42060: expected SEMICOLON
ERROR@42061: expected command, found PLUS
ERROR@42063: expected command, found IDENT
ERROR@42067: expected command, found COMMA
ERROR@42069: expected command, found IDENT
ERROR@42073: expected command, found R_PAREN
ERROR@42075: expected command, found WHEN_KW
ERROR@42080: expected command, found MATCHED_KW
ERROR@42088: expected command, found THEN_KW
ERROR@42108: expected SET_KW
ERROR@42108: expected name
ERROR@42182: expected ON_KW
ERROR@42189: expected WHEN_KW
ERROR@42189: expected MATCHED, or NOT MATCHED
ERROR@42189: expected THEN_KW
ERROR@42189: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@42189: expected SEMICOLON
ERROR@42190: expected command, found JOIN_KW
ERROR@42195: expected command, found IDENT
ERROR@42206: expected command, found IDENT
ERROR@42209: expected command, found ON_KW
ERROR@42212: expected command, found IDENT
ERROR@42217: expected command, found EQ
ERROR@42219: expected command, found IDENT
ERROR@42224: expected command, found AND_KW
ERROR@42228: expected command, found IDENT
ERROR@42233: expected command, found EQ
ERROR@42235: expected command, found INT_NUMBER
ERROR@42238: expected command, found ON_KW
ERROR@42241: expected command, found IDENT
ERROR@42242: expected command, found DOT
ERROR@42243: expected command, found IDENT
ERROR@42247: expected command, found EQ
ERROR@42249: expected command, found IDENT
ERROR@42254: expected command, found WHEN_KW
ERROR@42259: expected command, found MATCHED_KW
ERROR@42267: expected command, found THEN_KW
ERROR@42287: expected SET_KW
ERROR@42287: expected name
ERROR@42477: expected ON_KW
ERROR@42483: expected WHEN_KW
ERROR@42483: expected MATCHED, or NOT MATCHED
ERROR@42483: expected THEN_KW
ERROR@42483: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@42483: expected SEMICOLON
ERROR@42484: expected command, found JOIN_KW
ERROR@42489: expected command, found IDENT
ERROR@42500: expected command, found IDENT
ERROR@42504: expected command, found ON_KW
ERROR@42507: expected command, found IDENT
ERROR@42509: expected command, found DOT
ERROR@42510: expected command, found IDENT
ERROR@42515: expected command, found EQ
ERROR@42517: expected command, found IDENT
ERROR@42520: expected command, found DOT
ERROR@42521: expected command, found IDENT
ERROR@42526: expected command, found STAR
ERROR@42528: expected command, found INT_NUMBER
ERROR@42531: expected command, found ON_KW
ERROR@42534: expected command, found IDENT
ERROR@42535: expected command, found DOT
ERROR@42536: expected command, found IDENT
ERROR@42540: expected command, found EQ
ERROR@42542: expected command, found IDENT
ERROR@42544: expected command, found DOT
ERROR@42545: expected command, found IDENT
ERROR@42550: expected command, found WHEN_KW
ERROR@42555: expected command, found NOT_KW
ERROR@42559: expected command, found MATCHED_KW
ERROR@42567: expected command, found THEN_KW
ERROR@42579: expected INTO_KW
ERROR@42579: expected path name
ERROR@42827: expected ON_KW
ERROR@42834: expected WHEN_KW
ERROR@42834: expected MATCHED, or NOT MATCHED
ERROR@42834: expected THEN_KW
ERROR@42834: expected INSERT, UPDATE, DELETE, or DO NOTHING
ERROR@42834: expected SEMICOLON
ERROR@42835: expected command, found JOIN_KW
ERROR@42840: expected command, found IDENT
ERROR@42851: expected command, found IDENT
ERROR@42854: expected command, found ON_KW
ERROR@42857: expected command, found IDENT
ERROR@42859: expected command, found DOT
ERROR@42860: expected command, found IDENT
ERROR@42864: expected command, found EQ
ERROR@42866: expected command, found IDENT
ERROR@42868: expected command, found DOT
ERROR@42869: expected command, found IDENT
ERROR@42873: expected command, found ON_KW
ERROR@42876: expected command, found IDENT
ERROR@42877: expected command, found DOT
ERROR@42878: expected command, found IDENT
ERROR@42882: expected command, found EQ
ERROR@42884: expected command, found IDENT
ERROR@42886: expected command, found DOT
ERROR@42887: expected command, found IDENT
ERROR@42891: expected command, found WHEN_KW
ERROR@42896: expected command, found NOT_KW
ERROR@42900: expected command, found MATCHED_KW
ERROR@42908: expected command, found THEN_KW
ERROR@42920: expected INTO_KW
ERROR@42949: expected select stmt
